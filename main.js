/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var de=Object.defineProperty;var Ke=Object.getOwnPropertyDescriptor;var We=Object.getOwnPropertyNames;var Ye=Object.prototype.hasOwnProperty;var Oe=(s,r)=>{for(var t in r)de(s,t,{get:r[t],enumerable:!0})},Xe=(s,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let e of We(r))!Ye.call(s,e)&&e!==t&&de(s,e,{get:()=>r[e],enumerable:!(n=Ke(r,e))||n.enumerable});return s};var ze=s=>Xe(de({},"__esModule",{value:!0}),s);var mn={};Oe(mn,{default:()=>le});module.exports=ze(mn);var Vt=require("obsidian");var te=require("obsidian"),pe="chartnotes-view",qe=["bar","stacked-bar","line","area","pie","scatter","gantt"];function je(s){let r=String(s!=null?s:"bar").trim().toLowerCase();return qe.includes(r)?r:"bar"}var Ze=["sum","count","cumulative-sum"];function Je(s){let r=String(s!=null?s:"sum").trim().toLowerCase();return Ze.includes(r)?r:"sum"}var tn=["auto","none","day","week","month","quarter","year"];function en(s){let r=String(s!=null?s:"auto").trim().toLowerCase();return tn.includes(r)?r:"auto"}var Zt="(missing)",Jt=class extends te.BasesView{constructor(t,n,e){super(t);this.type=pe;this.renderer=e,this.rootEl=n.createDiv("chartnotes-bases-view")}onDataUpdated(){var P,X,j;this.rootEl.empty();let t=this.data,n=(P=t==null?void 0:t.groupedData)!=null?P:[];if(!n.length){this.rootEl.createDiv({cls:"prop-charts-empty",text:"No data in this view."});return}let e=this.config,o=je((X=e==null?void 0:e.get("chartType"))!=null?X:"bar"),i=o==="pie",d=o==="scatter",l=o==="gantt",a=Je(e==null?void 0:e.get("aggregateMode")),D=a==="cumulative-sum"&&!(o==="line"||o==="area")?"sum":a,b=en(e==null?void 0:e.get("xBucket")),y=i||d||l?"none":b,f=this.getPropFromConfig("xProperty"),x=this.getPropFromConfig("ganttLabelProperty"),R=this.getPropFromConfig("yProperty"),g=this.getPropFromConfig("seriesProperty");i&&(g={id:null,name:null});let L=this.getPropFromConfig("startProperty"),M=this.getPropFromConfig("endProperty"),E=this.getPropFromConfig("dueProperty"),Q=this.getPropFromConfig("durationProperty"),B=this.getPropFromConfig("groupProperty");if(!l&&!f.id){this.rootEl.createDiv({cls:"prop-charts-empty",text:"Configure the 'X axis / category' property in view options."});return}if(d&&(!f.id||!R.id)){this.rootEl.createDiv({cls:"prop-charts-empty",text:"Scatter plots need both X and Y numeric properties."});return}if(l&&!(L.id||M.id||E.id)){this.rootEl.createDiv({cls:"prop-charts-empty",text:"Gantt needs Start/End or Due with Duration."});return}let w=l&&x.id?x:l?f:{id:null,name:null},N;if(l)N=this.buildRowsForGantt(n,w,g,L,M,E,Q,B);else if(d)N=this.buildRowsForScatter(n,f,R,g);else{let m=i;N=this.buildRowsForAggregatedCharts(n,f,R,g,D,y,m)}if(!N.length){this.rootEl.createDiv({cls:"prop-charts-empty",text:"No rows to display (check X/Y/aggregation)."});return}let p={rows:N},u=((j=e==null?void 0:e.get("title"))!=null?j:"").trim()||(e==null?void 0:e.name)||"Chart Notes (Bases)",k=e==null?void 0:e.get("drilldown"),I=typeof k=="boolean"?k:!0,H=this.buildEncoding({x:f,y:R,series:g,start:L,end:M,due:E,duration:Q,group:B,label:w,aggMode:D,xBucket:y,chartType:o}),V={type:o,source:{type:"properties",query:""},encoding:H,options:{title:u,drilldown:I}},_={refresh:()=>this.onDataUpdated()};this.renderer.render(this.rootEl,V,p,_)}getPropFromConfig(t){var d,l;let n=this.config,e=(d=n==null?void 0:n.get)==null?void 0:d.call(n,t);if(!e)return{id:null,name:null};let o=e.trim();if(!o||o==="undefined"||o==="null")return{id:null,name:null};let i=o;try{let a=(0,te.parsePropertyId)(i);return{id:i,name:(l=a.name)!=null?l:i}}catch(a){return{id:i,name:i}}}readValue(t,n){if(!n.id)return null;let e;try{e=t.getValue(n.id)}catch(o){return null}if(!e)return null;try{if(typeof e.isEmpty=="function"&&e.isEmpty())return null}catch(o){}try{let o=e.toString();if(o==null)return null;let i=String(o).trim();return i.length?i:null}catch(o){return null}}parseDate(t){if(!t)return null;let n=new Date(t.trim());return Number.isNaN(n.getTime())?null:n}compareX(t,n){let e=this.parseDate(t!=null?String(t):null),o=this.parseDate(n!=null?String(n):null);if(e&&o)return e.getTime()-o.getTime();let i=Number(t),d=Number(n);return!Number.isNaN(i)&&!Number.isNaN(d)?i-d:String(t!=null?t:"").localeCompare(String(n!=null?n:""))}fmtDate(t){let n=t.getFullYear(),e=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${n}-${e}-${o}`}startOfWeek(t){let n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),e=(n.getDay()+6)%7;return n.setDate(n.getDate()-e),n.setHours(0,0,0,0),n}bucketX(t,n){let e=this.parseDate(t);if(!e)return t;switch(n){case"none":return t;case"auto":case"day":return this.fmtDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()));case"week":{let o=this.startOfWeek(e);return`${this.fmtDate(o)} (W)`}case"month":{let o=String(e.getMonth()+1).padStart(2,"0");return`${e.getFullYear()}-${o}`}case"quarter":{let o=Math.floor(e.getMonth()/3)+1;return`${e.getFullYear()}-Q${o}`}case"year":return`${e.getFullYear()}`;default:return t}}getXValuesForEntry(t,n,e,o){var S,D;let i=[],d=b=>this.bucketX(b,e);if(!n.id){let b=t.file,y=b!=null&&b.name?String(b.name):String((S=b==null?void 0:b.path)!=null?S:Zt);return i.push(d(y)),i}if(!o){let b=(D=this.readValue(t,n))!=null?D:Zt;return i.push(d(b)),i}let l=null;try{l=t.getValue(n.id)}catch(b){l=null}let a=b=>{if(!b)return;let y=String(b).trim();y&&i.push(d(y))};if(l==null)a(Zt);else if(typeof l=="string"){let b=l.trim();if(b){let y=b.split(/\s+/);for(let f of y)a(f)}}else if(Array.isArray(l))for(let b of l){if(b==null)continue;let y;try{y=b.toString()}catch(f){continue}a(y)}else if(typeof l.toArray=="function"){let b=l.toArray();if(Array.isArray(b))for(let y of b){if(y==null)continue;let f;try{f=y.toString()}catch(x){continue}a(f)}else{let y;try{y=l.toString()}catch(f){y=""}a(y)}}else{let b;try{b=l.toString()}catch(y){b=""}a(b)}return i.length||a(Zt),i}buildRowsForAggregatedCharts(t,n,e,o,i,d,l){let a=new Map,S=l||i==="count"||!e.id&&i!=="sum",D=e.name||"y";for(let y of t)for(let f of y.entries){let x=f.file,R=this.getXValuesForEntry(f,n,d,l),g=1,L=null;if(!S&&e.id){if(L=this.readValue(f,e),L==null)continue;let Q=Number(L);if(Number.isNaN(Q))continue;g=Q}else g=1;let M=this.readValue(f,o),E=M!=null?String(M):void 0;for(let Q of R){let B=`${Q}@@${E!=null?E:""}`,w=a.get(B);w||(w={x:Q,y:0,series:E,notes:[],props:{}},a.set(B,w)),w.y+=g,x!=null&&x.path&&w.notes.push(x.path),w.props&&n.name&&(w.props[n.name]=Q),!S&&w.props&&D&&L!=null&&(w.props[D]=w.y),S&&w.props&&(w.props[D]=w.y),w.props&&o.name&&M!=null&&(w.props[o.name]=M)}}let b=Array.from(a.values());return i==="cumulative-sum"?this.toCumulative(b):b}toCumulative(t){var o,i;let n=new Map;for(let d of t){let l=(o=d.series)!=null?o:"__no_series__",a=n.get(l);a||(a=[],n.set(l,a)),a.push(d)}let e=[];for(let[,d]of n){let l=[...d].sort((S,D)=>this.compareX(S.x,D.x)),a=0;for(let S of l){let D=Number((i=S.y)!=null?i:0);Number.isNaN(D)||(a+=D,e.push({...S,y:a}))}}return e}buildRowsForScatter(t,n,e,o){let i=[];for(let d of t)for(let l of d.entries){let a=l.file,S=this.readValue(l,n),D=this.readValue(l,e);if(S==null||D==null)continue;let b=Number(S),y=Number(D);if(Number.isNaN(b)||Number.isNaN(y))continue;let f=this.readValue(l,o),x=f!=null?String(f):void 0;i.push({x:b,y,series:x,notes:a!=null&&a.path?[a.path]:[],props:{}})}return i}buildRowsForGantt(t,n,e,o,i,d,l,a){var R;let S=[],y=g=>{let L=[g==null?void 0:g.label,g==null?void 0:g.name,g==null?void 0:g.value,g==null?void 0:g.key,g==null?void 0:g.group,g==null?void 0:g.groupLabel];for(let M of L)if(M!=null&&String(M).trim()!=="")return String(M);return""},f=n;try{let g=this.getPropFromConfig("ganttLabelProperty");g&&g.id&&(f=g)}catch(g){}let x=!!a.id;for(let g of t){let L=y(g);for(let M of(R=g.entries)!=null?R:[]){let E=M.file,Q=this.readValue(M,o),B=this.readValue(M,i),w=this.readValue(M,d),N=this.readValue(M,l),p=N!=null?Number(N):NaN,A=Number.isFinite(p)&&p>0,u=A?p*6e4:36e5,k=this.parseDate(Q),I=this.parseDate(B),H=this.parseDate(w),V=k,_=I;if(V&&!_&&(_=new Date(V.getTime()+u)),!V&&_&&(V=new Date(_.getTime()-u)),!V&&!_&&H&&(A?(_=H,V=new Date(H.getTime()-u)):(V=H,_=new Date(H.getTime()+36e5))),!V||!_)continue;if(V.getTime()>_.getTime()){let c=V;V=_,_=c}let P=this.readValue(M,f);(P==null||String(P).trim()==="")&&(E!=null&&E.name?P=String(E.name).replace(/\.md$/i,""):E!=null&&E.path?P=String(E.path):P="(sem t\xEDtulo)");let X=this.readValue(M,e),j=X!=null?String(X):void 0,m={};if(L&&(m.__basesGroup=L),x){let c=this.readValue(M,a);c!=null&&a.name&&(m[a.name]=c)}f.name&&(m[f.name]=P),m.label=P,o.name&&Q!=null&&(m[o.name]=Q),i.name&&B!=null&&(m[i.name]=B),d.name&&w!=null&&(m[d.name]=w),A&&l.name&&(m[l.name]=p);let F=E==null?void 0:E.path;S.push({x:P,y:0,series:j,start:V,end:_,due:H!=null?H:void 0,notes:F?[F]:[],props:m})}}return S.sort((g,L)=>!g.start||!L.start?0:g.start.getTime()-L.start.getTime()),S}buildEncoding(t){var d,l,a,S,D,b,y,f,x,R,g;let n=(d=t.x.name)!=null?d:"x",e=(l=t.y.name)!=null?l:"y",o=(D=(S=(a=t.label.name)!=null?a:t.x.name)!=null?S:t.group.name)!=null?D:"label",i=t.chartType==="gantt"?"__basesGroup":(b=t.group.name)!=null?b:"group";return{x:n,y:e,series:(y=t.series.name)!=null?y:"series",start:(f=t.start.name)!=null?f:"start",end:(x=t.end.name)!=null?x:"end",due:(R=t.due.name)!=null?R:"due",duration:(g=t.duration.name)!=null?g:"duration",group:i,label:o}}};var Re=require("obsidian"),ee=class{constructor(r){this.index=new Map;this.app=r}async buildIndex(){this.index.clear();let r=this.app.vault.getMarkdownFiles();for(let t of r)await this.updateFile(t)}async fullReindex(){await this.buildIndex()}getAll(){return Array.from(this.index.values())}async updateFile(r){if(r.extension!=="md")return;let t={};try{let e=(await this.app.vault.read(r)).match(/^---\n([\s\S]*?)\n---\n?/);if(e){let i=(0,Re.parseYaml)(e[1])||{};if(i&&typeof i=="object")for(let[d,l]of Object.entries(i))d!=="position"&&(t[d]=l)}let o=this.app.metadataCache.getFileCache(r);o!=null&&o.tags&&!t.tags&&(t.tags=o.tags.map(i=>i.tag.replace(/^#/,"")))}catch(n){console.error("Chart Notes: erro ao indexar",r.path,n)}this.index.set(r.path,{path:r.path,props:t})}removeFile(r){this.index.delete(r.path)}};function Le(s,r){if(!r||r.length===0)return!0;for(let t of r){if(t===".")return!0;let n=t.endsWith("/")?t:t+"/";if(s===t||s.startsWith(n))return!0}return!1}function Ie(s,r){if(!r||r.length===0)return!0;let t=s.tags;if(!t)return!1;if(Array.isArray(t)){for(let e of r)if(t.includes(e)||t.includes("#"+e))return!0;return!1}let n=String(t);for(let e of r)if(n===e||n==="#"+e)return!0;return!1}function re(s){return typeof s!="string"?!1:/^\d{4}-\d{2}-\d{2}/.test(s)}function $t(s){if(s instanceof Date&&!isNaN(s.getTime()))return s;if(typeof s!="string")return null;let r=s.trim(),t=r.match(/^(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2})(?::(\d{2}))?)?/);if(t){let e=Number(t[1]),o=Number(t[2])-1,i=Number(t[3]),d=t[4]?Number(t[4]):0,l=t[5]?Number(t[5]):0,a=t[6]?Number(t[6]):0;return Number.isNaN(e)||Number.isNaN(o)||Number.isNaN(i)||Number.isNaN(d)||Number.isNaN(l)||Number.isNaN(a)?null:new Date(e,o,i,d,l,a,0)}let n=new Date(r);return isNaN(n.getTime())?null:n}function ht(s){let r=new Date(s);return r.setHours(0,0,0,0),r}function ne(s,r){let t=new Date(s);return t.setDate(t.getDate()-r),t}function nn(s,r){return ne(s,r*7)}function rn(s,r){let t=new Date(s);return t.setMonth(t.getMonth()-r),t}function he(s,r){let t=new Date(s);return t.setDate(t.getDate()+r),t}function sn(s,r){return he(s,r*7)}function on(s,r){let t=new Date(s);return t.setMonth(t.getMonth()+r),t}function Me(s){let r=s.toLowerCase();return!!(["date","scheduled","due","start","end","created","modified","datecreated","datemodified"].includes(r)||r.endsWith("date")||r.endsWith("at")||r.endsWith("on"))}function Pe(s,r){let t=r?new Date(r):new Date,n=ht(t),e=s.trim().toLowerCase();if(e==="today")return n;if(e==="yesterday")return ht(ne(n,1));if(/^-\d+$/.test(e)){let o=parseInt(e.slice(1),10);return ht(ne(n,o))}if(/^-\d+d$/.test(e)){let o=parseInt(e.slice(1,-1),10);return ht(ne(n,o))}if(/^-\d+w$/.test(e)){let o=parseInt(e.slice(1,-1),10);return ht(nn(n,o))}if(/^-\d+m$/.test(e)){let o=parseInt(e.slice(1,-1),10);return ht(rn(n,o))}if(/^\+\d+$/.test(e)){let o=parseInt(e.slice(1),10);return ht(he(n,o))}if(/^\+\d+d$/.test(e)){let o=parseInt(e.slice(1,-1),10);return ht(he(n,o))}if(/^\+\d+w$/.test(e)){let o=parseInt(e.slice(1,-1),10);return ht(sn(n,o))}if(/^\+\d+m$/.test(e)){let o=parseInt(e.slice(1,-1),10);return ht(on(n,o))}return null}function _e(s){let r=s.trim(),t=r.match(/^([a-zA-Z0-9_.-]+)\s+between\s+(.+)\s+and\s+(.+)$/i);if(t){let S=t[1].trim(),D=t[2].trim(),b=t[3].trim(),y=Me(S),f=me(D,y),x=me(b,y),R=f.valueType==="date"||x.valueType==="date"?"date":f.valueType;return{field:S,op:"between",value:f.value,value2:x.value,valueType:R}}let n=/(==|!=|>=|<=|>|<)/,e=r.split(n);if(e.length!==3)throw new Error("express\xE3o where inv\xE1lida: "+s);let o=e[0].trim(),i=e[1].trim(),d=e[2].trim(),l=Me(o),a=me(d,l);return{field:o,op:i,value:a.value,valueType:a.valueType}}function me(s,r){let t=s.trim();if(t.startsWith("'")&&t.endsWith("'")||t.startsWith('"')&&t.endsWith('"'))return{value:t.slice(1,-1),valueType:"string"};let n=t.toLowerCase(),e=n==="today"||n==="yesterday"||n.startsWith("-")||n.startsWith("+");if(r){if(t==="0"||n==="today")return{value:ht(new Date),valueType:"date"};let i=Pe(t);if(i)return{value:i,valueType:"date"}}else if(e){let i=Pe(t);if(i)return{value:i,valueType:"date"}}if(re(t)){let i=$t(t);if(i)return{value:i,valueType:"date"}}let o=Number(t);return Number.isNaN(o)?{value:t,valueType:"string"}:{value:o,valueType:"number"}}function Fe(s,r){let t=s[r.field];if(t==null)return!1;if(r.valueType==="date"){let o=t instanceof Date?ht(t):re(t)?ht($t(t)):null;if(!o)return!1;let i=r.value instanceof Date?r.value:null,d=r.value2 instanceof Date?r.value2:null;if(!i)return!1;let l=o.getTime(),a=ht(i).getTime();switch(r.op){case"==":return l===a;case"!=":return l!==a;case">":return l>a;case">=":return l>=a;case"<":return l<a;case"<=":return l<=a;case"between":if(!d)return!1;let S=ht(d).getTime();return l>=a&&l<=S}}if(r.valueType==="number"){let o=Number(t);if(isNaN(o))return!1;let i=Number(r.value);switch(r.op){case"==":return o===i;case"!=":return o!==i;case">":return o>i;case">=":return o>=i;case"<":return o<i;case"<=":return o<=i;case"between":return typeof r.value2!="number"?!1:o>=i&&o<=r.value2}}let n=String(t),e=String(r.value);switch(r.op){case"==":return n===e;case"!=":return n!==e;case">":return n>e;case">=":return n>=e;case"<":return n<e;case"<=":return n<=e;case"between":return!1}}function an(s){if(typeof s=="string"&&/^\d{4}-\d{2}-\d{2}/.test(s))return{key:s.slice(0,10),isDate:!0};if(re(s)){let r=$t(s);if(r)return{key:r,isDate:!0}}return{key:s,isDate:!1}}function ln(s,r){let t=s.x,n=r.x;if(t instanceof Date&&n instanceof Date)return t.getTime()-n.getTime();let e=String(t),o=String(n);return e<o?-1:e>o?1:0}function cn(s,r){var o,i;let t=ln(s,r);if(t!==0)return t;let n=(o=s.series)!=null?o:"",e=(i=r.series)!=null?i:"";return n<e?-1:n>e?1:0}function un(s){if(s==null)return 0;if(typeof s=="number")return s>0?Math.floor(s):0;if(typeof s=="string"){let r=s.trim().match(/^(\d+)/);if(r){let t=Number(r[1]);return Number.isFinite(t)&&t>0?Math.floor(t):0}}throw new Error(`aggregate.rolling inv\xE1lido: ${String(s)}`)}function dn(s){var n,e;let r=new Map,t=[];for(let o of s){let i=(n=o.series)!=null?n:"__no_series__",l=((e=r.get(i))!=null?e:0)+o.y;r.set(i,l),t.push({...o,y:l})}return t}function pn(s,r){var i,d;let t=un(r);if(!t||t<=1)return[...s];let n=new Map,e=new Map,o=[];for(let l of s){let a=(i=l.series)!=null?i:"__no_series__",S=n.get(a);S||(S=[],n.set(a,S));let D=(d=e.get(a))!=null?d:0;if(S.push(l.y),D+=l.y,S.length>t){let f=S.shift();D-=f}e.set(a,D);let b=S.length||1,y=D/b;o.push({...l,y})}return o}var se=class{constructor(r,t){this.getIndex=r,this.defaultPaths=t}run(r){var i,d,l;let t=this.getIndex(),n=(i=r.source)!=null&&i.paths&&r.source.paths.length?r.source.paths:this.defaultPaths,e=(d=r.source)!=null&&d.tags&&r.source.tags.length?r.source.tags:[],o=[];for(let a of t){let S=n&&n.length?Le(a.path,n):!0,D=e&&e.length?Ie(a.props,e):!0;if(!S||!D)continue;let b=!0;if((l=r.source)!=null&&l.where&&r.source.where.length>0)for(let y of r.source.where){let f;try{f=_e(y)}catch(x){throw new Error(`Condi\xE7\xE3o inv\xE1lida: ${y} (${x.message})`)}if(!Fe(a.props,f)){b=!1;break}}b&&o.push(a)}return r.type==="gantt"?this.runGantt(r,o):r.type==="table"?this.runTable(r,o):this.runStandard(r,o)}runTable(r,t){var e,o;return{rows:t.map(i=>({x:i.path,y:0,notes:[i.path],props:i.props})),xField:(e=r.encoding)==null?void 0:e.x,yField:(o=r.encoding)==null?void 0:o.y}}runGantt(r,t){var D,b,y;let n=(D=r.encoding)!=null?D:{},e=n.start,o=n.end,i=(b=n.label)!=null?b:n.x,d=n.series,l=n.duration,a=n.due,S=[];for(let f of t){let x=(y=f.props)!=null?y:{},R=w=>Array.isArray(w)?w[0]:w,g=null;if(o){let w=R(x[o]),N=$t(w);N&&(g=N)}if(!g)continue;let L=null;if(e){let w=R(x[e]),N=$t(w);N&&(L=N)}if(!L&&l){let w=R(x[l]),N=Number(w);Number.isNaN(N)||(L=new Date(g.getTime()-N*6e4))}L||(L=new Date(g.getTime()));let M;if(a){let w=R(x[a]),N=$t(w);N&&(M=N)}let E;if(i){let w=R(x[i]);(w==null||w==="")&&(w=f.path),E=w}else E=f.path;let Q;if(d){let w=R(x[d]);w!=null&&(Q=String(w))}let B={x:E,y:0,notes:[f.path],series:Q,start:L,end:g,props:x};M&&(B.due=M),S.push(B)}return S.sort((f,x)=>{let R=f.start?f.start.getTime():0,g=x.start?x.start.getTime():0;return R-g}),{rows:S,xField:i,yField:o}}runStandard(r,t){var f,x,R,g,L,M,E,Q,B,w;let n=(f=r.encoding)==null?void 0:f.x,e=(x=r.encoding)==null?void 0:x.y,o=(R=r.encoding)==null?void 0:R.series;if(!n)throw new Error("encoding.x \xE9 obrigat\xF3rio.");let i=(g=r.aggregate)!=null?g:{},d=(L=i.y)!=null?L:null,l=!!i.cumulative,a=i.rolling;if(!e&&d!=="count")throw new Error("encoding.y \xE9 obrigat\xF3rio (exceto quando aggregate.y = 'count').");let S=[];for(let N of t){let p=(M=N.props)!=null?M:{},A=P=>Array.isArray(P)?P[0]:P,u=A(p[n]);if(u==null)continue;let k=an(u),I=k.key,H=k.isDate,V;if(o){let P=A(p[o]);P!=null&&String(P).trim()!==""&&(V=String(P))}let _;if(d==="count")_=1;else{let P=A(p[e]);if(P==null)continue;let X=Number(P);if(Number.isNaN(X))continue;_=X}S.push({x:I,y:_,notes:[N.path],series:V,props:p,_isDate:H,_origX:u})}if(S.length===0)return{rows:[],xField:n,yField:e};let D=[];if(d){let N=new Map;for(let p of S){let A=(E=p.series)!=null?E:"",u=p.x instanceof Date?p.x.toISOString().slice(0,10):String(p.x),k=A+"||"+u,I=(Q=N.get(k))!=null?Q:{sum:0,count:0,min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY,notes:[],xRep:p.x,isDate:p._isDate,series:p.series,props:p.props};I.sum+=p.y,I.count+=1,p.y<I.min&&(I.min=p.y),p.y>I.max&&(I.max=p.y),I.notes.push(...p.notes),I.props=(B=p.props)!=null?B:I.props,N.set(k,I)}for(let[,p]of N){let A=p.sum;switch(d){case"sum":A=p.sum;break;case"avg":A=p.sum/p.count;break;case"min":A=p.min;break;case"max":A=p.max;break;case"count":A=p.count;break}D.push({x:p.xRep,y:A,notes:p.notes,series:p.series,props:p.props})}}else D=S.map(N=>({x:N.x,y:N.y,notes:N.notes,series:N.series,props:N.props}));if(D.length===0)return{rows:[],xField:n,yField:e};let b=((w=r.sort)==null?void 0:w.x)==="desc"?"desc":"asc";if(D.sort((N,p)=>{let A=cn(N,p);return b==="asc"?A:-A}),(l||a)&&!(r.type==="line"||r.type==="area"))throw new Error("aggregate.cumulative / aggregate.rolling s\xF3 s\xE3o suportados em type: 'line' ou 'area'.");if(l&&a)throw new Error("Ainda n\xE3o \xE9 poss\xEDvel usar 'cumulative' e 'rolling' juntos no mesmo gr\xE1fico.");let y=D;return a?y=pn(D,a):l&&(y=dn(D)),{rows:y,xField:n,yField:e}}};var Et=require("obsidian");var $e=["#5b6cff","#5ec27f","#ffb347","#ff6b6b","#b47cff","#4dbbd5","#f78fb3","#50e3a4"];function pt(s,r){if(!s)return"var(--text-accent, #5b6cff)";let t=Array.from(s).reduce((n,e)=>n*33+e.charCodeAt(0)>>>0,0);return $e[t%$e.length]}function vt(s,r){s.addClass("prop-charts-container"),s.style.width="100%",s.style.maxWidth="100%",s.style.position="relative";let t=s.createDiv({cls:"chart-notes-scroll"});t.style.overflowX="auto",t.style.overflowY="hidden",t.style.width="100%",t.style.maxWidth="100%";let n=t.createDiv({cls:"chart-notes-inner"});n.style.display="block",n.style.minHeight=`${300}px`,r&&(n.style.background=r);let e="http://www.w3.org/2000/svg",o=document.createElementNS(e,"svg");o.setAttribute("width","100%"),o.setAttribute("height",String(300)),o.style.display="block",n.appendChild(o);let i=s.createDiv({cls:"chart-notes-tooltip"});i.style.display="none";let d=s.createDiv({cls:"chart-notes-details"});return d.style.display="none",{scroll:t,inner:n,svg:o,tooltip:i,details:d}}function gt(s,r,t,n,e,o){let i=s.getBoundingClientRect(),d=typeof n=="number"?Number.isInteger(n)?String(n):n.toFixed(2):String(n);r.innerHTML=`
    <div class="chart-notes-tooltip-title">${t}</div>
    <div class="chart-notes-tooltip-value">${d}</div>
    <div class="chart-notes-tooltip-notes">${e} nota${e===1?"":"s"}</div>
  `,r.style.display="block";let l=r.getBoundingClientRect(),a=o.clientX-i.left+6,S=o.clientY-i.top+6;a+l.width>i.width-4&&(a=i.width-l.width-4),a<4&&(a=4),S+l.height>i.height-4&&(S=i.height-l.height-4),S<4&&(S=4),r.style.left=a+"px",r.style.top=S+"px"}function yt(s){s.style.display="none"}function bt(s,r,t,n,e,o){if(!o)return;if(r.empty(),!e||e.length===0){r.style.display="none";return}r.style.display="block";let i=r.createEl("div",{cls:"chart-notes-details-header"}),d=i.createEl("div",{cls:"chart-notes-details-title"});d.textContent=`Notas em "${t}" (${e.length})`+(Number.isFinite(n)&&n!==0?` \u2013 valor ${Number.isInteger(n)?n:n.toFixed(2)}`:"");let l=i.createEl("button",{cls:"chart-notes-details-close"});l.textContent="\xD7",l.addEventListener("click",()=>{r.style.display="none"});let a=r.createEl("ul",{cls:"chart-notes-details-list"});for(let S of e){let b=a.createEl("li",{cls:"chart-notes-details-item"}).createEl("a",{cls:"chart-notes-details-link",text:S});b.href="#",b.addEventListener("click",y=>{y.preventDefault(),app.workspace.openLinkText(S,"",!1)})}}function Pt(s){if(!(s instanceof Date)||isNaN(s.getTime()))return"";let r=s.getUTCDate().toString().padStart(2,"0"),t=(s.getUTCMonth()+1).toString().padStart(2,"0");return`${r}/${t}`}function He(s){if(!s)return!1;let r=s.trim().toLowerCase();if(r==="#fff"||r==="#ffffff"||r==="white")return!0;if(!r.startsWith("#"))return!1;let t,n,e;if(r.length===4)t=parseInt(r[1]+r[1],16),n=parseInt(r[2]+r[2],16),e=parseInt(r[3]+r[3],16);else if(r.length===7)t=parseInt(r.slice(1,3),16),n=parseInt(r.slice(3,5),16),e=parseInt(r.slice(5,7),16);else return!1;return(.2126*t+.7152*n+.0722*e)/255>.7}var fe=class extends Et.Modal{constructor(t,n,e,o){var d;super(app);this.notePath=t,this.spec=n,this.refresh=e,this.reindexFile=o;let i=(d=n.encoding)!=null?d:{};this.startKey=i.start,this.endKey=i.end,this.durationKey=i.duration,this.dueKey=i.due}async onOpen(){var w,N;let{contentEl:t}=this;t.empty(),this.titleEl.setText("Editar tarefa");let n=this.app.vault.getAbstractFileByPath(this.notePath);if(!(n instanceof Et.TFile)){t.createEl("p",{text:"Arquivo n\xE3o encontrado: "+this.notePath});return}this.titleEl.setText(`Editar tarefa \u2013 ${n.basename}`);let e=await this.app.vault.read(n),o={},i=e,d=e.match(/^---\n([\s\S]*?)\n---\n?([\s\S]*)$/);if(d){try{o=(w=(0,Et.parseYaml)(d[1]))!=null?w:{}}catch(p){o={}}i=(N=d[2])!=null?N:""}let l=t.createDiv({cls:"gantt-edit-form"}),a=p=>{let A=l.createDiv({cls:"gantt-edit-row"}),u=A.createDiv({cls:"gantt-edit-label"});u.textContent=p;let k=A.createDiv({cls:"gantt-edit-field"});return{row:A,field:k}},S=p=>{if(!p)return null;if(p instanceof Date&&!isNaN(p.getTime()))return p;let u=String(p).trim().match(/^(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2})(?::(\d{2}))?)?/);if(!u)return null;let k=Number(u[1]),I=Number(u[2])-1,H=Number(u[3]),V=u[4]?Number(u[4]):0,_=u[5]?Number(u[5]):0,P=u[6]?Number(u[6]):0;return Number.isNaN(k)||Number.isNaN(I)||Number.isNaN(H)||Number.isNaN(V)||Number.isNaN(_)||Number.isNaN(P)?null:new Date(k,I,H,V,_,P,0)},D=p=>{let A=S(p);if(!A)return"";let u=P=>P.toString().padStart(2,"0"),k=A.getFullYear(),I=u(A.getMonth()+1),H=u(A.getDate()),V=u(A.getHours()),_=u(A.getMinutes());return`${k}-${I}-${H}T${V}:${_}`},b=p=>{if(p=p.trim(),!p)return;let A=p.match(/^(\d{4})-(\d{2})-(\d{2})(?:T(\d{2}):(\d{2}))?$/);if(!A)return;let u=`${A[1]}-${A[2]}-${A[3]}`;if(A[4]){let k=A[4],I=A[5];return`${u}T${k}:${I}`}return u},y=null,f=null,x=null,R=null;if(this.startKey){let{field:p}=a(`In\xEDcio (${this.startKey})`);y=p.createEl("input"),y.type="datetime-local",y.value=D(o[this.startKey])}if(this.endKey){let{field:p}=a(`Fim (${this.endKey})`);f=p.createEl("input"),f.type="datetime-local",f.value=D(o[this.endKey])}if(this.durationKey){let{field:p}=a(`Dura\xE7\xE3o (min) (${this.durationKey})`);x=p.createEl("input"),x.type="number";let A=o[this.durationKey];x.value=typeof A=="number"&&!Number.isNaN(A)?String(A):""}if(this.dueKey){let{field:p}=a(`Due (${this.dueKey})`);R=p.createEl("input"),R.type="datetime-local",R.value=D(o[this.dueKey])}let g=l.createDiv({cls:"gantt-edit-actions-row"});g.style.marginTop="0.75rem",g.style.display="flex",g.style.justifyContent="space-between",g.style.alignItems="center";let L=g.createDiv({cls:"gantt-edit-actions-left"});L.style.display="flex";let M=g.createDiv({cls:"gantt-edit-actions-right"});M.style.display="flex",M.style.gap="0.5rem";let E=L.createEl("button",{text:"Abrir nota"}),Q=M.createEl("button",{text:"Salvar"}),B=M.createEl("button",{text:"Cancelar"});E.addEventListener("click",()=>{this.app.workspace.openLinkText(this.notePath,"",!1),this.close()}),B.addEventListener("click",()=>this.close()),Q.addEventListener("click",async()=>{if(this.startKey&&y){let u=b(y.value);u?o[this.startKey]=u:delete o[this.startKey]}if(this.endKey&&f){let u=b(f.value);u?o[this.endKey]=u:delete o[this.endKey]}if(this.durationKey&&x){let u=x.value.trim();if(u==="")delete o[this.durationKey];else{let k=Number(u);Number.isNaN(k)||(o[this.durationKey]=k)}}if(this.dueKey&&R){let u=b(R.value);u?o[this.dueKey]=u:delete o[this.dueKey]}let A=`---
${(0,Et.stringifyYaml)(o).trim()}
---
`+i;if(await this.app.vault.modify(n,A),this.reindexFile)try{await this.reindexFile(this.notePath)}catch(u){}if(this.refresh)try{this.refresh()}catch(u){}new Et.Notice("Task atualizada"),this.close()})}onClose(){this.contentEl.empty()}};function oe(s,r,t,n){var Se,xe,we,Ae,ve,De,Ne,Ee;let e=(Se=r.options)!=null?Se:{},o=e.background,i=(xe=e.drilldown)!=null?xe:!0,d=!0,l=h=>{if(h==null)return"";let $=String(h).trim();if(!$)return"";let K=$.match(/^\[\[(.+?)\]\]$/);K&&($=K[1]);let Z=$.lastIndexOf("/");return Z>=0&&Z<$.length-1&&($=$.slice(Z+1)),$};if(Array.from(s.querySelectorAll(".gantt-zoom-controls, .gantt-label-floating-btn, .chart-notes-scroll, .chart-notes-details, .chart-notes-tooltip, .prop-charts-empty")).forEach(h=>h.remove()),t.rows.length===0){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let a=t.rows.filter(h=>h.start&&h.end);if(a.length===0){s.createDiv({cls:"prop-charts-empty",text:"Gantt: faltam campos de data."});return}let S=r.encoding,D=S.group,b=S.duration,y=(h,$)=>{if(!h||!$)return;let K=h[$];return Array.isArray(K)?K[0]:K},f="__chartnotes_no_group__",R=a.map(h=>{var mt,wt;let $=h.start,K=h.end,Z=h.props,Ft=typeof h.x=="string"?h.x:h.x instanceof Date?Pt($):String(h.x),Tt=l(Ft),Dt=D!=null&&D!==""?y(Z,D):void 0,Ct=Dt!=null&&String(Dt).trim().length>0?String(Dt):f,ft=(mt=h.notes)==null?void 0:mt[0],kt=ft?(wt=ft.replace(/\.md$/i,"").split("/").pop())!=null?wt:ft:Tt,Bt=h.due,It,xt=y(Z,b);if(xt!=null){let Rt=Number(xt);Number.isNaN(Rt)||(It=Rt)}return{row:h,start:$,end:K,props:Z,fullName:Tt,groupKey:Ct,notePath:ft,noteTitle:kt,due:Bt,estMinutes:It}}).filter(h=>h.start instanceof Date&&!isNaN(h.start.getTime())&&h.end instanceof Date&&!isNaN(h.end.getTime()));if(R.length===0){s.createDiv({cls:"prop-charts-empty",text:"Gantt: datas inv\xE1lidas."});return}R.sort((h,$)=>{if(h.groupKey<$.groupKey)return-1;if(h.groupKey>$.groupKey)return 1;let K=h.start.getTime(),Z=$.start.getTime();return K!==Z?K-Z:h.fullName.localeCompare($.fullName)});let g=26,L=0,M=null;for(let h of R)h.groupKey!==M&&(M=h.groupKey,h.groupKey!==f&&(L+=1)),L+=1;let E=Math.min(...R.map(h=>h.start.getTime())),Q=Math.max(...R.map(h=>h.end.getTime()));if(!isFinite(E)||!isFinite(Q)){s.createDiv({cls:"prop-charts-empty",text:"Gantt: intervalo de datas inv\xE1lido."});return}let B=24*60*60*1e3,w=h=>{let $=new Date(h);return $.setHours(0,0,0,0),$.getTime()},N=w(E),p=w(Q),A=s.querySelector(".prop-charts-title-row");A||(A=s.createDiv({cls:"prop-charts-title-row"}));let u=s.dataset.ganttZoomMode||String((we=e.zoomMode)!=null?we:"100");s.dataset.ganttZoomMode=u;let k=s.dataset.ganttLabelMode||String((Ae=e.labelMode)!=null?Ae:"compact");s.dataset.ganttLabelMode=k;let I=A.createDiv({cls:"gantt-zoom-controls"});[{id:"fit",label:"Fit"},{id:"100",label:"100%"},{id:"150",label:"150%"},{id:"200",label:"200%"}].forEach(h=>{let $=I.createEl("button",{cls:"gantt-zoom-btn",text:h.label});h.id===u&&$.addClass("is-active"),$.addEventListener("click",K=>{K.preventDefault(),s.dataset.ganttZoomMode=h.id,oe(s,r,t,n)})});let V=Number(e.labelWidth),_=!Number.isNaN(V)&&V>120?V:260,P=k==="wide"?_+160:_,X=s.getBoundingClientRect().width||600,j=Math.max(X,820),m;if(u==="fit")m=X;else{let h=Number(u)/100||1;m=j*h}let{inner:F,svg:c,tooltip:v,details:C}=vt(s,o);F.style.width=m+"px";let G=(h,$,K,Z,Ft,Tt,Dt,Ut,Ct)=>{if(!h)return;let ft=Math.max(40,Z-8),Bt=Math.max(8,Math.floor(ft/6)),It=h.split(/\s+/),xt=[],mt="";for(let Mt of It){if(!mt){mt=Mt;continue}(mt+" "+Mt).length<=Bt?mt+=" "+Mt:(xt.push(mt),mt=Mt)}mt&&xt.push(mt);let wt=Ft+2,Rt=xt.length*wt,Kt=K-Rt/2+Ft;xt.forEach((Mt,qt)=>{let dt=document.createElementNS(c.namespaceURI,"text");dt.setAttribute("x",String($)),dt.setAttribute("y",String(Kt+qt*wt)),dt.setAttribute("text-anchor","start"),dt.setAttribute("font-size",String(Ft)),dt.setAttribute("fill","#111111"),Tt&&dt.setAttribute("font-weight",Tt),dt.textContent=Mt,Dt&&dt.addEventListener("mouseenter",ct=>Dt(ct)),Ut&&dt.addEventListener("mouseleave",()=>Ut()),Ct&&(dt.style.cursor="pointer",dt.addEventListener("click",ct=>Ct(ct))),c.appendChild(dt)})},T=28,nt=28,q=10,O=Math.max(300,T+nt+L*g+24);c.setAttribute("height",String(O));let rt=m-P-q,Y=T+6;c.style.color="#111111";let ut=p+B-N||1,st=N-ut*.02,at=p+B+ut*.08,ot=h=>P+(h-st)/(at-st)*rt,J=(at-st)/B,W=Math.max(4,Math.min(12,Math.floor(rt/90)||4)),tt=J/W,et=[1,2,3,5,7,10,14,21,30,60,90,180,365],lt=et[et.length-1];for(let h of et)if(h>=tt){lt=h;break}let St=[],Ot=w(st);for(let h=Ot;h<=at+.5*B;h+=lt*B)St.push(h);let Ht=document.createElementNS(c.namespaceURI,"line");Ht.setAttribute("x1",String(P)),Ht.setAttribute("y1",String(Y)),Ht.setAttribute("x2",String(m-q)),Ht.setAttribute("y2",String(Y)),Ht.setAttribute("stroke","#111111"),c.appendChild(Ht);for(let h of St){let $=ot(h),K=document.createElementNS(c.namespaceURI,"line");K.setAttribute("x1",String($)),K.setAttribute("y1",String(Y)),K.setAttribute("x2",String($)),K.setAttribute("y2",String(O-nt)),K.setAttribute("stroke","#111111"),K.setAttribute("stroke-opacity","0.20"),K.setAttribute("stroke-dasharray","2,4"),c.appendChild(K);let Z=document.createElementNS(c.namespaceURI,"text");Z.setAttribute("x",String($)),Z.setAttribute("y",String(Y-4)),Z.setAttribute("text-anchor","middle"),Z.setAttribute("font-size","10"),Z.setAttribute("fill","#111111"),Z.textContent=Pt(new Date(h)),c.appendChild(Z)}let be=new Date;be.setHours(0,0,0,0);let ce=be.getTime();if(ce>=st&&ce<=at){let h=ot(ce),$=document.createElementNS(c.namespaceURI,"line");$.setAttribute("x1",String(h)),$.setAttribute("y1",String(Y)),$.setAttribute("x2",String(h)),$.setAttribute("y2",String(O-nt)),$.setAttribute("stroke","#4caf50"),$.setAttribute("stroke-width","2"),$.setAttribute("stroke-dasharray","4,2"),c.appendChild($);let K=document.createElementNS(c.namespaceURI,"text");K.setAttribute("x",String(h+4)),K.setAttribute("y",String(Y+12)),K.setAttribute("font-size","10"),K.setAttribute("fill","#4caf50"),K.textContent="hoje",c.appendChild(K)}let Xt=F.createEl("button",{cls:"gantt-label-floating-btn",text:"\u2194"});Xt.setAttr("title",k==="wide"?"Compactar nomes":"Expandir nomes"),Xt.style.left=`${P}px`,Xt.style.top="4px",Xt.addEventListener("click",h=>{h.preventDefault();let K=(s.dataset.ganttLabelMode||"compact")==="wide"?"compact":"wide";s.dataset.ganttLabelMode=K,oe(s,r,t,n)});let Ve=["status","priority"],ue=Array.isArray(e.tooltipFields)?e.tooltipFields.map(h=>String(h)):null,Ue=ue&&ue.length?ue:Ve,Gt=0,zt=null;for(let h of R){let $=h.start,K=h.end,Z=(K.getTime()-$.getTime())/6e4,Ft=h.props,Tt=h.notePath,Dt=h.noteTitle,Ut=(De=(ve=h.row.notes)==null?void 0:ve.length)!=null?De:0,Ct=h.due,ft=h.estMinutes,kt=[];kt.push(`${Pt($)} \u2192 ${Pt(K)}`),typeof ft=="number"&&!Number.isNaN(ft)?kt.push(`est: ${Math.round(ft)} min`):Z>0&&kt.push(`dura\xE7\xE3o: ${Math.round(Z)} min`),Ct instanceof Date&&kt.push(`due: ${Pt(Ct)}`);for(let it of Ue){let z=y(Ft,it);z!=null&&String(z).trim()!==""&&kt.push(`${it}: ${String(z)}`)}let Bt=kt.join("<br>"),It=it=>{var z;it.preventDefault(),d&&Tt?new fe(Tt,r,n==null?void 0:n.refresh,n==null?void 0:n.reindexFile).open():bt(s,C,Dt,ft!=null?ft:Z,(z=h.row.notes)!=null?z:[],i)},xt=it=>{Dt&&Bt&&gt(s,v,Dt,Bt,Ut,it)},mt=()=>yt(v);if(h.groupKey!==zt&&(zt=h.groupKey,zt!==f)){let it=Y+8+Gt*g+g/2,z=l(zt);G(z,4,it,P-12,11,"600"),Gt+=1}let wt=Y+8+Gt*g,Rt=g-10,Kt=ot($.getTime()),Mt=ot(K.getTime()),qt=Math.max(4,Mt-Kt),dt=h.fullName,ct=document.createElementNS(c.namespaceURI,"rect");ct.setAttribute("x",String(Kt)),ct.setAttribute("y",String(wt)),ct.setAttribute("width",String(qt)),ct.setAttribute("height",String(Rt)),ct.setAttribute("rx","3"),ct.setAttribute("ry","3"),ct.setAttribute("fill",pt((Ne=h.row.series)!=null?Ne:dt,Gt)),ct.setAttribute("stroke","rgba(0,0,0,0.25)"),ct.setAttribute("stroke-width","0.5"),ct.style.cursor=d&&Tt?"pointer":"default",ct.addEventListener("mouseenter",xt),ct.addEventListener("mouseleave",mt),ct.addEventListener("click",It),c.appendChild(ct);let Te=wt+Rt/2;if(qt>=6){let it=pt((Ee=h.row.series)!=null?Ee:dt,Gt),z=document.createElementNS(c.namespaceURI,"circle");z.setAttribute("cx",String(Kt)),z.setAttribute("cy",String(Te)),z.setAttribute("r","3.5"),z.setAttribute("fill","#ffffff"),z.setAttribute("stroke",it),z.setAttribute("stroke-width","1.5"),c.appendChild(z);let _t=document.createElementNS(c.namespaceURI,"circle");_t.setAttribute("cx",String(Mt)),_t.setAttribute("cy",String(Te)),_t.setAttribute("r","3.5"),_t.setAttribute("fill","#ffffff"),_t.setAttribute("stroke",it),_t.setAttribute("stroke-width","1.5"),c.appendChild(_t)}let Ce=wt+Rt/2+2,jt=4;if(k==="wide")G(dt,jt,Ce,P-jt-4,11,null,xt,mt,It);else{let it=dt,z=Math.max(40,P-jt-8),ke=Math.max(8,Math.floor(z/6));it.length>ke&&(it=it.slice(0,ke-1)+"\u2026");let At=document.createElementNS(c.namespaceURI,"text");At.setAttribute("x",String(jt)),At.setAttribute("y",String(Ce)),At.setAttribute("text-anchor","start"),At.setAttribute("font-size","11"),At.setAttribute("fill","#111111"),At.textContent=it,At.style.cursor="pointer",At.addEventListener("mouseenter",xt),At.addEventListener("mouseleave",mt),At.addEventListener("click",It),c.appendChild(At)}if(Ct instanceof Date){let it=ot(Ct.getTime()),z=document.createElementNS(c.namespaceURI,"line");z.setAttribute("x1",String(it)),z.setAttribute("y1",String(wt)),z.setAttribute("x2",String(it)),z.setAttribute("y2",String(wt+Rt)),z.setAttribute("stroke","#ff6b6b"),z.setAttribute("stroke-width","2"),z.setAttribute("stroke-dasharray","4,2"),c.appendChild(z)}Gt+=1}if(d){let h=s.createDiv({cls:"prop-charts-empty"});h.textContent="Clique em uma barra ou no nome para ajustar datas e estimate da tarefa."}}function ge(s,r,t){var X,j,m,F;let n=(X=r.options)!=null?X:{},e=n.background,o=(j=n.drilldown)!=null?j:!0,i=(m=t.rows)!=null?m:[];if(!i.length){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let{inner:d,svg:l,tooltip:a,details:S}=vt(s,e),D=s.getBoundingClientRect().width||600,b=Math.max(D,480);d.style.width=b+"px";let y=40,f=16,x=18,R=28,g=300;l.setAttribute("height",String(g));let L=b-y-f,M=g-x-R,E=new Map;for(let c of i){let v=String(c.x),C=(F=E.get(v))!=null?F:{label:c.x,rows:[]};C.rows.push(c),E.set(v,C)}let B=Array.from(E.keys()).sort((c,v)=>c<v?-1:c>v?1:0).map(c=>E.get(c)),w=B.length,N=c=>String(c!=null?c:""),p=new Set;i.forEach(c=>{c.series!=null&&p.add(N(c.series))});let A=Array.from(p),u=A.length>1,k=u?"grouped":"single",I=0;i.forEach(c=>{c.y>I&&(I=c.y)}),(!isFinite(I)||I<=0)&&(I=1);let H=c=>x+M-c/(I||1)*M,V=H(0),_=4;for(let c=0;c<=_;c++){let v=I*c/_,C=H(v),G=document.createElementNS(l.namespaceURI,"line");G.setAttribute("x1",String(y)),G.setAttribute("y1",String(C)),G.setAttribute("x2",String(b-f)),G.setAttribute("y2",String(C)),G.setAttribute("stroke","#cccccc"),G.setAttribute("stroke-opacity","0.25"),l.appendChild(G);let T=document.createElementNS(l.namespaceURI,"text");T.setAttribute("x",String(y-4)),T.setAttribute("y",String(C+3)),T.setAttribute("text-anchor","end"),T.setAttribute("font-size","10"),T.setAttribute("fill","#111111"),T.textContent=String(Math.round(v)),l.appendChild(T)}let P=w>0?L/w:L;if(B.forEach((c,v)=>{let C=y+P*(v+.5),G=String(c.label),T=document.createElementNS(l.namespaceURI,"text");T.setAttribute("x",String(C)),T.setAttribute("y",String(g-R+12)),T.setAttribute("text-anchor","middle"),T.setAttribute("font-size","10"),T.setAttribute("fill","#111111"),T.textContent=G,l.appendChild(T)}),u){let c=s.createDiv({cls:"chart-notes-legend"});A.forEach((v,C)=>{let G=c.createDiv({cls:"chart-notes-legend-item"}),T=G.createDiv();T.style.width="10px",T.style.height="10px",T.style.borderRadius="999px",T.style.backgroundColor=pt(v,C),G.createSpan({text:v})})}B.forEach((c,v)=>{let C=y+P*(v+.5),G=c.rows;if(k==="single"){let rt=G[0],Y=rt.y,ut=P*.6,st=C-ut/2,at=H(Y),ot=Math.max(2,V-at),J=pt("bar",v),U=document.createElementNS(l.namespaceURI,"rect");U.setAttribute("x",String(st)),U.setAttribute("y",String(at)),U.setAttribute("width",String(ut)),U.setAttribute("height",String(ot)),U.setAttribute("fill",J),U.setAttribute("stroke","rgba(0,0,0,0.25)"),U.setAttribute("stroke-width","0.5"),U.style.cursor="pointer";let W=String(c.label),tt=`valor: ${Math.round(Y*100)/100}`;U.addEventListener("mouseenter",et=>{var lt,St;return gt(s,a,W,tt,(St=(lt=rt.notes)==null?void 0:lt.length)!=null?St:0,et)}),U.addEventListener("mouseleave",()=>yt(a)),U.addEventListener("click",et=>{var lt;et.preventDefault(),bt(s,S,W,Y,(lt=rt.notes)!=null?lt:[],o)}),l.appendChild(U);return}let T=A.length,nt=P/Math.max(T+1,2),q=T*nt,O=C-q/2;A.forEach((rt,Y)=>{let ut=G.find(lt=>lt.series!=null&&N(lt.series)===rt);if(!ut)return;let st=ut.y,at=O+Y*nt,ot=H(st),J=Math.max(2,V-ot),U=pt(rt,Y),W=document.createElementNS(l.namespaceURI,"rect");W.setAttribute("x",String(at)),W.setAttribute("y",String(ot)),W.setAttribute("width",String(nt)),W.setAttribute("height",String(J)),W.setAttribute("fill",U),W.setAttribute("stroke","rgba(0,0,0,0.25)"),W.setAttribute("stroke-width","0.5"),W.style.cursor="pointer";let tt=`${rt} @ ${String(c.label)}`,et=`valor: ${Math.round(st*100)/100}`;W.addEventListener("mouseenter",lt=>{var St,Ot;return gt(s,a,tt,et,(Ot=(St=ut.notes)==null?void 0:St.length)!=null?Ot:0,lt)}),W.addEventListener("mouseleave",()=>yt(a)),W.addEventListener("click",lt=>{var St;lt.preventDefault(),bt(s,S,tt,st,(St=ut.notes)!=null?St:[],o)}),l.appendChild(W)})})}function Ge(s,r,t){var _,P,X,j;let n=(_=r.options)!=null?_:{},e=n.background,o=(P=n.drilldown)!=null?P:!0,i=(X=t.rows)!=null?X:[];if(!i.length){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let d=new Map;for(let m of i){let F=String(m.x),c=(j=d.get(F))!=null?j:{label:m.x,rows:[]};c.rows.push(m),d.set(F,c)}let a=Array.from(d.keys()).sort((m,F)=>m<F?-1:m>F?1:0).map(m=>d.get(m)),S=a.length,D=m=>String(m!=null?m:""),b=new Set(i.map(m=>D(m.series))),y=Array.from(b);if(y.length===1&&y[0]===""){ge(s,r,t);return}let{inner:f,svg:x,tooltip:R,details:g}=vt(s,e),L=s.getBoundingClientRect().width||600,M=Math.max(L,480);f.style.width=M+"px",x.setAttribute("width",String(M));let E=40,Q=16,B=18,w=28,N=300;x.setAttribute("height",String(N));let p=M-E-Q,A=N-B-w,u=0;a.forEach(m=>{let F=m.rows.reduce((c,v)=>c+(v.y||0),0);F>u&&(u=F)}),(!isFinite(u)||u<=0)&&(u=1);let k=m=>B+A-m/(u||1)*A,I=4;for(let m=0;m<=I;m++){let F=u*m/I,c=k(F),v=document.createElementNS(x.namespaceURI,"line");v.setAttribute("x1",String(E)),v.setAttribute("y1",String(c)),v.setAttribute("x2",String(M-Q)),v.setAttribute("y2",String(c)),v.setAttribute("stroke","#cccccc"),v.setAttribute("stroke-opacity","0.25"),x.appendChild(v);let C=document.createElementNS(x.namespaceURI,"text");C.setAttribute("x",String(E-4)),C.setAttribute("y",String(c+3)),C.setAttribute("text-anchor","end"),C.setAttribute("font-size","10"),C.setAttribute("fill","#111111"),C.textContent=String(Math.round(F)),x.appendChild(C)}let H=S>0?p/S:p;a.forEach((m,F)=>{let c=E+H*(F+.5),v=String(m.label),C=document.createElementNS(x.namespaceURI,"text");C.setAttribute("x",String(c)),C.setAttribute("y",String(N-w+12)),C.setAttribute("text-anchor","middle"),C.setAttribute("font-size","10"),C.setAttribute("fill","#111111"),C.textContent=v,x.appendChild(C)});let V=f.createDiv({cls:"chart-notes-legend"});y.forEach((m,F)=>{if(m==="")return;let c=V.createDiv({cls:"chart-notes-legend-item"}),v=c.createDiv();v.style.width="10px",v.style.height="10px",v.style.borderRadius="999px",v.style.backgroundColor=pt(m,F),c.createSpan({text:m})}),a.forEach((m,F)=>{let c=E+H*(F+.5),v=H*.6,C=c-v/2,G=0;y.forEach((T,nt)=>{if(T==="")return;let q=m.rows.find(tt=>D(tt.series)===T);if(!q)return;let O=q.y||0,rt=G,Y=G+O;G=Y;let ut=k(rt),st=k(Y),at=Math.max(2,ut-st),ot=pt(T,nt),J=document.createElementNS(x.namespaceURI,"rect");J.setAttribute("x",String(C)),J.setAttribute("y",String(st)),J.setAttribute("width",String(v)),J.setAttribute("height",String(at)),J.setAttribute("fill",ot),J.setAttribute("stroke","rgba(0,0,0,0.25)"),J.setAttribute("stroke-width","0.5"),J.style.cursor="pointer";let U=`${T} @ ${String(m.label)}`,W=`valor: ${Math.round(O*100)/100}`;J.addEventListener("mouseenter",tt=>{var et,lt;return gt(s,R,U,W,(lt=(et=q.notes)==null?void 0:et.length)!=null?lt:0,tt)}),J.addEventListener("mouseleave",()=>yt(R)),J.addEventListener("click",tt=>{var et;tt.preventDefault(),bt(s,g,U,O,(et=q.notes)!=null?et:[],o)}),x.appendChild(J)})})}function Wt(s){if(!s)return null;if(s instanceof Date){let r=s.getTime();return Number.isNaN(r)?null:s}if(typeof s=="string"){let r=s.trim();if(!r||/^\d+$/.test(r))return null;let t=new Date(r);if(!Number.isNaN(t.getTime()))return t}return null}function ye(s,r,t,n){var _,P,X,j;let e=(_=r.options)!=null?_:{},o=e.background,i=(P=e.drilldown)!=null?P:!0,d=(X=t.rows)!=null?X:[];if(!d.length){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let{inner:l,svg:a,tooltip:S,details:D}=vt(s,o),b=s.getBoundingClientRect().width||600,y=Math.max(b,480);l.style.width=y+"px";let f=40,x=16,R=18,g=28,L=300;a.setAttribute("height",String(L));let M=y-f-x,E=L-R-g,Q=d.map(m=>Wt(m.x)).filter(m=>!!m),B=Q.length>=2&&Q.length>=d.length*.6,w=new Map;for(let m of d){let F=m.series!=null&&m.series!==""?String(m.series):"__default__",c=(j=w.get(F))!=null?j:[];c.push(m),w.set(F,c)}let N=Array.from(w.keys()),p,A;if(B){let F=Q.map(U=>U.getTime()).sort((U,W)=>U-W),c=F[0],v=F[F.length-1];c===v&&(c-=864e5,v+=864e5);let C=v-c||864e5,G=c-C*.02,T=v+C*.02;p=U=>{let W=Wt(U);if(!W)return f;let tt=W.getTime();return f+(tt-G)/(T-G||1)*M},A=U=>{let W=Wt(U);return W?Pt(W):String(U)};let nt=R+E,q=document.createElementNS(a.namespaceURI,"line");q.setAttribute("x1",String(f)),q.setAttribute("y1",String(nt)),q.setAttribute("x2",String(y-x)),q.setAttribute("y2",String(nt)),q.setAttribute("stroke","#111111"),q.setAttribute("stroke-width","1"),a.appendChild(q);let O=(T-G)/864e5,Y=Math.max(3,Math.min(10,Math.floor(M/90)||3)),ut=O/Y,st=[1,2,3,5,7,10,14,21,30,60,90,180,365],at=st[st.length-1];for(let U of st)if(U>=ut){at=U;break}let J=(U=>{let W=new Date(U);return W.setHours(0,0,0,0),W.getTime()})(G);for(let U=J;U<=T+.5*864e5;U+=at*864e5){let W=f+(U-G)/(T-G)*M,tt=document.createElementNS(a.namespaceURI,"line");tt.setAttribute("x1",String(W)),tt.setAttribute("y1",String(R)),tt.setAttribute("x2",String(W)),tt.setAttribute("y2",String(nt)),tt.setAttribute("stroke","#111111"),tt.setAttribute("stroke-opacity","0.18"),tt.setAttribute("stroke-dasharray","2,4"),a.appendChild(tt);let et=document.createElementNS(a.namespaceURI,"text");et.setAttribute("x",String(W)),et.setAttribute("y",String(nt+12)),et.setAttribute("text-anchor","middle"),et.setAttribute("font-size","10"),et.setAttribute("fill","#111111"),et.textContent=Pt(new Date(U)),a.appendChild(et)}}else{let m=[],F=new Set;for(let v of d){let C=String(v.x);F.has(C)||(F.add(C),m.push(v.x))}let c=m.length||1;p=v=>{let C=String(v),G=m.findIndex(T=>String(T)===C);return G<0?f:c===1?f+M/2:f+G/(c-1)*M},A=v=>String(v)}let u=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY;for(let m of d)m.y<u&&(u=m.y),m.y>k&&(k=m.y);(!isFinite(u)||!isFinite(k))&&(u=0,k=1),u===k&&(u===0?k=1:u=0);let I=m=>R+E-(m-u)/(k-u||1)*E,H=4;for(let m=0;m<=H;m++){let F=u+(k-u)*m/H,c=I(F),v=document.createElementNS(a.namespaceURI,"line");v.setAttribute("x1",String(f)),v.setAttribute("y1",String(c)),v.setAttribute("x2",String(y-x)),v.setAttribute("y2",String(c)),v.setAttribute("stroke","#cccccc"),v.setAttribute("stroke-opacity","0.25"),a.appendChild(v);let C=document.createElementNS(a.namespaceURI,"text");C.setAttribute("x",String(f-4)),C.setAttribute("y",String(c+3)),C.setAttribute("text-anchor","end"),C.setAttribute("font-size","10"),C.setAttribute("fill","#111111"),C.textContent=Math.abs(F)>=100?String(Math.round(F)):String(Math.round(F*10)/10),a.appendChild(C)}let V=N.filter(m=>m!=="__default__");if(V.length>1){let m=s.createDiv({cls:"chart-notes-legend"});V.forEach((F,c)=>{let v=F,C=m.createDiv({cls:"chart-notes-legend-item"}),G=C.createDiv();G.style.width="10px",G.style.height="10px",G.style.borderRadius="999px",G.style.backgroundColor=pt(v,c),C.createSpan({text:v})})}N.forEach((m,F)=>{let c=w.get(m);if(!(c!=null&&c.length))return;let v=m==="__default__"?pt("line",F):pt(m,F),C=[...c];B&&C.sort((T,nt)=>{let q=Wt(T.x),O=Wt(nt.x),rt=q?q.getTime():0,Y=O?O.getTime():0;return rt-Y});let G="";if(C.forEach((T,nt)=>{let q=p(T.x),O=I(T.y);G+=(nt===0?"M ":" L ")+q+" "+O}),n){let T=C[0],nt=C[C.length-1],q=p(T.x),O=p(nt.x),rt=I(u);G+=` L ${O} ${rt} L ${q} ${rt} Z`;let Y=document.createElementNS(a.namespaceURI,"path");Y.setAttribute("d",G),Y.setAttribute("fill",v),Y.setAttribute("fill-opacity","0.18"),Y.setAttribute("stroke",v),Y.setAttribute("stroke-width","1.5"),a.appendChild(Y)}else{let T=document.createElementNS(a.namespaceURI,"path");T.setAttribute("d",G),T.setAttribute("fill","none"),T.setAttribute("stroke",v),T.setAttribute("stroke-width","2"),a.appendChild(T)}C.forEach(T=>{let nt=p(T.x),q=I(T.y),O=document.createElementNS(a.namespaceURI,"circle");O.setAttribute("cx",String(nt)),O.setAttribute("cy",String(q)),O.setAttribute("r","3"),O.setAttribute("fill","#ffffff"),O.setAttribute("stroke",v),O.setAttribute("stroke-width","1.5"),O.style.cursor="pointer";let rt=A(T.x),Y=m==="__default__"?"":String(T.series),ut=Y?`${Y} @ ${rt}`:rt,st=`valor: ${Math.round(T.y*100)/100}`;O.addEventListener("mouseenter",at=>{var ot,J;return gt(s,S,ut,st,(J=(ot=T.notes)==null?void 0:ot.length)!=null?J:0,at)}),O.addEventListener("mouseleave",()=>yt(S)),O.addEventListener("click",at=>{var ot;at.preventDefault(),bt(s,D,ut,T.y,(ot=T.notes)!=null?ot:[],i)}),a.appendChild(O)})})}function Be(s,r,t){var M;let{background:n,drilldown:e=!0}=(M=r.options)!=null?M:{};if(t.rows.length===0){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let o=He(n)?"#000000":void 0,i=s.getBoundingClientRect().width||600,{inner:d,svg:l,tooltip:a,details:S}=vt(s,n),D=Math.max(i,420);d.style.width=D+"px",o&&(l.style.color=o);let b=300,y=D/2,f=(b-28+28)/2,x=Math.min(D/2-20,b/2-20),g=t.rows.map(E=>Math.max(0,E.y)).reduce((E,Q)=>E+Q,0)||1,L=-Math.PI/2;t.rows.forEach((E,Q)=>{var _;let B=E.x instanceof Date?E.x.toISOString().slice(0,10):String(E.x),w=E.y,N=w/g*Math.PI*2,p=y+x*Math.cos(L),A=f+x*Math.sin(L),u=y+x*Math.cos(L+N),k=f+x*Math.sin(L+N),I=N>Math.PI?1:0,H=document.createElementNS(l.namespaceURI,"path"),V=[`M ${y} ${f}`,`L ${p} ${A}`,`A ${x} ${x} 0 ${I} 1 ${u} ${k}`,"Z"].join(" ");H.setAttribute("d",V),H.setAttribute("fill",pt((_=E.series)!=null?_:B,Q)),H.style.cursor="pointer",H.addEventListener("mouseenter",P=>{var X,j;return gt(s,a,B,w,(j=(X=E.notes)==null?void 0:X.length)!=null?j:0,P)}),H.addEventListener("mouseleave",()=>yt(a)),H.addEventListener("click",()=>{var P;return bt(s,S,B,w,(P=E.notes)!=null?P:[],e)}),l.appendChild(H),L+=N})}function Qe(s,r,t){var A;let{background:n,drilldown:e=!0}=(A=r.options)!=null?A:{};if(t.rows.length===0){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let o=n?"#111111":void 0,i=s.getBoundingClientRect().width||600,{inner:d,svg:l,tooltip:a,details:S}=vt(s,n),D=Math.max(i,700);d.style.width=D+"px",o&&(l.style.color=o);let b=300,y=D-48-10,f=b-28-28,x=t.rows.map(u=>{let k=u.x;if(k instanceof Date)return k.getTime();if(typeof k=="string"){if(/^\d{4}-\d{2}-\d{2}/.test(k)){let H=new Date(k);if(!isNaN(H.getTime()))return H.getTime()}let I=Number(k);return isNaN(I)?null:I}return typeof k=="number"?k:null}),R=t.rows.map(u=>u.y),g=x.filter(u=>u!==null);if(g.length===0){s.createDiv({cls:"prop-charts-empty",text:"Sem dados (X n\xE3o \xE9 num\xE9rico/data)."});return}let L=Math.min(...g),M=Math.max(...g),E=Math.min(...R),Q=Math.max(...R),B=u=>48+(u-L)/(M-L||1)*y,w=u=>b-28-(u-E)/(Q-E||1)*f,N=document.createElementNS(l.namespaceURI,"line");N.setAttribute("x1",String(48)),N.setAttribute("y1",String(28)),N.setAttribute("x2",String(48)),N.setAttribute("y2",String(b-28)),N.setAttribute("stroke","currentColor"),l.appendChild(N);let p=document.createElementNS(l.namespaceURI,"line");p.setAttribute("x1",String(48)),p.setAttribute("y1",String(b-28)),p.setAttribute("x2",String(D-10)),p.setAttribute("y2",String(b-28)),p.setAttribute("stroke","currentColor"),l.appendChild(p),t.rows.forEach((u,k)=>{let I=x[k];if(I==null)return;let H=B(I),V=w(R[k]),_=document.createElementNS(l.namespaceURI,"circle");_.setAttribute("cx",String(H)),_.setAttribute("cy",String(V)),_.setAttribute("r","4"),_.setAttribute("fill",pt(u.series,k)),_.style.cursor="pointer";let P=u.x instanceof Date?u.x.toISOString().slice(0,10):typeof u.x=="string"?u.x:String(u.x);_.addEventListener("mouseenter",X=>{var j,m;return gt(s,a,P,u.y,(m=(j=u.notes)==null?void 0:j.length)!=null?m:0,X)}),_.addEventListener("mouseleave",()=>yt(a)),_.addEventListener("click",X=>{var j;X.preventDefault(),bt(s,S,P,u.y,(j=u.notes)!=null?j:[],e)}),l.appendChild(_)})}var ae=class{render(r,t,n,e){var l;let{title:o}=(l=t.options)!=null?l:{};r.empty(),r.addClass("prop-charts-container");let d=r.createDiv({cls:"prop-charts-title-row"}).createDiv({cls:"prop-charts-title"});switch(o&&(d.textContent=o),t.type){case"bar":ge(r,t,n);break;case"stacked-bar":Ge(r,t,n);break;case"line":ye(r,t,n,!1);break;case"area":ye(r,t,n,!0);break;case"pie":Be(r,t,n);break;case"scatter":Qe(r,t,n);break;case"gantt":oe(r,t,n,e);break;default:r.createDiv({text:"Chart Notes: tipo n\xE3o suportado: "+t.type})}}};var le=class extends Vt.Plugin{constructor(t,n){super(t,n)}async onload(){console.log("Chart Notes: loading plugin (Bases-only)"),this.indexer=new ee(this.app),await this.indexer.buildIndex(),this.query=new se(()=>this.indexer.getAll(),[]),this.renderer=new ae,this.registerEvent(this.app.vault.on("modify",async t=>{t instanceof Vt.TFile&&await this.indexer.updateFile(t)})),this.registerEvent(this.app.vault.on("create",async t=>{t instanceof Vt.TFile&&await this.indexer.updateFile(t)})),this.registerEvent(this.app.vault.on("delete",async t=>{t instanceof Vt.TFile&&this.indexer.removeFile(t)})),this.registerBasesView(pe,{name:"Chart Notes",icon:"lucide-chart-area",factory:(t,n)=>new Jt(t,n,this.renderer),options:()=>{let t=[];return t.push({type:"dropdown",key:"chartType",displayName:"Chart type",description:"Type of chart to render",default:"bar",options:{bar:"Bar","stacked-bar":"Stacked bar",line:"Line",area:"Area",pie:"Pie",scatter:"Scatter",gantt:"Gantt"}}),t.push({type:"property",key:"xProperty",displayName:"X axis / category (bars & slices)",description:"Property used for the X axis or categories (for pie, this is the slice).",shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")==="gantt"}}),t.push({type:"property",key:"ganttLabelProperty",displayName:"Task label (Gantt)",description:`Label for each task bar.
If empty, uses the note title.`,shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")!=="gantt"}}),t.push({type:"property",key:"yProperty",displayName:"Y value (empty = count)",description:`Numeric property summed on the Y axis.
Leave empty to just count notes.`,shouldHide:n=>{var o;let e=String((o=n.get("chartType"))!=null?o:"bar");return e==="pie"||e==="gantt"}}),t.push({type:"property",key:"seriesProperty",displayName:"Series / color (optional)",description:"Property that defines series / color for bars, lines and area.",shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")==="pie"}}),t.push({type:"dropdown",key:"aggregateMode",displayName:"Value aggregation (Y)",description:`How to aggregate Y when multiple notes share the same X/series.
For line/area, 'Cumulative sum' turns the series into a running total.`,default:"sum",options:{sum:"Sum",count:"Count (ignore Y)","cumulative-sum":"Cumulative sum"},shouldHide:n=>{var o;let e=String((o=n.get("chartType"))!=null?o:"bar");return e==="scatter"||e==="gantt"}}),t.push({type:"dropdown",key:"xBucket",displayName:"X bucket (dates)",description:"How to bucket dates on the X axis for line / area charts (day, week, month...).",default:"auto",options:{auto:"Auto",none:"None",day:"Day",week:"Week",month:"Month",quarter:"Quarter",year:"Year"},shouldHide:n=>{var o;let e=String((o=n.get("chartType"))!=null?o:"bar");return!(e==="line"||e==="area")}}),t.push({type:"property",key:"startProperty",displayName:"Start (Gantt)",description:"Start date/datetime for the task.",shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")!=="gantt"}}),t.push({type:"property",key:"endProperty",displayName:"End (Gantt)",description:"End date/datetime for the task.",shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")!=="gantt"}}),t.push({type:"property",key:"dueProperty",displayName:"Due (deadline, optional)",description:"Due date / deadline for the task.",shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")!=="gantt"}}),t.push({type:"property",key:"durationProperty",displayName:"Duration in minutes (optional)",description:`Duration of the task in minutes.
Used together with start/end/due.`,shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")!=="gantt"}}),t.push({type:"toggle",key:"drilldown",displayName:"Drilldown (click opens notes)",default:!0}),t.push({type:"text",key:"title",displayName:"Title (optional)",description:`Custom chart title.
Falls back to the view name.`}),t}})}onunload(){console.log("Chart Notes: unloading plugin")}};
