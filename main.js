/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var ue=Object.defineProperty;var Ke=Object.getOwnPropertyDescriptor;var Ye=Object.getOwnPropertyNames;var We=Object.prototype.hasOwnProperty;var Oe=(s,r)=>{for(var t in r)ue(s,t,{get:r[t],enumerable:!0})},Xe=(s,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let e of Ye(r))!We.call(s,e)&&e!==t&&ue(s,e,{get:()=>r[e],enumerable:!(n=Ke(r,e))||n.enumerable});return s};var ze=s=>Xe(ue({},"__esModule",{value:!0}),s);var mn={};Oe(mn,{default:()=>ae});module.exports=ze(mn);var Qt=require("obsidian");var Jt=require("obsidian"),de="chartnotes-view",qe=["bar","stacked-bar","line","area","pie","scatter","gantt"];function je(s){let r=String(s!=null?s:"bar").trim().toLowerCase();return qe.includes(r)?r:"bar"}var Ze=["sum","count","cumulative-sum"];function Je(s){let r=String(s!=null?s:"sum").trim().toLowerCase();return Ze.includes(r)?r:"sum"}var tn=["auto","none","day","week","month","quarter","year"];function en(s){let r=String(s!=null?s:"auto").trim().toLowerCase();return tn.includes(r)?r:"auto"}var jt="(missing)",Zt=class extends Jt.BasesView{constructor(t,n,e){super(t);this.type=de;this.renderer=e,this.rootEl=n.createDiv("chartnotes-bases-view")}onDataUpdated(){var P,z,J;this.rootEl.empty();let t=this.data,n=(P=t==null?void 0:t.groupedData)!=null?P:[];if(!n.length){this.rootEl.createDiv({cls:"prop-charts-empty",text:"No data in this view."});return}let e=this.config,o=je((z=e==null?void 0:e.get("chartType"))!=null?z:"bar"),i=o==="pie",d=o==="scatter",a=o==="gantt",l=Je(e==null?void 0:e.get("aggregateMode")),w=l==="cumulative-sum"&&!(o==="line"||o==="area")?"sum":l,y=en(e==null?void 0:e.get("xBucket")),b=i||d||a?"none":y,f=this.getPropFromConfig("xProperty"),E=this.getPropFromConfig("ganttLabelProperty"),k=this.getPropFromConfig("yProperty"),g=this.getPropFromConfig("seriesProperty");i&&(g={id:null,name:null});let L=this.getPropFromConfig("startProperty"),M=this.getPropFromConfig("endProperty"),T=this.getPropFromConfig("dueProperty"),K=this.getPropFromConfig("durationProperty"),H=this.getPropFromConfig("groupProperty");if(!a&&!f.id){this.rootEl.createDiv({cls:"prop-charts-empty",text:"Configure the 'X axis / category' property in view options."});return}if(d&&(!f.id||!k.id)){this.rootEl.createDiv({cls:"prop-charts-empty",text:"Scatter plots need both X and Y numeric properties."});return}if(a&&!(L.id||M.id||T.id)){this.rootEl.createDiv({cls:"prop-charts-empty",text:"Gantt needs Start/End or Due with Duration."});return}let v=a&&E.id?E:a?f:{id:null,name:null},N;if(a)N=this.buildRowsForGantt(n,v,g,L,M,T,K,H);else if(d)N=this.buildRowsForScatter(n,f,k,g);else{let m=i;N=this.buildRowsForAggregatedCharts(n,f,k,g,w,b,m)}if(!N.length){this.rootEl.createDiv({cls:"prop-charts-empty",text:"No rows to display (check X/Y/aggregation)."});return}let c={rows:N},u=((J=e==null?void 0:e.get("title"))!=null?J:"").trim()||(e==null?void 0:e.name)||"Chart Notes (Bases)",R=e==null?void 0:e.get("drilldown"),F=typeof R=="boolean"?R:!0,G=this.buildEncoding({x:f,y:k,series:g,start:L,end:M,due:T,duration:K,group:H,label:v,aggMode:w,xBucket:b,chartType:o}),Q={type:o,source:{type:"properties",query:""},encoding:G,options:{title:u,drilldown:F}},I={refresh:()=>this.onDataUpdated()};this.renderer.render(this.rootEl,Q,c,I)}getPropFromConfig(t){var d,a;let n=this.config,e=(d=n==null?void 0:n.get)==null?void 0:d.call(n,t);if(!e)return{id:null,name:null};let o=e.trim();if(!o||o==="undefined"||o==="null")return{id:null,name:null};let i=o;try{let l=(0,Jt.parsePropertyId)(i);return{id:i,name:(a=l.name)!=null?a:i}}catch(l){return{id:i,name:i}}}readValue(t,n){if(!n.id)return null;let e;try{e=t.getValue(n.id)}catch(o){return null}if(!e)return null;try{if(typeof e.isEmpty=="function"&&e.isEmpty())return null}catch(o){}try{let o=e.toString();if(o==null)return null;let i=String(o).trim();return i.length?i:null}catch(o){return null}}parseDate(t){if(!t)return null;let n=new Date(t.trim());return Number.isNaN(n.getTime())?null:n}compareX(t,n){let e=this.parseDate(t!=null?String(t):null),o=this.parseDate(n!=null?String(n):null);if(e&&o)return e.getTime()-o.getTime();let i=Number(t),d=Number(n);return!Number.isNaN(i)&&!Number.isNaN(d)?i-d:String(t!=null?t:"").localeCompare(String(n!=null?n:""))}fmtDate(t){let n=t.getFullYear(),e=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${n}-${e}-${o}`}startOfWeek(t){let n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),e=(n.getDay()+6)%7;return n.setDate(n.getDate()-e),n.setHours(0,0,0,0),n}bucketX(t,n){let e=this.parseDate(t);if(!e)return t;switch(n){case"none":return t;case"auto":case"day":return this.fmtDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()));case"week":{let o=this.startOfWeek(e);return`${this.fmtDate(o)} (W)`}case"month":{let o=String(e.getMonth()+1).padStart(2,"0");return`${e.getFullYear()}-${o}`}case"quarter":{let o=Math.floor(e.getMonth()/3)+1;return`${e.getFullYear()}-Q${o}`}case"year":return`${e.getFullYear()}`;default:return t}}getXValuesForEntry(t,n,e,o){var S,w;let i=[],d=y=>this.bucketX(y,e);if(!n.id){let y=t.file,b=y!=null&&y.name?String(y.name):String((S=y==null?void 0:y.path)!=null?S:jt);return i.push(d(b)),i}if(!o){let y=(w=this.readValue(t,n))!=null?w:jt;return i.push(d(y)),i}let a=null;try{a=t.getValue(n.id)}catch(y){a=null}let l=y=>{if(!y)return;let b=String(y).trim();b&&i.push(d(b))};if(a==null)l(jt);else if(typeof a=="string"){let y=a.trim();if(y){let b=y.split(/\s+/);for(let f of b)l(f)}}else if(Array.isArray(a))for(let y of a){if(y==null)continue;let b;try{b=y.toString()}catch(f){continue}l(b)}else if(typeof a.toArray=="function"){let y=a.toArray();if(Array.isArray(y))for(let b of y){if(b==null)continue;let f;try{f=b.toString()}catch(E){continue}l(f)}else{let b;try{b=a.toString()}catch(f){b=""}l(b)}}else{let y;try{y=a.toString()}catch(b){y=""}l(y)}return i.length||l(jt),i}buildRowsForAggregatedCharts(t,n,e,o,i,d,a){let l=new Map,S=a||i==="count"||!e.id&&i!=="sum",w=e.name||"y";for(let b of t)for(let f of b.entries){let E=f.file,k=this.getXValuesForEntry(f,n,d,a),g=1,L=null;if(!S&&e.id){if(L=this.readValue(f,e),L==null)continue;let K=Number(L);if(Number.isNaN(K))continue;g=K}else g=1;let M=this.readValue(f,o),T=M!=null?String(M):void 0;for(let K of k){let H=`${K}@@${T!=null?T:""}`,v=l.get(H);v||(v={x:K,y:0,series:T,notes:[],props:{}},l.set(H,v)),v.y+=g,E!=null&&E.path&&v.notes.push(E.path),v.props&&n.name&&(v.props[n.name]=K),!S&&v.props&&w&&L!=null&&(v.props[w]=v.y),S&&v.props&&(v.props[w]=v.y),v.props&&o.name&&M!=null&&(v.props[o.name]=M)}}let y=Array.from(l.values());return i==="cumulative-sum"?this.toCumulative(y):y}toCumulative(t){var o,i;let n=new Map;for(let d of t){let a=(o=d.series)!=null?o:"__no_series__",l=n.get(a);l||(l=[],n.set(a,l)),l.push(d)}let e=[];for(let[,d]of n){let a=[...d].sort((S,w)=>this.compareX(S.x,w.x)),l=0;for(let S of a){let w=Number((i=S.y)!=null?i:0);Number.isNaN(w)||(l+=w,e.push({...S,y:l}))}}return e}buildRowsForScatter(t,n,e,o){let i=[];for(let d of t)for(let a of d.entries){let l=a.file,S=this.readValue(a,n),w=this.readValue(a,e);if(S==null||w==null)continue;let y=Number(S),b=Number(w);if(Number.isNaN(y)||Number.isNaN(b))continue;let f=this.readValue(a,o),E=f!=null?String(f):void 0;i.push({x:y,y:b,series:E,notes:l!=null&&l.path?[l.path]:[],props:{}})}return i}buildRowsForGantt(t,n,e,o,i,d,a,l){var k;let S=[],b=g=>{let L=[g==null?void 0:g.label,g==null?void 0:g.name,g==null?void 0:g.value,g==null?void 0:g.key,g==null?void 0:g.group,g==null?void 0:g.groupLabel];for(let M of L)if(M!=null&&String(M).trim()!=="")return String(M);return""},f=n;try{let g=this.getPropFromConfig("ganttLabelProperty");g&&g.id&&(f=g)}catch(g){}let E=!!l.id;for(let g of t){let L=b(g);for(let M of(k=g.entries)!=null?k:[]){let T=M.file,K=this.readValue(M,o),H=this.readValue(M,i),v=this.readValue(M,d),N=this.readValue(M,a),c=N!=null?Number(N):NaN,A=Number.isFinite(c)&&c>0,u=A?c*6e4:36e5,R=this.parseDate(K),F=this.parseDate(H),G=this.parseDate(v),Q=R,I=F;if(Q&&!I&&(I=new Date(Q.getTime()+u)),!Q&&I&&(Q=new Date(I.getTime()-u)),!Q&&!I&&G&&(A?(I=G,Q=new Date(G.getTime()-u)):(Q=G,I=new Date(G.getTime()+36e5))),!Q||!I)continue;if(Q.getTime()>I.getTime()){let h=Q;Q=I,I=h}let P=this.readValue(M,f);(P==null||String(P).trim()==="")&&(T!=null&&T.name?P=String(T.name).replace(/\.md$/i,""):T!=null&&T.path?P=String(T.path):P="(sem t\xEDtulo)");let z=this.readValue(M,e),J=z!=null?String(z):void 0,m={};if(L&&(m.__basesGroup=L),E){let h=this.readValue(M,l);h!=null&&l.name&&(m[l.name]=h)}f.name&&(m[f.name]=P),m.label=P,o.name&&K!=null&&(m[o.name]=K),i.name&&H!=null&&(m[i.name]=H),d.name&&v!=null&&(m[d.name]=v),A&&a.name&&(m[a.name]=c);let x=T==null?void 0:T.path;S.push({x:P,y:0,series:J,start:Q,end:I,due:G!=null?G:void 0,notes:x?[x]:[],props:m})}}return S.sort((g,L)=>!g.start||!L.start?0:g.start.getTime()-L.start.getTime()),S}buildEncoding(t){var d,a,l,S,w,y,b,f,E,k,g;let n=(d=t.x.name)!=null?d:"x",e=(a=t.y.name)!=null?a:"y",o=(w=(S=(l=t.label.name)!=null?l:t.x.name)!=null?S:t.group.name)!=null?w:"label",i=t.chartType==="gantt"?"__basesGroup":(y=t.group.name)!=null?y:"group";return{x:n,y:e,series:(b=t.series.name)!=null?b:"series",start:(f=t.start.name)!=null?f:"start",end:(E=t.end.name)!=null?E:"end",due:(k=t.due.name)!=null?k:"due",duration:(g=t.duration.name)!=null?g:"duration",group:i,label:o}}};var Re=require("obsidian"),te=class{constructor(r){this.index=new Map;this.app=r}async buildIndex(){this.index.clear();let r=this.app.vault.getMarkdownFiles();for(let t of r)await this.updateFile(t)}async fullReindex(){await this.buildIndex()}getAll(){return Array.from(this.index.values())}async updateFile(r){if(r.extension!=="md")return;let t={};try{let e=(await this.app.vault.read(r)).match(/^---\n([\s\S]*?)\n---\n?/);if(e){let i=(0,Re.parseYaml)(e[1])||{};if(i&&typeof i=="object")for(let[d,a]of Object.entries(i))d!=="position"&&(t[d]=a)}let o=this.app.metadataCache.getFileCache(r);o!=null&&o.tags&&!t.tags&&(t.tags=o.tags.map(i=>i.tag.replace(/^#/,"")))}catch(n){console.error("Chart Notes: erro ao indexar",r.path,n)}this.index.set(r.path,{path:r.path,props:t})}removeFile(r){this.index.delete(r.path)}};function Pe(s,r){if(!r||r.length===0)return!0;for(let t of r){if(t===".")return!0;let n=t.endsWith("/")?t:t+"/";if(s===t||s.startsWith(n))return!0}return!1}function Le(s,r){if(!r||r.length===0)return!0;let t=s.tags;if(!t)return!1;if(Array.isArray(t)){for(let e of r)if(t.includes(e)||t.includes("#"+e))return!0;return!1}let n=String(t);for(let e of r)if(n===e||n==="#"+e)return!0;return!1}function ne(s){return typeof s!="string"?!1:/^\d{4}-\d{2}-\d{2}/.test(s)}function Ft(s){if(s instanceof Date&&!isNaN(s.getTime()))return s;if(typeof s!="string")return null;let r=s.trim(),t=r.match(/^(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2})(?::(\d{2}))?)?/);if(t){let e=Number(t[1]),o=Number(t[2])-1,i=Number(t[3]),d=t[4]?Number(t[4]):0,a=t[5]?Number(t[5]):0,l=t[6]?Number(t[6]):0;return Number.isNaN(e)||Number.isNaN(o)||Number.isNaN(i)||Number.isNaN(d)||Number.isNaN(a)||Number.isNaN(l)?null:new Date(e,o,i,d,a,l,0)}let n=new Date(r);return isNaN(n.getTime())?null:n}function mt(s){let r=new Date(s);return r.setHours(0,0,0,0),r}function ee(s,r){let t=new Date(s);return t.setDate(t.getDate()-r),t}function nn(s,r){return ee(s,r*7)}function rn(s,r){let t=new Date(s);return t.setMonth(t.getMonth()-r),t}function me(s,r){let t=new Date(s);return t.setDate(t.getDate()+r),t}function sn(s,r){return me(s,r*7)}function on(s,r){let t=new Date(s);return t.setMonth(t.getMonth()+r),t}function ke(s){let r=s.toLowerCase();return!!(["date","scheduled","due","start","end","created","modified","datecreated","datemodified"].includes(r)||r.endsWith("date")||r.endsWith("at")||r.endsWith("on"))}function Me(s,r){let t=r?new Date(r):new Date,n=mt(t),e=s.trim().toLowerCase();if(e==="today")return n;if(e==="yesterday")return mt(ee(n,1));if(/^-\d+$/.test(e)){let o=parseInt(e.slice(1),10);return mt(ee(n,o))}if(/^-\d+d$/.test(e)){let o=parseInt(e.slice(1,-1),10);return mt(ee(n,o))}if(/^-\d+w$/.test(e)){let o=parseInt(e.slice(1,-1),10);return mt(nn(n,o))}if(/^-\d+m$/.test(e)){let o=parseInt(e.slice(1,-1),10);return mt(rn(n,o))}if(/^\+\d+$/.test(e)){let o=parseInt(e.slice(1),10);return mt(me(n,o))}if(/^\+\d+d$/.test(e)){let o=parseInt(e.slice(1,-1),10);return mt(me(n,o))}if(/^\+\d+w$/.test(e)){let o=parseInt(e.slice(1,-1),10);return mt(sn(n,o))}if(/^\+\d+m$/.test(e)){let o=parseInt(e.slice(1,-1),10);return mt(on(n,o))}return null}function Ie(s){let r=s.trim(),t=r.match(/^([a-zA-Z0-9_.-]+)\s+between\s+(.+)\s+and\s+(.+)$/i);if(t){let S=t[1].trim(),w=t[2].trim(),y=t[3].trim(),b=ke(S),f=pe(w,b),E=pe(y,b),k=f.valueType==="date"||E.valueType==="date"?"date":f.valueType;return{field:S,op:"between",value:f.value,value2:E.value,valueType:k}}let n=/(==|!=|>=|<=|>|<)/,e=r.split(n);if(e.length!==3)throw new Error("express\xE3o where inv\xE1lida: "+s);let o=e[0].trim(),i=e[1].trim(),d=e[2].trim(),a=ke(o),l=pe(d,a);return{field:o,op:i,value:l.value,valueType:l.valueType}}function pe(s,r){let t=s.trim();if(t.startsWith("'")&&t.endsWith("'")||t.startsWith('"')&&t.endsWith('"'))return{value:t.slice(1,-1),valueType:"string"};let n=t.toLowerCase(),e=n==="today"||n==="yesterday"||n.startsWith("-")||n.startsWith("+");if(r){if(t==="0"||n==="today")return{value:mt(new Date),valueType:"date"};let i=Me(t);if(i)return{value:i,valueType:"date"}}else if(e){let i=Me(t);if(i)return{value:i,valueType:"date"}}if(ne(t)){let i=Ft(t);if(i)return{value:i,valueType:"date"}}let o=Number(t);return Number.isNaN(o)?{value:t,valueType:"string"}:{value:o,valueType:"number"}}function _e(s,r){let t=s[r.field];if(t==null)return!1;if(r.valueType==="date"){let o=t instanceof Date?mt(t):ne(t)?mt(Ft(t)):null;if(!o)return!1;let i=r.value instanceof Date?r.value:null,d=r.value2 instanceof Date?r.value2:null;if(!i)return!1;let a=o.getTime(),l=mt(i).getTime();switch(r.op){case"==":return a===l;case"!=":return a!==l;case">":return a>l;case">=":return a>=l;case"<":return a<l;case"<=":return a<=l;case"between":if(!d)return!1;let S=mt(d).getTime();return a>=l&&a<=S}}if(r.valueType==="number"){let o=Number(t);if(isNaN(o))return!1;let i=Number(r.value);switch(r.op){case"==":return o===i;case"!=":return o!==i;case">":return o>i;case">=":return o>=i;case"<":return o<i;case"<=":return o<=i;case"between":return typeof r.value2!="number"?!1:o>=i&&o<=r.value2}}let n=String(t),e=String(r.value);switch(r.op){case"==":return n===e;case"!=":return n!==e;case">":return n>e;case">=":return n>=e;case"<":return n<e;case"<=":return n<=e;case"between":return!1}}function an(s){if(typeof s=="string"&&/^\d{4}-\d{2}-\d{2}/.test(s))return{key:s.slice(0,10),isDate:!0};if(ne(s)){let r=Ft(s);if(r)return{key:r,isDate:!0}}return{key:s,isDate:!1}}function ln(s,r){let t=s.x,n=r.x;if(t instanceof Date&&n instanceof Date)return t.getTime()-n.getTime();let e=String(t),o=String(n);return e<o?-1:e>o?1:0}function cn(s,r){var o,i;let t=ln(s,r);if(t!==0)return t;let n=(o=s.series)!=null?o:"",e=(i=r.series)!=null?i:"";return n<e?-1:n>e?1:0}function un(s){if(s==null)return 0;if(typeof s=="number")return s>0?Math.floor(s):0;if(typeof s=="string"){let r=s.trim().match(/^(\d+)/);if(r){let t=Number(r[1]);return Number.isFinite(t)&&t>0?Math.floor(t):0}}throw new Error(`aggregate.rolling inv\xE1lido: ${String(s)}`)}function dn(s){var n,e;let r=new Map,t=[];for(let o of s){let i=(n=o.series)!=null?n:"__no_series__",a=((e=r.get(i))!=null?e:0)+o.y;r.set(i,a),t.push({...o,y:a})}return t}function pn(s,r){var i,d;let t=un(r);if(!t||t<=1)return[...s];let n=new Map,e=new Map,o=[];for(let a of s){let l=(i=a.series)!=null?i:"__no_series__",S=n.get(l);S||(S=[],n.set(l,S));let w=(d=e.get(l))!=null?d:0;if(S.push(a.y),w+=a.y,S.length>t){let f=S.shift();w-=f}e.set(l,w);let y=S.length||1,b=w/y;o.push({...a,y:b})}return o}var re=class{constructor(r,t){this.getIndex=r,this.defaultPaths=t}run(r){var i,d,a;let t=this.getIndex(),n=(i=r.source)!=null&&i.paths&&r.source.paths.length?r.source.paths:this.defaultPaths,e=(d=r.source)!=null&&d.tags&&r.source.tags.length?r.source.tags:[],o=[];for(let l of t){let S=n&&n.length?Pe(l.path,n):!0,w=e&&e.length?Le(l.props,e):!0;if(!S||!w)continue;let y=!0;if((a=r.source)!=null&&a.where&&r.source.where.length>0)for(let b of r.source.where){let f;try{f=Ie(b)}catch(E){throw new Error(`Condi\xE7\xE3o inv\xE1lida: ${b} (${E.message})`)}if(!_e(l.props,f)){y=!1;break}}y&&o.push(l)}return r.type==="gantt"?this.runGantt(r,o):r.type==="table"?this.runTable(r,o):this.runStandard(r,o)}runTable(r,t){var e,o;return{rows:t.map(i=>({x:i.path,y:0,notes:[i.path],props:i.props})),xField:(e=r.encoding)==null?void 0:e.x,yField:(o=r.encoding)==null?void 0:o.y}}runGantt(r,t){var w,y,b;let n=(w=r.encoding)!=null?w:{},e=n.start,o=n.end,i=(y=n.label)!=null?y:n.x,d=n.series,a=n.duration,l=n.due,S=[];for(let f of t){let E=(b=f.props)!=null?b:{},k=v=>Array.isArray(v)?v[0]:v,g=null;if(o){let v=k(E[o]),N=Ft(v);N&&(g=N)}if(!g)continue;let L=null;if(e){let v=k(E[e]),N=Ft(v);N&&(L=N)}if(!L&&a){let v=k(E[a]),N=Number(v);Number.isNaN(N)||(L=new Date(g.getTime()-N*6e4))}L||(L=new Date(g.getTime()));let M;if(l){let v=k(E[l]),N=Ft(v);N&&(M=N)}let T;if(i){let v=k(E[i]);(v==null||v==="")&&(v=f.path),T=v}else T=f.path;let K;if(d){let v=k(E[d]);v!=null&&(K=String(v))}let H={x:T,y:0,notes:[f.path],series:K,start:L,end:g,props:E};M&&(H.due=M),S.push(H)}return S.sort((f,E)=>{let k=f.start?f.start.getTime():0,g=E.start?E.start.getTime():0;return k-g}),{rows:S,xField:i,yField:o}}runStandard(r,t){var f,E,k,g,L,M,T,K,H,v;let n=(f=r.encoding)==null?void 0:f.x,e=(E=r.encoding)==null?void 0:E.y,o=(k=r.encoding)==null?void 0:k.series;if(!n)throw new Error("encoding.x \xE9 obrigat\xF3rio.");let i=(g=r.aggregate)!=null?g:{},d=(L=i.y)!=null?L:null,a=!!i.cumulative,l=i.rolling;if(!e&&d!=="count")throw new Error("encoding.y \xE9 obrigat\xF3rio (exceto quando aggregate.y = 'count').");let S=[];for(let N of t){let c=(M=N.props)!=null?M:{},A=P=>Array.isArray(P)?P[0]:P,u=A(c[n]);if(u==null)continue;let R=an(u),F=R.key,G=R.isDate,Q;if(o){let P=A(c[o]);P!=null&&String(P).trim()!==""&&(Q=String(P))}let I;if(d==="count")I=1;else{let P=A(c[e]);if(P==null)continue;let z=Number(P);if(Number.isNaN(z))continue;I=z}S.push({x:F,y:I,notes:[N.path],series:Q,props:c,_isDate:G,_origX:u})}if(S.length===0)return{rows:[],xField:n,yField:e};let w=[];if(d){let N=new Map;for(let c of S){let A=(T=c.series)!=null?T:"",u=c.x instanceof Date?c.x.toISOString().slice(0,10):String(c.x),R=A+"||"+u,F=(K=N.get(R))!=null?K:{sum:0,count:0,min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY,notes:[],xRep:c.x,isDate:c._isDate,series:c.series,props:c.props};F.sum+=c.y,F.count+=1,c.y<F.min&&(F.min=c.y),c.y>F.max&&(F.max=c.y),F.notes.push(...c.notes),F.props=(H=c.props)!=null?H:F.props,N.set(R,F)}for(let[,c]of N){let A=c.sum;switch(d){case"sum":A=c.sum;break;case"avg":A=c.sum/c.count;break;case"min":A=c.min;break;case"max":A=c.max;break;case"count":A=c.count;break}w.push({x:c.xRep,y:A,notes:c.notes,series:c.series,props:c.props})}}else w=S.map(N=>({x:N.x,y:N.y,notes:N.notes,series:N.series,props:N.props}));if(w.length===0)return{rows:[],xField:n,yField:e};let y=((v=r.sort)==null?void 0:v.x)==="desc"?"desc":"asc";if(w.sort((N,c)=>{let A=cn(N,c);return y==="asc"?A:-A}),(a||l)&&!(r.type==="line"||r.type==="area"))throw new Error("aggregate.cumulative / aggregate.rolling s\xF3 s\xE3o suportados em type: 'line' ou 'area'.");if(a&&l)throw new Error("Ainda n\xE3o \xE9 poss\xEDvel usar 'cumulative' e 'rolling' juntos no mesmo gr\xE1fico.");let b=w;return l?b=pn(w,l):a&&(b=dn(w)),{rows:b,xField:n,yField:e}}};var Nt=require("obsidian");var Fe=["#5b6cff","#5ec27f","#ffb347","#ff6b6b","#b47cff","#4dbbd5","#f78fb3","#50e3a4"];function ut(s,r){if(!s)return"var(--text-accent, #5b6cff)";let t=Array.from(s).reduce((n,e)=>n*33+e.charCodeAt(0)>>>0,0);return Fe[t%Fe.length]}function vt(s,r){s.addClass("prop-charts-container"),s.style.width="100%",s.style.maxWidth="100%",s.style.position="relative";let t=s.createDiv({cls:"chart-notes-scroll"});t.style.overflowX="auto",t.style.overflowY="hidden",t.style.width="100%",t.style.maxWidth="100%";let n=t.createDiv({cls:"chart-notes-inner"});n.style.display="block",n.style.minHeight=`${300}px`,r&&(n.style.background=r);let e="http://www.w3.org/2000/svg",o=document.createElementNS(e,"svg");o.setAttribute("width","100%"),o.setAttribute("height",String(300)),o.style.display="block",n.appendChild(o);let i=s.createDiv({cls:"chart-notes-tooltip"});i.style.display="none";let d=s.createDiv({cls:"chart-notes-details"});return d.style.display="none",{scroll:t,inner:n,svg:o,tooltip:i,details:d}}function gt(s,r,t,n,e,o){let i=s.getBoundingClientRect(),d=typeof n=="number"?Number.isInteger(n)?String(n):n.toFixed(2):String(n);r.innerHTML=`
    <div class="chart-notes-tooltip-title">${t}</div>
    <div class="chart-notes-tooltip-value">${d}</div>
    <div class="chart-notes-tooltip-notes">${e} nota${e===1?"":"s"}</div>
  `,r.style.display="block";let a=r.getBoundingClientRect(),l=o.clientX-i.left+6,S=o.clientY-i.top+6;l+a.width>i.width-4&&(l=i.width-a.width-4),l<4&&(l=4),S+a.height>i.height-4&&(S=i.height-a.height-4),S<4&&(S=4),r.style.left=l+"px",r.style.top=S+"px"}function yt(s){s.style.display="none"}function bt(s,r,t,n,e,o){if(!o)return;if(r.empty(),!e||e.length===0){r.style.display="none";return}r.style.display="block";let i=r.createEl("div",{cls:"chart-notes-details-header"}),d=i.createEl("div",{cls:"chart-notes-details-title"});d.textContent=`Notas em "${t}" (${e.length})`+(Number.isFinite(n)&&n!==0?` \u2013 valor ${Number.isInteger(n)?n:n.toFixed(2)}`:"");let a=i.createEl("button",{cls:"chart-notes-details-close"});a.textContent="\xD7",a.addEventListener("click",()=>{r.style.display="none"});let l=r.createEl("ul",{cls:"chart-notes-details-list"});for(let S of e){let y=l.createEl("li",{cls:"chart-notes-details-item"}).createEl("a",{cls:"chart-notes-details-link",text:S});y.href="#",y.addEventListener("click",b=>{b.preventDefault(),app.workspace.openLinkText(S,"",!1)})}}function Mt(s){if(!(s instanceof Date)||isNaN(s.getTime()))return"";let r=s.getUTCDate().toString().padStart(2,"0"),t=(s.getUTCMonth()+1).toString().padStart(2,"0");return`${r}/${t}`}function $e(s){if(!s)return!1;let r=s.trim().toLowerCase();if(r==="#fff"||r==="#ffffff"||r==="white")return!0;if(!r.startsWith("#"))return!1;let t,n,e;if(r.length===4)t=parseInt(r[1]+r[1],16),n=parseInt(r[2]+r[2],16),e=parseInt(r[3]+r[3],16);else if(r.length===7)t=parseInt(r.slice(1,3),16),n=parseInt(r.slice(3,5),16),e=parseInt(r.slice(5,7),16);else return!1;return(.2126*t+.7152*n+.0722*e)/255>.7}var he=class extends Nt.Modal{constructor(t,n,e,o){var d;super(app);this.notePath=t,this.spec=n,this.refresh=e,this.reindexFile=o;let i=(d=n.encoding)!=null?d:{};this.startKey=i.start,this.endKey=i.end,this.durationKey=i.duration,this.dueKey=i.due}async onOpen(){var v,N;let{contentEl:t}=this;t.empty(),this.titleEl.setText("Editar tarefa");let n=this.app.vault.getAbstractFileByPath(this.notePath);if(!(n instanceof Nt.TFile)){t.createEl("p",{text:"Arquivo n\xE3o encontrado: "+this.notePath});return}this.titleEl.setText(`Editar tarefa \u2013 ${n.basename}`);let e=await this.app.vault.read(n),o={},i=e,d=e.match(/^---\n([\s\S]*?)\n---\n?([\s\S]*)$/);if(d){try{o=(v=(0,Nt.parseYaml)(d[1]))!=null?v:{}}catch(c){o={}}i=(N=d[2])!=null?N:""}let a=t.createDiv({cls:"gantt-edit-form"}),l=c=>{let A=a.createDiv({cls:"gantt-edit-row"}),u=A.createDiv({cls:"gantt-edit-label"});u.textContent=c;let R=A.createDiv({cls:"gantt-edit-field"});return{row:A,field:R}},S=c=>{if(!c)return null;if(c instanceof Date&&!isNaN(c.getTime()))return c;let u=String(c).trim().match(/^(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2})(?::(\d{2}))?)?/);if(!u)return null;let R=Number(u[1]),F=Number(u[2])-1,G=Number(u[3]),Q=u[4]?Number(u[4]):0,I=u[5]?Number(u[5]):0,P=u[6]?Number(u[6]):0;return Number.isNaN(R)||Number.isNaN(F)||Number.isNaN(G)||Number.isNaN(Q)||Number.isNaN(I)||Number.isNaN(P)?null:new Date(R,F,G,Q,I,P,0)},w=c=>{let A=S(c);if(!A)return"";let u=P=>P.toString().padStart(2,"0"),R=A.getFullYear(),F=u(A.getMonth()+1),G=u(A.getDate()),Q=u(A.getHours()),I=u(A.getMinutes());return`${R}-${F}-${G}T${Q}:${I}`},y=c=>{if(c=c.trim(),!c)return;let A=c.match(/^(\d{4})-(\d{2})-(\d{2})(?:T(\d{2}):(\d{2}))?$/);if(!A)return;let u=`${A[1]}-${A[2]}-${A[3]}`;if(A[4]){let R=A[4],F=A[5];return`${u}T${R}:${F}`}return u},b=null,f=null,E=null,k=null;if(this.startKey){let{field:c}=l(`In\xEDcio (${this.startKey})`);b=c.createEl("input"),b.type="datetime-local",b.value=w(o[this.startKey])}if(this.endKey){let{field:c}=l(`Fim (${this.endKey})`);f=c.createEl("input"),f.type="datetime-local",f.value=w(o[this.endKey])}if(this.durationKey){let{field:c}=l(`Dura\xE7\xE3o (min) (${this.durationKey})`);E=c.createEl("input"),E.type="number";let A=o[this.durationKey];E.value=typeof A=="number"&&!Number.isNaN(A)?String(A):""}if(this.dueKey){let{field:c}=l(`Due (${this.dueKey})`);k=c.createEl("input"),k.type="datetime-local",k.value=w(o[this.dueKey])}let g=a.createDiv({cls:"gantt-edit-actions-row"});g.style.marginTop="0.75rem",g.style.display="flex",g.style.justifyContent="space-between",g.style.alignItems="center";let L=g.createDiv({cls:"gantt-edit-actions-left"});L.style.display="flex";let M=g.createDiv({cls:"gantt-edit-actions-right"});M.style.display="flex",M.style.gap="0.5rem";let T=L.createEl("button",{text:"Abrir nota"}),K=M.createEl("button",{text:"Salvar"}),H=M.createEl("button",{text:"Cancelar"});T.addEventListener("click",()=>{this.app.workspace.openLinkText(this.notePath,"",!1),this.close()}),H.addEventListener("click",()=>this.close()),K.addEventListener("click",async()=>{if(this.startKey&&b){let u=y(b.value);u?o[this.startKey]=u:delete o[this.startKey]}if(this.endKey&&f){let u=y(f.value);u?o[this.endKey]=u:delete o[this.endKey]}if(this.durationKey&&E){let u=E.value.trim();if(u==="")delete o[this.durationKey];else{let R=Number(u);Number.isNaN(R)||(o[this.durationKey]=R)}}if(this.dueKey&&k){let u=y(k.value);u?o[this.dueKey]=u:delete o[this.dueKey]}let A=`---
${(0,Nt.stringifyYaml)(o).trim()}
---
`+i;if(await this.app.vault.modify(n,A),this.reindexFile)try{await this.reindexFile(this.notePath)}catch(u){}if(this.refresh)try{this.refresh()}catch(u){}new Nt.Notice("Task atualizada"),this.close()})}onClose(){this.contentEl.empty()}};function se(s,r,t,n){var be,Se,xe,Ae,ve,we,De,Ne;let e=(be=r.options)!=null?be:{},o=e.background,i=(Se=e.drilldown)!=null?Se:!0,d=!0,a=p=>{if(p==null)return"";let $=String(p).trim();if(!$)return"";let U=$.match(/^\[\[(.+?)\]\]$/);U&&($=U[1]);let tt=$.lastIndexOf("/");return tt>=0&&tt<$.length-1&&($=$.slice(tt+1)),$};if(Array.from(s.querySelectorAll(".gantt-zoom-controls, .gantt-label-floating-btn, .chart-notes-scroll, .chart-notes-details, .chart-notes-tooltip, .prop-charts-empty")).forEach(p=>p.remove()),t.rows.length===0){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let l=t.rows.filter(p=>p.start&&p.end);if(l.length===0){s.createDiv({cls:"prop-charts-empty",text:"Gantt: faltam campos de data."});return}let S=r.encoding,w=S.group,y=S.duration,b=(p,$)=>{if(!p||!$)return;let U=p[$];return Array.isArray(U)?U[0]:U},f="__chartnotes_no_group__",k=l.map(p=>{var pt,xt;let $=p.start,U=p.end,tt=p.props,_t=typeof p.x=="string"?p.x:p.x instanceof Date?Mt($):String(p.x),Et=a(_t),wt=w!=null&&w!==""?b(tt,w):void 0,Tt=wt!=null&&String(wt).trim().length>0?String(wt):f,ft=(pt=p.notes)==null?void 0:pt[0],Ct=ft?(xt=ft.replace(/\.md$/i,"").split("/").pop())!=null?xt:ft:Et,Gt=p.due,Lt,St=b(tt,y);if(St!=null){let Rt=Number(St);Number.isNaN(Rt)||(Lt=Rt)}return{row:p,start:$,end:U,props:tt,fullName:Et,groupKey:Tt,notePath:ft,noteTitle:Ct,due:Gt,estMinutes:Lt}}).filter(p=>p.start instanceof Date&&!isNaN(p.start.getTime())&&p.end instanceof Date&&!isNaN(p.end.getTime()));if(k.length===0){s.createDiv({cls:"prop-charts-empty",text:"Gantt: datas inv\xE1lidas."});return}k.sort((p,$)=>{if(p.groupKey<$.groupKey)return-1;if(p.groupKey>$.groupKey)return 1;let U=p.start.getTime(),tt=$.start.getTime();return U!==tt?U-tt:p.fullName.localeCompare($.fullName)});let g=26,L=0,M=null;for(let p of k)p.groupKey!==M&&(M=p.groupKey,p.groupKey!==f&&(L+=1)),L+=1;let T=Math.min(...k.map(p=>p.start.getTime())),K=Math.max(...k.map(p=>p.end.getTime()));if(!isFinite(T)||!isFinite(K)){s.createDiv({cls:"prop-charts-empty",text:"Gantt: intervalo de datas inv\xE1lido."});return}let H=24*60*60*1e3,v=p=>{let $=new Date(p);return $.setHours(0,0,0,0),$.getTime()},N=v(T),c=v(K),A=s.querySelector(".prop-charts-title-row");A||(A=s.createDiv({cls:"prop-charts-title-row"}));let u=s.dataset.ganttZoomMode||String((xe=e.zoomMode)!=null?xe:"100");s.dataset.ganttZoomMode=u;let R=s.dataset.ganttLabelMode||String((Ae=e.labelMode)!=null?Ae:"compact");s.dataset.ganttLabelMode=R;let F=A.createDiv({cls:"gantt-zoom-controls"});[{id:"fit",label:"Fit"},{id:"100",label:"100%"},{id:"150",label:"150%"},{id:"200",label:"200%"}].forEach(p=>{let $=F.createEl("button",{cls:"gantt-zoom-btn",text:p.label});p.id===u&&$.addClass("is-active"),$.addEventListener("click",U=>{U.preventDefault(),s.dataset.ganttZoomMode=p.id,se(s,r,t,n)})});let Q=Number(e.labelWidth),I=!Number.isNaN(Q)&&Q>120?Q:260,P=R==="wide"?I+160:I,z=s.getBoundingClientRect().width||600,J=Math.max(z,820),m;if(u==="fit")m=z;else{let p=Number(u)/100||1;m=J*p}let{inner:x,svg:h,tooltip:D,details:C}=vt(s,o);x.style.width=m+"px";let _=(p,$,U,tt,_t,Et,wt,Ut,Tt)=>{if(!p)return;let ft=Math.max(40,tt-8),Gt=Math.max(8,Math.floor(ft/6)),Lt=p.split(/\s+/),St=[],pt="";for(let kt of Lt){if(!pt){pt=kt;continue}(pt+" "+kt).length<=Gt?pt+=" "+kt:(St.push(pt),pt=kt)}pt&&St.push(pt);let xt=_t+2,Rt=St.length*xt,Kt=U-Rt/2+_t;St.forEach((kt,zt)=>{let ct=document.createElementNS(h.namespaceURI,"text");ct.setAttribute("x",String($)),ct.setAttribute("y",String(Kt+zt*xt)),ct.setAttribute("text-anchor","start"),ct.setAttribute("font-size",String(_t)),ct.setAttribute("fill","#111111"),Et&&ct.setAttribute("font-weight",Et),ct.textContent=kt,wt&&ct.addEventListener("mouseenter",lt=>wt(lt)),Ut&&ct.addEventListener("mouseleave",()=>Ut()),Tt&&(ct.style.cursor="pointer",ct.addEventListener("click",lt=>Tt(lt))),h.appendChild(ct)})},B=28,nt=28,j=10,Y=Math.max(300,B+nt+L*g+24);h.setAttribute("height",String(Y));let rt=m-P-j,O=B+6;h.style.color="#111111";let dt=c+H-N||1,st=N-dt*.02,it=c+H+dt*.08,at=p=>P+(p-st)/(it-st)*rt,W=(it-st)/H,et=Math.max(4,Math.min(12,Math.floor(rt/90)||4)),Z=W/et,X=[1,2,3,5,7,10,14,21,30,60,90,180,365],ht=X[X.length-1];for(let p of X)if(p>=Z){ht=p;break}let Vt=[],Qe=v(st);for(let p=Qe;p<=it+.5*H;p+=ht*H)Vt.push(p);let $t=document.createElementNS(h.namespaceURI,"line");$t.setAttribute("x1",String(P)),$t.setAttribute("y1",String(O)),$t.setAttribute("x2",String(m-j)),$t.setAttribute("y2",String(O)),$t.setAttribute("stroke","#111111"),h.appendChild($t);for(let p of Vt){let $=at(p),U=document.createElementNS(h.namespaceURI,"line");U.setAttribute("x1",String($)),U.setAttribute("y1",String(O)),U.setAttribute("x2",String($)),U.setAttribute("y2",String(Y-nt)),U.setAttribute("stroke","#111111"),U.setAttribute("stroke-opacity","0.20"),U.setAttribute("stroke-dasharray","2,4"),h.appendChild(U);let tt=document.createElementNS(h.namespaceURI,"text");tt.setAttribute("x",String($)),tt.setAttribute("y",String(O-4)),tt.setAttribute("text-anchor","middle"),tt.setAttribute("font-size","10"),tt.setAttribute("fill","#111111"),tt.textContent=Mt(new Date(p)),h.appendChild(tt)}let ye=new Date;ye.setHours(0,0,0,0);let le=ye.getTime();if(le>=st&&le<=it){let p=at(le),$=document.createElementNS(h.namespaceURI,"line");$.setAttribute("x1",String(p)),$.setAttribute("y1",String(O)),$.setAttribute("x2",String(p)),$.setAttribute("y2",String(Y-nt)),$.setAttribute("stroke","#4caf50"),$.setAttribute("stroke-width","2"),$.setAttribute("stroke-dasharray","4,2"),h.appendChild($);let U=document.createElementNS(h.namespaceURI,"text");U.setAttribute("x",String(p+4)),U.setAttribute("y",String(O+12)),U.setAttribute("font-size","10"),U.setAttribute("fill","#4caf50"),U.textContent="hoje",h.appendChild(U)}let Ot=x.createEl("button",{cls:"gantt-label-floating-btn",text:"\u2194"});Ot.setAttr("title",R==="wide"?"Compactar nomes":"Expandir nomes"),Ot.style.left=`${P}px`,Ot.style.top="4px",Ot.addEventListener("click",p=>{p.preventDefault();let U=(s.dataset.ganttLabelMode||"compact")==="wide"?"compact":"wide";s.dataset.ganttLabelMode=U,se(s,r,t,n)});let Ve=["status","priority"],ce=Array.isArray(e.tooltipFields)?e.tooltipFields.map(p=>String(p)):null,Ue=ce&&ce.length?ce:Ve,Ht=0,Xt=null;for(let p of k){let $=p.start,U=p.end,tt=(U.getTime()-$.getTime())/6e4,_t=p.props,Et=p.notePath,wt=p.noteTitle,Ut=(we=(ve=p.row.notes)==null?void 0:ve.length)!=null?we:0,Tt=p.due,ft=p.estMinutes,Ct=[];Ct.push(`${Mt($)} \u2192 ${Mt(U)}`),typeof ft=="number"&&!Number.isNaN(ft)?Ct.push(`est: ${Math.round(ft)} min`):tt>0&&Ct.push(`dura\xE7\xE3o: ${Math.round(tt)} min`),Tt instanceof Date&&Ct.push(`due: ${Mt(Tt)}`);for(let ot of Ue){let q=b(_t,ot);q!=null&&String(q).trim()!==""&&Ct.push(`${ot}: ${String(q)}`)}let Gt=Ct.join("<br>"),Lt=ot=>{var q;ot.preventDefault(),d&&Et?new he(Et,r,n==null?void 0:n.refresh,n==null?void 0:n.reindexFile).open():bt(s,C,wt,ft!=null?ft:tt,(q=p.row.notes)!=null?q:[],i)},St=ot=>{wt&&Gt&&gt(s,D,wt,Gt,Ut,ot)},pt=()=>yt(D);if(p.groupKey!==Xt&&(Xt=p.groupKey,Xt!==f)){let ot=O+8+Ht*g+g/2,q=a(Xt);_(q,4,ot,P-12,11,"600"),Ht+=1}let xt=O+8+Ht*g,Rt=g-10,Kt=at($.getTime()),kt=at(U.getTime()),zt=Math.max(4,kt-Kt),ct=p.fullName,lt=document.createElementNS(h.namespaceURI,"rect");lt.setAttribute("x",String(Kt)),lt.setAttribute("y",String(xt)),lt.setAttribute("width",String(zt)),lt.setAttribute("height",String(Rt)),lt.setAttribute("rx","3"),lt.setAttribute("ry","3"),lt.setAttribute("fill",ut((De=p.row.series)!=null?De:ct,Ht)),lt.setAttribute("stroke","rgba(0,0,0,0.25)"),lt.setAttribute("stroke-width","0.5"),lt.style.cursor=d&&Et?"pointer":"default",lt.addEventListener("mouseenter",St),lt.addEventListener("mouseleave",pt),lt.addEventListener("click",Lt),h.appendChild(lt);let Ee=xt+Rt/2;if(zt>=6){let ot=ut((Ne=p.row.series)!=null?Ne:ct,Ht),q=document.createElementNS(h.namespaceURI,"circle");q.setAttribute("cx",String(Kt)),q.setAttribute("cy",String(Ee)),q.setAttribute("r","3.5"),q.setAttribute("fill","#ffffff"),q.setAttribute("stroke",ot),q.setAttribute("stroke-width","1.5"),h.appendChild(q);let It=document.createElementNS(h.namespaceURI,"circle");It.setAttribute("cx",String(kt)),It.setAttribute("cy",String(Ee)),It.setAttribute("r","3.5"),It.setAttribute("fill","#ffffff"),It.setAttribute("stroke",ot),It.setAttribute("stroke-width","1.5"),h.appendChild(It)}let Te=xt+Rt/2+2,qt=4;if(R==="wide")_(ct,qt,Te,P-qt-4,11,null,St,pt,Lt);else{let ot=ct,q=Math.max(40,P-qt-8),Ce=Math.max(8,Math.floor(q/6));ot.length>Ce&&(ot=ot.slice(0,Ce-1)+"\u2026");let At=document.createElementNS(h.namespaceURI,"text");At.setAttribute("x",String(qt)),At.setAttribute("y",String(Te)),At.setAttribute("text-anchor","start"),At.setAttribute("font-size","11"),At.setAttribute("fill","#111111"),At.textContent=ot,At.style.cursor="pointer",At.addEventListener("mouseenter",St),At.addEventListener("mouseleave",pt),At.addEventListener("click",Lt),h.appendChild(At)}if(Tt instanceof Date){let ot=at(Tt.getTime()),q=document.createElementNS(h.namespaceURI,"line");q.setAttribute("x1",String(ot)),q.setAttribute("y1",String(xt)),q.setAttribute("x2",String(ot)),q.setAttribute("y2",String(xt+Rt)),q.setAttribute("stroke","#ff6b6b"),q.setAttribute("stroke-width","2"),q.setAttribute("stroke-dasharray","4,2"),h.appendChild(q)}Ht+=1}if(d){let p=s.createDiv({cls:"prop-charts-empty"});p.textContent="Clique em uma barra ou no nome para ajustar datas e estimate da tarefa."}}function fe(s,r,t){var P,z,J,m;let n=(P=r.options)!=null?P:{},e=n.background,o=(z=n.drilldown)!=null?z:!0,i=(J=t.rows)!=null?J:[];if(!i.length){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let{inner:d,svg:a,tooltip:l,details:S}=vt(s,e),w=s.getBoundingClientRect().width||600,y=Math.max(w,480);d.style.width=y+"px";let b=40,f=16,E=18,k=28,g=300;a.setAttribute("height",String(g));let L=y-b-f,M=g-E-k,T=new Map;for(let x of i){let h=String(x.x),D=(m=T.get(h))!=null?m:{label:x.x,rows:[]};D.rows.push(x),T.set(h,D)}let H=Array.from(T.keys()).sort((x,h)=>x<h?-1:x>h?1:0).map(x=>T.get(x)),v=H.length,N=new Set;i.forEach(x=>{x.series!=null&&N.add(String(x.series))});let c=Array.from(N),A=c.length>1,u=A?"grouped":"single",R=0;i.forEach(x=>{x.y>R&&(R=x.y)}),(!isFinite(R)||R<=0)&&(R=1);let F=x=>E+M-x/(R||1)*M,G=F(0),Q=4;for(let x=0;x<=Q;x++){let h=R*x/Q,D=F(h),C=document.createElementNS(a.namespaceURI,"line");C.setAttribute("x1",String(b)),C.setAttribute("y1",String(D)),C.setAttribute("x2",String(y-f)),C.setAttribute("y2",String(D)),C.setAttribute("stroke","#cccccc"),C.setAttribute("stroke-opacity","0.25"),a.appendChild(C);let _=document.createElementNS(a.namespaceURI,"text");_.setAttribute("x",String(b-4)),_.setAttribute("y",String(D+3)),_.setAttribute("text-anchor","end"),_.setAttribute("font-size","10"),_.setAttribute("fill","#111111"),_.textContent=String(Math.round(h)),a.appendChild(_)}let I=v>0?L/v:L;if(H.forEach((x,h)=>{let D=b+I*(h+.5),C=String(x.label),_=document.createElementNS(a.namespaceURI,"text");_.setAttribute("x",String(D)),_.setAttribute("y",String(g-k+12)),_.setAttribute("text-anchor","middle"),_.setAttribute("font-size","10"),_.setAttribute("fill","#111111"),_.textContent=C,a.appendChild(_)}),A){let x=s.createDiv({cls:"chart-notes-legend"});c.forEach((h,D)=>{let C=x.createDiv({cls:"chart-notes-legend-item"}),_=C.createDiv();_.style.width="10px",_.style.height="10px",_.style.borderRadius="999px",_.style.backgroundColor=ut(h,D),C.createSpan({text:h})})}H.forEach((x,h)=>{let D=b+I*(h+.5),C=x.rows;if(u==="single"){let Y=C[0],rt=Y.y,O=I*.6,dt=D-O/2,st=F(rt),it=Math.max(2,G-st),at=ut("bar",h),W=document.createElementNS(a.namespaceURI,"rect");W.setAttribute("x",String(dt)),W.setAttribute("y",String(st)),W.setAttribute("width",String(O)),W.setAttribute("height",String(it)),W.setAttribute("fill",at),W.setAttribute("stroke","rgba(0,0,0,0.25)"),W.setAttribute("stroke-width","0.5"),W.style.cursor="pointer";let V=String(x.label),et=`valor: ${Math.round(rt*100)/100}`;W.addEventListener("mouseenter",Z=>{var X,ht;return gt(s,l,V,et,(ht=(X=Y.notes)==null?void 0:X.length)!=null?ht:0,Z)}),W.addEventListener("mouseleave",()=>yt(l)),W.addEventListener("click",Z=>{var X;Z.preventDefault(),bt(s,S,V,rt,(X=Y.notes)!=null?X:[],o)}),a.appendChild(W);return}let _=c.length,B=I/Math.max(_+1,2),nt=_*B,j=D-nt/2;c.forEach((Y,rt)=>{let O=C.find(X=>(X.series!=null?String(X.series):"")===Y);if(!O)return;let dt=O.y,st=j+rt*B,it=F(dt),at=Math.max(2,G-it),W=ut(Y,rt),V=document.createElementNS(a.namespaceURI,"rect");V.setAttribute("x",String(st)),V.setAttribute("y",String(it)),V.setAttribute("width",String(B)),V.setAttribute("height",String(at)),V.setAttribute("fill",W),V.setAttribute("stroke","rgba(0,0,0,0.25)"),V.setAttribute("stroke-width","0.5"),V.style.cursor="pointer";let et=`${Y} @ ${String(x.label)}`,Z=`valor: ${Math.round(dt*100)/100}`;V.addEventListener("mouseenter",X=>{var ht,Vt;return gt(s,l,et,Z,(Vt=(ht=O.notes)==null?void 0:ht.length)!=null?Vt:0,X)}),V.addEventListener("mouseleave",()=>yt(l)),V.addEventListener("click",X=>{var ht;X.preventDefault(),bt(s,S,et,dt,(ht=O.notes)!=null?ht:[],o)}),a.appendChild(V)})})}function He(s,r,t){var I,P,z,J;let n=(I=r.options)!=null?I:{},e=n.background,o=(P=n.drilldown)!=null?P:!0,i=(z=t.rows)!=null?z:[];if(!i.length){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let{inner:d,svg:a,tooltip:l,details:S}=vt(s,e),w=s.getBoundingClientRect().width||600,y=Math.max(w,480);d.style.width=y+"px";let b=40,f=16,E=18,k=28,g=300;a.setAttribute("height",String(g));let L=y-b-f,M=g-E-k,T=new Map;for(let m of i){let x=String(m.x),h=(J=T.get(x))!=null?J:{label:m.x,rows:[]};h.rows.push(m),T.set(x,h)}let H=Array.from(T.keys()).sort((m,x)=>m<x?-1:m>x?1:0).map(m=>T.get(m)),v=H.length,N=new Set;i.forEach(m=>{m.series!=null&&N.add(String(m.series))});let c=Array.from(N);if(!c.length){fe(s,r,t);return}let A=0;H.forEach(m=>{let x=m.rows.reduce((h,D)=>h+D.y,0);x>A&&(A=x)}),(!isFinite(A)||A<=0)&&(A=1);let u=m=>E+M-m/(A||1)*M,R=u(0),F=4;for(let m=0;m<=F;m++){let x=A*m/F,h=u(x),D=document.createElementNS(a.namespaceURI,"line");D.setAttribute("x1",String(b)),D.setAttribute("y1",String(h)),D.setAttribute("x2",String(y-f)),D.setAttribute("y2",String(h)),D.setAttribute("stroke","#cccccc"),D.setAttribute("stroke-opacity","0.25"),a.appendChild(D);let C=document.createElementNS(a.namespaceURI,"text");C.setAttribute("x",String(b-4)),C.setAttribute("y",String(h+3)),C.setAttribute("text-anchor","end"),C.setAttribute("font-size","10"),C.setAttribute("fill","#111111"),C.textContent=String(Math.round(x)),a.appendChild(C)}let G=v>0?L/v:L;H.forEach((m,x)=>{let h=b+G*(x+.5),D=String(m.label),C=document.createElementNS(a.namespaceURI,"text");C.setAttribute("x",String(h)),C.setAttribute("y",String(g-k+12)),C.setAttribute("text-anchor","middle"),C.setAttribute("font-size","10"),C.setAttribute("fill","#111111"),C.textContent=D,a.appendChild(C)});let Q=s.createDiv({cls:"chart-notes-legend"});c.forEach((m,x)=>{let h=Q.createDiv({cls:"chart-notes-legend-item"}),D=h.createDiv();D.style.width="10px",D.style.height="10px",D.style.borderRadius="999px",D.style.backgroundColor=ut(m,x),h.createSpan({text:m})}),H.forEach((m,x)=>{let h=b+G*(x+.5),D=G*.6,C=h-D/2,_=0;c.forEach((B,nt)=>{let j=m.rows.find(Z=>(Z.series!=null?String(Z.series):"")===B);if(!j)return;let Y=j.y,rt=_,O=_+Y;_=O;let dt=u(rt),st=u(O),it=Math.max(2,dt-st),at=ut(B,nt),W=document.createElementNS(a.namespaceURI,"rect");W.setAttribute("x",String(C)),W.setAttribute("y",String(st)),W.setAttribute("width",String(D)),W.setAttribute("height",String(it)),W.setAttribute("fill",at),W.setAttribute("stroke","rgba(0,0,0,0.25)"),W.setAttribute("stroke-width","0.5"),W.style.cursor="pointer";let V=`${B} @ ${String(m.label)}`,et=`valor: ${Math.round(Y*100)/100}`;W.addEventListener("mouseenter",Z=>{var X,ht;return gt(s,l,V,et,(ht=(X=j.notes)==null?void 0:X.length)!=null?ht:0,Z)}),W.addEventListener("mouseleave",()=>yt(l)),W.addEventListener("click",Z=>{var X;Z.preventDefault(),bt(s,S,V,Y,(X=j.notes)!=null?X:[],o)}),a.appendChild(W)})})}function Yt(s){if(!s)return null;if(s instanceof Date){let r=s.getTime();return Number.isNaN(r)?null:s}if(typeof s=="string"){let r=s.trim();if(!r||/^\d+$/.test(r))return null;let t=new Date(r);if(!Number.isNaN(t.getTime()))return t}return null}function ge(s,r,t,n){var I,P,z,J;let e=(I=r.options)!=null?I:{},o=e.background,i=(P=e.drilldown)!=null?P:!0,d=(z=t.rows)!=null?z:[];if(!d.length){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let{inner:a,svg:l,tooltip:S,details:w}=vt(s,o),y=s.getBoundingClientRect().width||600,b=Math.max(y,480);a.style.width=b+"px";let f=40,E=16,k=18,g=28,L=300;l.setAttribute("height",String(L));let M=b-f-E,T=L-k-g,K=d.map(m=>Yt(m.x)).filter(m=>!!m),H=K.length>=2&&K.length>=d.length*.6,v=new Map;for(let m of d){let x=m.series!=null&&m.series!==""?String(m.series):"__default__",h=(J=v.get(x))!=null?J:[];h.push(m),v.set(x,h)}let N=Array.from(v.keys()),c,A;if(H){let x=K.map(V=>V.getTime()).sort((V,et)=>V-et),h=x[0],D=x[x.length-1];h===D&&(h-=864e5,D+=864e5);let C=D-h||864e5,_=h-C*.02,B=D+C*.02;c=V=>{let et=Yt(V);if(!et)return f;let Z=et.getTime();return f+(Z-_)/(B-_||1)*M},A=V=>{let et=Yt(V);return et?Mt(et):String(V)};let nt=k+T,j=document.createElementNS(l.namespaceURI,"line");j.setAttribute("x1",String(f)),j.setAttribute("y1",String(nt)),j.setAttribute("x2",String(b-E)),j.setAttribute("y2",String(nt)),j.setAttribute("stroke","#111111"),j.setAttribute("stroke-width","1"),l.appendChild(j);let Y=(B-_)/864e5,O=Math.max(3,Math.min(10,Math.floor(M/90)||3)),dt=Y/O,st=[1,2,3,5,7,10,14,21,30,60,90,180,365],it=st[st.length-1];for(let V of st)if(V>=dt){it=V;break}let W=(V=>{let et=new Date(V);return et.setHours(0,0,0,0),et.getTime()})(_);for(let V=W;V<=B+.5*864e5;V+=it*864e5){let et=f+(V-_)/(B-_)*M,Z=document.createElementNS(l.namespaceURI,"line");Z.setAttribute("x1",String(et)),Z.setAttribute("y1",String(k)),Z.setAttribute("x2",String(et)),Z.setAttribute("y2",String(nt)),Z.setAttribute("stroke","#111111"),Z.setAttribute("stroke-opacity","0.18"),Z.setAttribute("stroke-dasharray","2,4"),l.appendChild(Z);let X=document.createElementNS(l.namespaceURI,"text");X.setAttribute("x",String(et)),X.setAttribute("y",String(nt+12)),X.setAttribute("text-anchor","middle"),X.setAttribute("font-size","10"),X.setAttribute("fill","#111111"),X.textContent=Mt(new Date(V)),l.appendChild(X)}}else{let m=[],x=new Set;for(let D of d){let C=String(D.x);x.has(C)||(x.add(C),m.push(D.x))}let h=m.length||1;c=D=>{let C=String(D),_=m.findIndex(B=>String(B)===C);return _<0?f:h===1?f+M/2:f+_/(h-1)*M},A=D=>String(D)}let u=Number.POSITIVE_INFINITY,R=Number.NEGATIVE_INFINITY;for(let m of d)m.y<u&&(u=m.y),m.y>R&&(R=m.y);(!isFinite(u)||!isFinite(R))&&(u=0,R=1),u===R&&(u===0?R=1:u=0);let F=m=>k+T-(m-u)/(R-u||1)*T,G=4;for(let m=0;m<=G;m++){let x=u+(R-u)*m/G,h=F(x),D=document.createElementNS(l.namespaceURI,"line");D.setAttribute("x1",String(f)),D.setAttribute("y1",String(h)),D.setAttribute("x2",String(b-E)),D.setAttribute("y2",String(h)),D.setAttribute("stroke","#cccccc"),D.setAttribute("stroke-opacity","0.25"),l.appendChild(D);let C=document.createElementNS(l.namespaceURI,"text");C.setAttribute("x",String(f-4)),C.setAttribute("y",String(h+3)),C.setAttribute("text-anchor","end"),C.setAttribute("font-size","10"),C.setAttribute("fill","#111111"),C.textContent=Math.abs(x)>=100?String(Math.round(x)):String(Math.round(x*10)/10),l.appendChild(C)}let Q=N.filter(m=>m!=="__default__");if(Q.length>1){let m=s.createDiv({cls:"chart-notes-legend"});Q.forEach((x,h)=>{let D=x,C=m.createDiv({cls:"chart-notes-legend-item"}),_=C.createDiv();_.style.width="10px",_.style.height="10px",_.style.borderRadius="999px",_.style.backgroundColor=ut(D,h),C.createSpan({text:D})})}N.forEach((m,x)=>{let h=v.get(m);if(!(h!=null&&h.length))return;let D=m==="__default__"?ut("line",x):ut(m,x),C=[...h];H&&C.sort((B,nt)=>{let j=Yt(B.x),Y=Yt(nt.x),rt=j?j.getTime():0,O=Y?Y.getTime():0;return rt-O});let _="";if(C.forEach((B,nt)=>{let j=c(B.x),Y=F(B.y);_+=(nt===0?"M ":" L ")+j+" "+Y}),n){let B=C[0],nt=C[C.length-1],j=c(B.x),Y=c(nt.x),rt=F(u);_+=` L ${Y} ${rt} L ${j} ${rt} Z`;let O=document.createElementNS(l.namespaceURI,"path");O.setAttribute("d",_),O.setAttribute("fill",D),O.setAttribute("fill-opacity","0.18"),O.setAttribute("stroke",D),O.setAttribute("stroke-width","1.5"),l.appendChild(O)}else{let B=document.createElementNS(l.namespaceURI,"path");B.setAttribute("d",_),B.setAttribute("fill","none"),B.setAttribute("stroke",D),B.setAttribute("stroke-width","2"),l.appendChild(B)}C.forEach(B=>{let nt=c(B.x),j=F(B.y),Y=document.createElementNS(l.namespaceURI,"circle");Y.setAttribute("cx",String(nt)),Y.setAttribute("cy",String(j)),Y.setAttribute("r","3"),Y.setAttribute("fill","#ffffff"),Y.setAttribute("stroke",D),Y.setAttribute("stroke-width","1.5"),Y.style.cursor="pointer";let rt=A(B.x),O=m==="__default__"?"":String(B.series),dt=O?`${O} @ ${rt}`:rt,st=`valor: ${Math.round(B.y*100)/100}`;Y.addEventListener("mouseenter",it=>{var at,W;return gt(s,S,dt,st,(W=(at=B.notes)==null?void 0:at.length)!=null?W:0,it)}),Y.addEventListener("mouseleave",()=>yt(S)),Y.addEventListener("click",it=>{var at;it.preventDefault(),bt(s,w,dt,B.y,(at=B.notes)!=null?at:[],i)}),l.appendChild(Y)})})}function Ge(s,r,t){var M;let{background:n,drilldown:e=!0}=(M=r.options)!=null?M:{};if(t.rows.length===0){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let o=$e(n)?"#000000":void 0,i=s.getBoundingClientRect().width||600,{inner:d,svg:a,tooltip:l,details:S}=vt(s,n),w=Math.max(i,420);d.style.width=w+"px",o&&(a.style.color=o);let y=300,b=w/2,f=(y-28+28)/2,E=Math.min(w/2-20,y/2-20),g=t.rows.map(T=>Math.max(0,T.y)).reduce((T,K)=>T+K,0)||1,L=-Math.PI/2;t.rows.forEach((T,K)=>{var I;let H=T.x instanceof Date?T.x.toISOString().slice(0,10):String(T.x),v=T.y,N=v/g*Math.PI*2,c=b+E*Math.cos(L),A=f+E*Math.sin(L),u=b+E*Math.cos(L+N),R=f+E*Math.sin(L+N),F=N>Math.PI?1:0,G=document.createElementNS(a.namespaceURI,"path"),Q=[`M ${b} ${f}`,`L ${c} ${A}`,`A ${E} ${E} 0 ${F} 1 ${u} ${R}`,"Z"].join(" ");G.setAttribute("d",Q),G.setAttribute("fill",ut((I=T.series)!=null?I:H,K)),G.style.cursor="pointer",G.addEventListener("mouseenter",P=>{var z,J;return gt(s,l,H,v,(J=(z=T.notes)==null?void 0:z.length)!=null?J:0,P)}),G.addEventListener("mouseleave",()=>yt(l)),G.addEventListener("click",()=>{var P;return bt(s,S,H,v,(P=T.notes)!=null?P:[],e)}),a.appendChild(G),L+=N})}function Be(s,r,t){var A;let{background:n,drilldown:e=!0}=(A=r.options)!=null?A:{};if(t.rows.length===0){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let o=n?"#111111":void 0,i=s.getBoundingClientRect().width||600,{inner:d,svg:a,tooltip:l,details:S}=vt(s,n),w=Math.max(i,700);d.style.width=w+"px",o&&(a.style.color=o);let y=300,b=w-48-10,f=y-28-28,E=t.rows.map(u=>{let R=u.x;if(R instanceof Date)return R.getTime();if(typeof R=="string"){if(/^\d{4}-\d{2}-\d{2}/.test(R)){let G=new Date(R);if(!isNaN(G.getTime()))return G.getTime()}let F=Number(R);return isNaN(F)?null:F}return typeof R=="number"?R:null}),k=t.rows.map(u=>u.y),g=E.filter(u=>u!==null);if(g.length===0){s.createDiv({cls:"prop-charts-empty",text:"Sem dados (X n\xE3o \xE9 num\xE9rico/data)."});return}let L=Math.min(...g),M=Math.max(...g),T=Math.min(...k),K=Math.max(...k),H=u=>48+(u-L)/(M-L||1)*b,v=u=>y-28-(u-T)/(K-T||1)*f,N=document.createElementNS(a.namespaceURI,"line");N.setAttribute("x1",String(48)),N.setAttribute("y1",String(28)),N.setAttribute("x2",String(48)),N.setAttribute("y2",String(y-28)),N.setAttribute("stroke","currentColor"),a.appendChild(N);let c=document.createElementNS(a.namespaceURI,"line");c.setAttribute("x1",String(48)),c.setAttribute("y1",String(y-28)),c.setAttribute("x2",String(w-10)),c.setAttribute("y2",String(y-28)),c.setAttribute("stroke","currentColor"),a.appendChild(c),t.rows.forEach((u,R)=>{let F=E[R];if(F==null)return;let G=H(F),Q=v(k[R]),I=document.createElementNS(a.namespaceURI,"circle");I.setAttribute("cx",String(G)),I.setAttribute("cy",String(Q)),I.setAttribute("r","4"),I.setAttribute("fill",ut(u.series,R)),I.style.cursor="pointer";let P=u.x instanceof Date?u.x.toISOString().slice(0,10):typeof u.x=="string"?u.x:String(u.x);I.addEventListener("mouseenter",z=>{var J,m;return gt(s,l,P,u.y,(m=(J=u.notes)==null?void 0:J.length)!=null?m:0,z)}),I.addEventListener("mouseleave",()=>yt(l)),I.addEventListener("click",z=>{var J;z.preventDefault(),bt(s,S,P,u.y,(J=u.notes)!=null?J:[],e)}),a.appendChild(I)})}var ie=class{render(r,t,n,e){var a;let{title:o}=(a=t.options)!=null?a:{};r.empty(),r.addClass("prop-charts-container");let d=r.createDiv({cls:"prop-charts-title-row"}).createDiv({cls:"prop-charts-title"});switch(o&&(d.textContent=o),t.type){case"bar":fe(r,t,n);break;case"stacked-bar":He(r,t,n);break;case"line":ge(r,t,n,!1);break;case"area":ge(r,t,n,!0);break;case"pie":Ge(r,t,n);break;case"scatter":Be(r,t,n);break;case"gantt":se(r,t,n,e);break;default:r.createDiv({text:"Chart Notes: tipo n\xE3o suportado: "+t.type})}}};var ae=class extends Qt.Plugin{constructor(t,n){super(t,n)}async onload(){console.log("Chart Notes: loading plugin (Bases-only)"),this.indexer=new te(this.app),await this.indexer.buildIndex(),this.query=new re(()=>this.indexer.getAll(),[]),this.renderer=new ie,this.registerEvent(this.app.vault.on("modify",async t=>{t instanceof Qt.TFile&&await this.indexer.updateFile(t)})),this.registerEvent(this.app.vault.on("create",async t=>{t instanceof Qt.TFile&&await this.indexer.updateFile(t)})),this.registerEvent(this.app.vault.on("delete",async t=>{t instanceof Qt.TFile&&this.indexer.removeFile(t)})),this.registerBasesView(de,{name:"Chart Notes",icon:"lucide-chart-area",factory:(t,n)=>new Zt(t,n,this.renderer),options:()=>{let t=[];return t.push({type:"dropdown",key:"chartType",displayName:"Chart type",description:"Type of chart to render",default:"bar",options:{bar:"Bar","stacked-bar":"Stacked bar",line:"Line",area:"Area",pie:"Pie",scatter:"Scatter",gantt:"Gantt"}}),t.push({type:"property",key:"xProperty",displayName:"X axis / category (bars & slices)",description:"Property used for the X axis or categories (for pie, this is the slice).",shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")==="gantt"}}),t.push({type:"property",key:"ganttLabelProperty",displayName:"Task label (Gantt)",description:`Label for each task bar.
If empty, uses the note title.`,shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")!=="gantt"}}),t.push({type:"property",key:"yProperty",displayName:"Y value (empty = count)",description:`Numeric property summed on the Y axis.
Leave empty to just count notes.`,shouldHide:n=>{var o;let e=String((o=n.get("chartType"))!=null?o:"bar");return e==="pie"||e==="gantt"}}),t.push({type:"property",key:"seriesProperty",displayName:"Series / color (optional)",description:"Property that defines series / color for bars, lines and area.",shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")==="pie"}}),t.push({type:"dropdown",key:"aggregateY",displayName:"Value aggregation (Y)",description:"How to aggregate Y values for line/area charts (normal sum or cumulative sum).",default:"sum",options:{sum:"Sum",cumulative:"Cumulative sum"},shouldHide:n=>{var o;let e=String((o=n.get("chartType"))!=null?o:"bar");return!(e==="line"||e==="area")}}),t.push({type:"dropdown",key:"xBucket",displayName:"X bucket (dates)",description:"How to bucket dates on the X axis for line / area charts (day, week, month...).",default:"auto",options:{auto:"Auto",none:"None",day:"Day",week:"Week",month:"Month",quarter:"Quarter",year:"Year"},shouldHide:n=>{var o;let e=String((o=n.get("chartType"))!=null?o:"bar");return!(e==="line"||e==="area")}}),t.push({type:"property",key:"startProperty",displayName:"Start (Gantt)",description:"Start date/datetime for the task.",shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")!=="gantt"}}),t.push({type:"property",key:"endProperty",displayName:"End (Gantt)",description:"End date/datetime for the task.",shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")!=="gantt"}}),t.push({type:"property",key:"dueProperty",displayName:"Due (deadline, optional)",description:"Due date / deadline for the task.",shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")!=="gantt"}}),t.push({type:"property",key:"durationProperty",displayName:"Duration in minutes (optional)",description:`Duration of the task in minutes.
Used together with start/end/due.`,shouldHide:n=>{var e;return String((e=n.get("chartType"))!=null?e:"bar")!=="gantt"}}),t.push({type:"toggle",key:"drilldown",displayName:"Drilldown (click opens notes)",default:!0}),t.push({type:"text",key:"title",displayName:"Title (optional)",description:`Custom chart title.
Falls back to the view name.`}),t}})}onunload(){console.log("Chart Notes: unloading plugin")}};
