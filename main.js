/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var ue=Object.defineProperty;var We=Object.getOwnPropertyDescriptor;var Oe=Object.getOwnPropertyNames;var Ye=Object.prototype.hasOwnProperty;var Xe=(s,e)=>{for(var t in e)ue(s,t,{get:e[t],enumerable:!0})},ze=(s,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Oe(e))!Ye.call(s,r)&&r!==t&&ue(s,r,{get:()=>e[r],enumerable:!(n=We(e,r))||n.enumerable});return s};var qe=s=>ze(ue({},"__esModule",{value:!0}),s);var fn={};Xe(fn,{default:()=>ae});module.exports=qe(fn);var Vt=require("obsidian");var Jt=require("obsidian"),de="chartnotes-view",je=["bar","stacked-bar","line","area","pie","scatter","gantt"];function Ze(s){let e=String(s!=null?s:"bar").trim().toLowerCase();return je.includes(e)?e:"bar"}var Je=["sum","count","cumulative-sum"];function tn(s){let e=String(s!=null?s:"sum").trim().toLowerCase();return Je.includes(e)?e:"sum"}var en=["auto","none","day","week","month","quarter","year"];function nn(s){let e=String(s!=null?s:"auto").trim().toLowerCase();return en.includes(e)?e:"auto"}var jt="(missing)",Zt=class extends Jt.BasesView{constructor(t,n,r){super(t);this.type=de;this.renderer=r,this.rootEl=n.createDiv("chartnotes-bases-view")}onDataUpdated(){var L,$,h;this.rootEl.empty();let t=this.data,n=(L=t==null?void 0:t.groupedData)!=null?L:[];if(!n.length){this.rootEl.createDiv({cls:"prop-charts-empty",text:"No data in this view."});return}let r=this.config,o=Ze(($=r==null?void 0:r.get("chartType"))!=null?$:"bar"),i=o==="pie",p=o==="scatter",a=o==="gantt",l=tn(r==null?void 0:r.get("aggregateMode")),A=l==="cumulative-sum"&&!(o==="line"||o==="area")?"sum":l,m=nn(r==null?void 0:r.get("xBucket")),f=i||p||a?"none":m,g=this.getPropFromConfig("xProperty"),T=this.getPropFromConfig("ganttLabelProperty"),R=this.getPropFromConfig("yProperty"),M=this.getPropFromConfig("seriesProperty");i&&(M={id:null,name:null});let y=this.getPropFromConfig("startProperty"),_=this.getPropFromConfig("endProperty"),E=this.getPropFromConfig("dueProperty"),H=this.getPropFromConfig("scheduledProperty"),G=this.getPropFromConfig("durationProperty"),v=this.getPropFromConfig("groupProperty");if(!a&&!g.id){this.rootEl.createDiv({cls:"prop-charts-empty",text:"Configure the 'X axis / category' property in view options."});return}if(p&&(!g.id||!R.id)){this.rootEl.createDiv({cls:"prop-charts-empty",text:"Scatter plots need both X and Y numeric properties."});return}if(a&&!(y.id||_.id||H.id||E.id)){this.rootEl.createDiv({cls:"prop-charts-empty",text:"Gantt needs Start/End or Scheduled/Due with Duration."});return}let C=a&&T.id?T:a?g:{id:null,name:null},c;if(a)c=this.buildRowsForGantt(n,C,M,y,_,E,H,G,v);else if(p)c=this.buildRowsForScatter(n,g,R,M);else{let b=i;c=this.buildRowsForAggregatedCharts(n,g,R,M,A,f,b)}if(!c.length){this.rootEl.createDiv({cls:"prop-charts-empty",text:"No rows to display (check X/Y/aggregation)."});return}let P={rows:c},x=((h=r==null?void 0:r.get("title"))!=null?h:"").trim()||(r==null?void 0:r.name)||"Chart Notes (Bases)",F=r==null?void 0:r.get("drilldown"),Y=typeof F=="boolean"?F:!0,tt=this.buildEncoding({x:g,y:R,series:M,start:y,end:_,due:E,duration:G,group:v,label:C,aggMode:A,xBucket:f,chartType:o}),B={type:o,source:{type:"properties",query:""},encoding:tt,options:{title:x,drilldown:Y}},V={refresh:()=>this.onDataUpdated()};this.renderer.render(this.rootEl,B,P,V)}getPropFromConfig(t){var p,a;let n=this.config,r=(p=n==null?void 0:n.get)==null?void 0:p.call(n,t);if(!r)return{id:null,name:null};let o=r.trim();if(!o||o==="undefined"||o==="null")return{id:null,name:null};let i=o;try{let l=(0,Jt.parsePropertyId)(i);return{id:i,name:(a=l.name)!=null?a:i}}catch(l){return{id:i,name:i}}}readValue(t,n){if(!n.id)return null;let r;try{r=t.getValue(n.id)}catch(o){return null}if(!r)return null;try{if(typeof r.isEmpty=="function"&&r.isEmpty())return null}catch(o){}try{let o=r.toString();if(o==null)return null;let i=String(o).trim();return i.length?i:null}catch(o){return null}}parseDate(t){if(!t)return null;let n=new Date(t.trim());return Number.isNaN(n.getTime())?null:n}compareX(t,n){let r=this.parseDate(t!=null?String(t):null),o=this.parseDate(n!=null?String(n):null);if(r&&o)return r.getTime()-o.getTime();let i=Number(t),p=Number(n);return!Number.isNaN(i)&&!Number.isNaN(p)?i-p:String(t!=null?t:"").localeCompare(String(n!=null?n:""))}fmtDate(t){let n=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${n}-${r}-${o}`}startOfWeek(t){let n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=(n.getDay()+6)%7;return n.setDate(n.getDate()-r),n.setHours(0,0,0,0),n}bucketX(t,n){let r=this.parseDate(t);if(!r)return t;switch(n){case"none":return t;case"auto":case"day":return this.fmtDate(new Date(r.getFullYear(),r.getMonth(),r.getDate()));case"week":{let o=this.startOfWeek(r);return`${this.fmtDate(o)} (W)`}case"month":{let o=String(r.getMonth()+1).padStart(2,"0");return`${r.getFullYear()}-${o}`}case"quarter":{let o=Math.floor(r.getMonth()/3)+1;return`${r.getFullYear()}-Q${o}`}case"year":return`${r.getFullYear()}`;default:return t}}getXValuesForEntry(t,n,r,o){var S,A;let i=[],p=m=>this.bucketX(m,r);if(!n.id){let m=t.file,f=m!=null&&m.name?String(m.name):String((S=m==null?void 0:m.path)!=null?S:jt);return i.push(p(f)),i}if(!o){let m=(A=this.readValue(t,n))!=null?A:jt;return i.push(p(m)),i}let a=null;try{a=t.getValue(n.id)}catch(m){a=null}let l=m=>{if(!m)return;let f=String(m).trim();f&&i.push(p(f))};if(a==null)l(jt);else if(typeof a=="string"){let m=a.trim();if(m){let f=m.split(/\s+/);for(let g of f)l(g)}}else if(Array.isArray(a))for(let m of a){if(m==null)continue;let f;try{f=m.toString()}catch(g){continue}l(f)}else if(typeof a.toArray=="function"){let m=a.toArray();if(Array.isArray(m))for(let f of m){if(f==null)continue;let g;try{g=f.toString()}catch(T){continue}l(g)}else{let f;try{f=a.toString()}catch(g){f=""}l(f)}}else{let m;try{m=a.toString()}catch(f){m=""}l(m)}return i.length||l(jt),i}buildRowsForAggregatedCharts(t,n,r,o,i,p,a){let l=new Map,S=a||i==="count"||!r.id&&i!=="sum",A=r.name||"y";for(let f of t)for(let g of f.entries){let T=g.file,R=this.getXValuesForEntry(g,n,p,a),M=1,y=null;if(!S&&r.id){if(y=this.readValue(g,r),y==null)continue;let H=Number(y);if(Number.isNaN(H))continue;M=H}else M=1;let _=this.readValue(g,o),E=_!=null?String(_):void 0;for(let H of R){let G=`${H}@@${E!=null?E:""}`,v=l.get(G);v||(v={x:H,y:0,series:E,notes:[],props:{}},l.set(G,v)),v.y+=M,T!=null&&T.path&&v.notes.push(T.path),v.props&&n.name&&(v.props[n.name]=H),!S&&v.props&&A&&y!=null&&(v.props[A]=v.y),S&&v.props&&(v.props[A]=v.y),v.props&&o.name&&_!=null&&(v.props[o.name]=_)}}let m=Array.from(l.values());return i==="cumulative-sum"?this.toCumulative(m):m}toCumulative(t){var o,i;let n=new Map;for(let p of t){let a=(o=p.series)!=null?o:"__no_series__",l=n.get(a);l||(l=[],n.set(a,l)),l.push(p)}let r=[];for(let[,p]of n){let a=[...p].sort((S,A)=>this.compareX(S.x,A.x)),l=0;for(let S of a){let A=Number((i=S.y)!=null?i:0);Number.isNaN(A)||(l+=A,r.push({...S,y:l}))}}return r}buildRowsForScatter(t,n,r,o){let i=[];for(let p of t)for(let a of p.entries){let l=a.file,S=this.readValue(a,n),A=this.readValue(a,r);if(S==null||A==null)continue;let m=Number(S),f=Number(A);if(Number.isNaN(m)||Number.isNaN(f))continue;let g=this.readValue(a,o),T=g!=null?String(g):void 0;i.push({x:m,y:f,series:T,notes:l!=null&&l.path?[l.path]:[],props:{}})}return i}buildRowsForGantt(t,n,r,o,i,p,a,l,S){var M;let A=[],g=y=>{let _=[y==null?void 0:y.label,y==null?void 0:y.name,y==null?void 0:y.value,y==null?void 0:y.key,y==null?void 0:y.group,y==null?void 0:y.groupLabel];for(let E of _)if(E!=null&&String(E).trim()!=="")return String(E);return""},T=n;try{let y=this.getPropFromConfig("ganttLabelProperty");y&&y.id&&(T=y)}catch(y){}let R=!!S.id;for(let y of t){let _=g(y);for(let E of(M=y.entries)!=null?M:[]){let H=E.file,G=this.readValue(E,o),v=this.readValue(E,i),C=this.readValue(E,p),c=this.readValue(E,a),P=this.readValue(E,l),w=P!=null?Number(P):NaN,x=Number.isFinite(w)&&w>0,F=x?w*6e4:36e5,Y=this.parseDate(G),tt=this.parseDate(v),B=this.parseDate(C),V=this.parseDate(c),L=Y,$=tt;if((!L||!$)&&(!L&&!$&&V&&(x?($=V,L=new Date(V.getTime()-F)):(L=V,$=new Date(V.getTime()+36e5))),(!L||!$)&&!V&&B&&(x?($=B,L=new Date(B.getTime()-F)):!L&&!$&&(L=B,$=new Date(B.getTime()+36e5))),(!L||!$)&&Y&&x&&!tt&&(L=Y,$=new Date(Y.getTime()+F)),(!L||!$)&&tt&&x&&!Y&&($=tt,L=new Date(tt.getTime()-F)),L&&!$&&!x&&($=new Date(L.getTime()+36e5)),!L&&$&&!x&&(L=new Date($.getTime()-36e5))),!L||!$)continue;if(L.getTime()>$.getTime()){let N=L;L=$,$=N}let h=this.readValue(E,T);(h==null||String(h).trim()==="")&&(H!=null&&H.name?h=String(H.name).replace(/\.md$/i,""):H!=null&&H.path?h=String(H.path):h="(sem t\xEDtulo)");let b=this.readValue(E,r),k=b!=null?String(b):void 0,u={};if(_&&(u.__basesGroup=_),R){let N=this.readValue(E,S);N!=null&&S.name&&(u[S.name]=N)}T.name&&(u[T.name]=h),u.label=h,o.name&&G!=null&&(u[o.name]=G),i.name&&v!=null&&(u[i.name]=v),p.name&&C!=null&&(u[p.name]=C),a.name&&c!=null&&(u[a.name]=c),x&&l.name&&(u[l.name]=w);let D=H==null?void 0:H.path;A.push({x:h,y:0,series:k,start:L,end:$,due:B!=null?B:void 0,notes:D?[D]:[],props:u})}}return A.sort((y,_)=>!y.start||!_.start?0:y.start.getTime()-_.start.getTime()),A}buildEncoding(t){var p,a,l,S,A,m,f,g,T,R,M;let n=(p=t.x.name)!=null?p:"x",r=(a=t.y.name)!=null?a:"y",o=(A=(S=(l=t.label.name)!=null?l:t.x.name)!=null?S:t.group.name)!=null?A:"label",i=t.chartType==="gantt"?"__basesGroup":(m=t.group.name)!=null?m:"group";return{x:n,y:r,series:(f=t.series.name)!=null?f:"series",start:(g=t.start.name)!=null?g:"start",end:(T=t.end.name)!=null?T:"end",due:(R=t.due.name)!=null?R:"due",duration:(M=t.duration.name)!=null?M:"duration",group:i,label:o}}};var Re=require("obsidian"),te=class{constructor(e){this.index=new Map;this.app=e}async buildIndex(){this.index.clear();let e=this.app.vault.getMarkdownFiles();for(let t of e)await this.updateFile(t)}async fullReindex(){await this.buildIndex()}getAll(){return Array.from(this.index.values())}async updateFile(e){if(e.extension!=="md")return;let t={};try{let r=(await this.app.vault.read(e)).match(/^---\n([\s\S]*?)\n---\n?/);if(r){let i=(0,Re.parseYaml)(r[1])||{};if(i&&typeof i=="object")for(let[p,a]of Object.entries(i))p!=="position"&&(t[p]=a)}let o=this.app.metadataCache.getFileCache(e);o!=null&&o.tags&&!t.tags&&(t.tags=o.tags.map(i=>i.tag.replace(/^#/,"")))}catch(n){console.error("Chart Notes: erro ao indexar",e.path,n)}this.index.set(e.path,{path:e.path,props:t})}removeFile(e){this.index.delete(e.path)}};function Le(s,e){if(!e||e.length===0)return!0;for(let t of e){if(t===".")return!0;let n=t.endsWith("/")?t:t+"/";if(s===t||s.startsWith(n))return!0}return!1}function _e(s,e){if(!e||e.length===0)return!0;let t=s.tags;if(!t)return!1;if(Array.isArray(t)){for(let r of e)if(t.includes(r)||t.includes("#"+r))return!0;return!1}let n=String(t);for(let r of e)if(n===r||n==="#"+r)return!0;return!1}function ne(s){return typeof s!="string"?!1:/^\d{4}-\d{2}-\d{2}/.test(s)}function Ft(s){if(s instanceof Date)return s;if(typeof s!="string")return null;if(/^\d{4}-\d{2}-\d{2}$/.test(s)){let[t,n,r]=s.split("-");return new Date(Number(t),Number(n)-1,Number(r),0,0,0,0)}let e=new Date(s);return isNaN(e.getTime())?null:e}function mt(s){let e=new Date(s);return e.setHours(0,0,0,0),e}function ee(s,e){let t=new Date(s);return t.setDate(t.getDate()-e),t}function rn(s,e){return ee(s,e*7)}function sn(s,e){let t=new Date(s);return t.setMonth(t.getMonth()-e),t}function he(s,e){let t=new Date(s);return t.setDate(t.getDate()+e),t}function on(s,e){return he(s,e*7)}function an(s,e){let t=new Date(s);return t.setMonth(t.getMonth()+e),t}function Me(s){let e=s.toLowerCase();return!!(["date","scheduled","due","start","end","created","modified","datecreated","datemodified"].includes(e)||e.endsWith("date")||e.endsWith("at")||e.endsWith("on"))}function Pe(s,e){let t=e?new Date(e):new Date,n=mt(t),r=s.trim().toLowerCase();if(r==="today")return n;if(r==="yesterday")return mt(ee(n,1));if(/^-\d+$/.test(r)){let o=parseInt(r.slice(1),10);return mt(ee(n,o))}if(/^-\d+d$/.test(r)){let o=parseInt(r.slice(1,-1),10);return mt(ee(n,o))}if(/^-\d+w$/.test(r)){let o=parseInt(r.slice(1,-1),10);return mt(rn(n,o))}if(/^-\d+m$/.test(r)){let o=parseInt(r.slice(1,-1),10);return mt(sn(n,o))}if(/^\+\d+$/.test(r)){let o=parseInt(r.slice(1),10);return mt(he(n,o))}if(/^\+\d+d$/.test(r)){let o=parseInt(r.slice(1,-1),10);return mt(he(n,o))}if(/^\+\d+w$/.test(r)){let o=parseInt(r.slice(1,-1),10);return mt(on(n,o))}if(/^\+\d+m$/.test(r)){let o=parseInt(r.slice(1,-1),10);return mt(an(n,o))}return null}function Ie(s){let e=s.trim(),t=e.match(/^([a-zA-Z0-9_.-]+)\s+between\s+(.+)\s+and\s+(.+)$/i);if(t){let S=t[1].trim(),A=t[2].trim(),m=t[3].trim(),f=Me(S),g=pe(A,f),T=pe(m,f),R=g.valueType==="date"||T.valueType==="date"?"date":g.valueType;return{field:S,op:"between",value:g.value,value2:T.value,valueType:R}}let n=/(==|!=|>=|<=|>|<)/,r=e.split(n);if(r.length!==3)throw new Error("express\xE3o where inv\xE1lida: "+s);let o=r[0].trim(),i=r[1].trim(),p=r[2].trim(),a=Me(o),l=pe(p,a);return{field:o,op:i,value:l.value,valueType:l.valueType}}function pe(s,e){let t=s.trim();if(t.startsWith("'")&&t.endsWith("'")||t.startsWith('"')&&t.endsWith('"'))return{value:t.slice(1,-1),valueType:"string"};let n=t.toLowerCase(),r=n==="today"||n==="yesterday"||n.startsWith("-")||n.startsWith("+");if(e){if(t==="0"||n==="today")return{value:mt(new Date),valueType:"date"};let i=Pe(t);if(i)return{value:i,valueType:"date"}}else if(r){let i=Pe(t);if(i)return{value:i,valueType:"date"}}if(ne(t)){let i=Ft(t);if(i)return{value:i,valueType:"date"}}let o=Number(t);return Number.isNaN(o)?{value:t,valueType:"string"}:{value:o,valueType:"number"}}function Fe(s,e){let t=s[e.field];if(t==null)return!1;if(e.valueType==="date"){let o=t instanceof Date?mt(t):ne(t)?mt(Ft(t)):null;if(!o)return!1;let i=e.value instanceof Date?e.value:null,p=e.value2 instanceof Date?e.value2:null;if(!i)return!1;let a=o.getTime(),l=mt(i).getTime();switch(e.op){case"==":return a===l;case"!=":return a!==l;case">":return a>l;case">=":return a>=l;case"<":return a<l;case"<=":return a<=l;case"between":if(!p)return!1;let S=mt(p).getTime();return a>=l&&a<=S}}if(e.valueType==="number"){let o=Number(t);if(isNaN(o))return!1;let i=Number(e.value);switch(e.op){case"==":return o===i;case"!=":return o!==i;case">":return o>i;case">=":return o>=i;case"<":return o<i;case"<=":return o<=i;case"between":return typeof e.value2!="number"?!1:o>=i&&o<=e.value2}}let n=String(t),r=String(e.value);switch(e.op){case"==":return n===r;case"!=":return n!==r;case">":return n>r;case">=":return n>=r;case"<":return n<r;case"<=":return n<=r;case"between":return!1}}function ln(s){if(typeof s=="string"&&/^\d{4}-\d{2}-\d{2}/.test(s))return{key:s.slice(0,10),isDate:!0};if(ne(s)){let e=Ft(s);if(e)return{key:e,isDate:!0}}return{key:s,isDate:!1}}function cn(s,e){let t=s.x,n=e.x;if(t instanceof Date&&n instanceof Date)return t.getTime()-n.getTime();let r=String(t),o=String(n);return r<o?-1:r>o?1:0}function un(s,e){var o,i;let t=cn(s,e);if(t!==0)return t;let n=(o=s.series)!=null?o:"",r=(i=e.series)!=null?i:"";return n<r?-1:n>r?1:0}function dn(s){if(s==null)return 0;if(typeof s=="number")return s>0?Math.floor(s):0;if(typeof s=="string"){let e=s.trim().match(/^(\d+)/);if(e){let t=Number(e[1]);return Number.isFinite(t)&&t>0?Math.floor(t):0}}throw new Error(`aggregate.rolling inv\xE1lido: ${String(s)}`)}function pn(s){var n,r;let e=new Map,t=[];for(let o of s){let i=(n=o.series)!=null?n:"__no_series__",a=((r=e.get(i))!=null?r:0)+o.y;e.set(i,a),t.push({...o,y:a})}return t}function hn(s,e){var i,p;let t=dn(e);if(!t||t<=1)return[...s];let n=new Map,r=new Map,o=[];for(let a of s){let l=(i=a.series)!=null?i:"__no_series__",S=n.get(l);S||(S=[],n.set(l,S));let A=(p=r.get(l))!=null?p:0;if(S.push(a.y),A+=a.y,S.length>t){let g=S.shift();A-=g}r.set(l,A);let m=S.length||1,f=A/m;o.push({...a,y:f})}return o}var re=class{constructor(e,t){this.getIndex=e,this.defaultPaths=t}run(e){var i,p,a;let t=this.getIndex(),n=(i=e.source)!=null&&i.paths&&e.source.paths.length?e.source.paths:this.defaultPaths,r=(p=e.source)!=null&&p.tags&&e.source.tags.length?e.source.tags:[],o=[];for(let l of t){let S=n&&n.length?Le(l.path,n):!0,A=r&&r.length?_e(l.props,r):!0;if(!S||!A)continue;let m=!0;if((a=e.source)!=null&&a.where&&e.source.where.length>0)for(let f of e.source.where){let g;try{g=Ie(f)}catch(T){throw new Error(`Condi\xE7\xE3o inv\xE1lida: ${f} (${T.message})`)}if(!Fe(l.props,g)){m=!1;break}}m&&o.push(l)}return e.type==="gantt"?this.runGantt(e,o):e.type==="table"?this.runTable(e,o):this.runStandard(e,o)}runTable(e,t){var r,o;return{rows:t.map(i=>({x:i.path,y:0,notes:[i.path],props:i.props})),xField:(r=e.encoding)==null?void 0:r.x,yField:(o=e.encoding)==null?void 0:o.y}}runGantt(e,t){var A,m,f;let n=(A=e.encoding)!=null?A:{},r=n.start,o=n.end,i=(m=n.label)!=null?m:n.x,p=n.series,a=n.duration,l=n.due,S=[];for(let g of t){let T=(f=g.props)!=null?f:{},R=v=>Array.isArray(v)?v[0]:v,M=null;if(o){let v=R(T[o]),C=Ft(v);C&&(M=C)}if(!M)continue;let y=null;if(r){let v=R(T[r]),C=Ft(v);C&&(y=C)}if(!y&&a){let v=R(T[a]),C=Number(v);Number.isNaN(C)||(y=new Date(M.getTime()-C*6e4))}y||(y=new Date(M.getTime()));let _;if(l){let v=R(T[l]),C=Ft(v);C&&(_=C)}let E;if(i){let v=R(T[i]);(v==null||v==="")&&(v=g.path),E=v}else E=g.path;let H;if(p){let v=R(T[p]);v!=null&&(H=String(v))}let G={x:E,y:0,notes:[g.path],series:H,start:y,end:M,props:T};_&&(G.due=_),S.push(G)}return S.sort((g,T)=>{let R=g.start?g.start.getTime():0,M=T.start?T.start.getTime():0;return R-M}),{rows:S,xField:i,yField:o}}runStandard(e,t){var g,T,R,M,y,_,E,H,G,v;let n=(g=e.encoding)==null?void 0:g.x,r=(T=e.encoding)==null?void 0:T.y,o=(R=e.encoding)==null?void 0:R.series;if(!n)throw new Error("encoding.x \xE9 obrigat\xF3rio.");let i=(M=e.aggregate)!=null?M:{},p=(y=i.y)!=null?y:null,a=!!i.cumulative,l=i.rolling;if(!r&&p!=="count")throw new Error("encoding.y \xE9 obrigat\xF3rio (exceto quando aggregate.y = 'count').");let S=[];for(let C of t){let c=(_=C.props)!=null?_:{},P=V=>Array.isArray(V)?V[0]:V,w=P(c[n]);if(w==null)continue;let x=ln(w),F=x.key,Y=x.isDate,tt;if(o){let V=P(c[o]);V!=null&&String(V).trim()!==""&&(tt=String(V))}let B;if(p==="count")B=1;else{let V=P(c[r]);if(V==null)continue;let L=Number(V);if(Number.isNaN(L))continue;B=L}S.push({x:F,y:B,notes:[C.path],series:tt,props:c,_isDate:Y,_origX:w})}if(S.length===0)return{rows:[],xField:n,yField:r};let A=[];if(p){let C=new Map;for(let c of S){let P=(E=c.series)!=null?E:"",w=c.x instanceof Date?c.x.toISOString().slice(0,10):String(c.x),x=P+"||"+w,F=(H=C.get(x))!=null?H:{sum:0,count:0,min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY,notes:[],xRep:c.x,isDate:c._isDate,series:c.series,props:c.props};F.sum+=c.y,F.count+=1,c.y<F.min&&(F.min=c.y),c.y>F.max&&(F.max=c.y),F.notes.push(...c.notes),F.props=(G=c.props)!=null?G:F.props,C.set(x,F)}for(let[,c]of C){let P=c.sum;switch(p){case"sum":P=c.sum;break;case"avg":P=c.sum/c.count;break;case"min":P=c.min;break;case"max":P=c.max;break;case"count":P=c.count;break}A.push({x:c.xRep,y:P,notes:c.notes,series:c.series,props:c.props})}}else A=S.map(C=>({x:C.x,y:C.y,notes:C.notes,series:C.series,props:C.props}));if(A.length===0)return{rows:[],xField:n,yField:r};let m=((v=e.sort)==null?void 0:v.x)==="desc"?"desc":"asc";if(A.sort((C,c)=>{let P=un(C,c);return m==="asc"?P:-P}),(a||l)&&!(e.type==="line"||e.type==="area"))throw new Error("aggregate.cumulative / aggregate.rolling s\xF3 s\xE3o suportados em type: 'line' ou 'area'.");if(a&&l)throw new Error("Ainda n\xE3o \xE9 poss\xEDvel usar 'cumulative' e 'rolling' juntos no mesmo gr\xE1fico.");let f=A;return l?f=hn(A,l):a&&(f=pn(A)),{rows:f,xField:n,yField:r}}};var Et=require("obsidian");var $e=["#5b6cff","#5ec27f","#ffb347","#ff6b6b","#b47cff","#4dbbd5","#f78fb3","#50e3a4"];function ut(s,e){if(!s)return"var(--text-accent, #5b6cff)";let t=Array.from(s).reduce((n,r)=>n*33+r.charCodeAt(0)>>>0,0);return $e[t%$e.length]}function wt(s,e){s.addClass("prop-charts-container"),s.style.width="100%",s.style.maxWidth="100%",s.style.position="relative";let t=s.createDiv({cls:"chart-notes-scroll"});t.style.overflowX="auto",t.style.overflowY="hidden",t.style.width="100%",t.style.maxWidth="100%";let n=t.createDiv({cls:"chart-notes-inner"});n.style.display="block",n.style.minHeight=`${300}px`,e&&(n.style.background=e);let r="http://www.w3.org/2000/svg",o=document.createElementNS(r,"svg");o.setAttribute("width","100%"),o.setAttribute("height",String(300)),o.style.display="block",n.appendChild(o);let i=s.createDiv({cls:"chart-notes-tooltip"});i.style.display="none";let p=s.createDiv({cls:"chart-notes-details"});return p.style.display="none",{scroll:t,inner:n,svg:o,tooltip:i,details:p}}function gt(s,e,t,n,r,o){let i=s.getBoundingClientRect(),p=typeof n=="number"?Number.isInteger(n)?String(n):n.toFixed(2):String(n);e.innerHTML=`
    <div class="chart-notes-tooltip-title">${t}</div>
    <div class="chart-notes-tooltip-value">${p}</div>
    <div class="chart-notes-tooltip-notes">${r} nota${r===1?"":"s"}</div>
  `,e.style.display="block";let a=e.getBoundingClientRect(),l=o.clientX-i.left+6,S=o.clientY-i.top+6;l+a.width>i.width-4&&(l=i.width-a.width-4),l<4&&(l=4),S+a.height>i.height-4&&(S=i.height-a.height-4),S<4&&(S=4),e.style.left=l+"px",e.style.top=S+"px"}function yt(s){s.style.display="none"}function bt(s,e,t,n,r,o){if(!o)return;if(e.empty(),!r||r.length===0){e.style.display="none";return}e.style.display="block";let i=e.createEl("div",{cls:"chart-notes-details-header"}),p=i.createEl("div",{cls:"chart-notes-details-title"});p.textContent=`Notas em "${t}" (${r.length})`+(Number.isFinite(n)&&n!==0?` \u2013 valor ${Number.isInteger(n)?n:n.toFixed(2)}`:"");let a=i.createEl("button",{cls:"chart-notes-details-close"});a.textContent="\xD7",a.addEventListener("click",()=>{e.style.display="none"});let l=e.createEl("ul",{cls:"chart-notes-details-list"});for(let S of r){let m=l.createEl("li",{cls:"chart-notes-details-item"}).createEl("a",{cls:"chart-notes-details-link",text:S});m.href="#",m.addEventListener("click",f=>{f.preventDefault(),app.workspace.openLinkText(S,"",!1)})}}function Mt(s){if(!(s instanceof Date)||isNaN(s.getTime()))return"";let e=s.getDate().toString().padStart(2,"0"),t=(s.getMonth()+1).toString().padStart(2,"0");return`${e}/${t}`}function He(s){if(!s)return!1;let e=s.trim().toLowerCase();if(e==="#fff"||e==="#ffffff"||e==="white")return!0;if(!e.startsWith("#"))return!1;let t,n,r;if(e.length===4)t=parseInt(e[1]+e[1],16),n=parseInt(e[2]+e[2],16),r=parseInt(e[3]+e[3],16);else if(e.length===7)t=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16);else return!1;return(.2126*t+.7152*n+.0722*r)/255>.7}var me=class extends Et.Modal{constructor(t,n,r,o){var p;super(app);this.notePath=t,this.spec=n,this.refresh=r,this.reindexFile=o;let i=(p=n.encoding)!=null?p:{};this.startKey=i.start,this.endKey=i.end,this.durationKey=i.duration,this.dueKey=i.due}async onOpen(){var v,C;let{contentEl:t}=this;t.empty();let n=this.app.vault.getAbstractFileByPath(this.notePath);if(!(n instanceof Et.TFile)){t.createEl("p",{text:"Arquivo n\xE3o encontrado: "+this.notePath});return}let r=await this.app.vault.read(n),o={},i=r,p=/^---\n([\s\S]*?)\n---\n?/m.exec(r);if(p){try{o=(v=(0,Et.parseYaml)(p[1]))!=null?v:{}}catch(c){o={}}i=r.slice(p[0].length)}(typeof o!="object"||o==null)&&(o={});let a=(C=this.notePath.replace(/\.md$/i,"").split("/").pop())!=null?C:this.notePath,l=t.createDiv({cls:"gantt-edit-header"}),S=l.createEl("a",{text:a,cls:"gantt-edit-title"});S.href="#",S.addEventListener("click",c=>{c.preventDefault(),this.app.workspace.openLinkText(this.notePath,this.notePath,!0)});let A=l.createDiv({cls:"gantt-edit-subtitle"});A.textContent=this.notePath;let m=t.createDiv({cls:"gantt-edit-form"}),f=c=>{let P=m.createDiv({cls:"gantt-edit-row"}),w=P.createDiv({cls:"gantt-edit-label"});w.textContent=c;let x=P.createDiv({cls:"gantt-edit-field"});return{row:P,field:x}},g=c=>{if(!c)return"";let w=String(c).match(/^(\d{4}-\d{2}-\d{2})/);return w?w[1]:""},T=c=>{if(c=c.trim(),!!c&&/^\d{4}-\d{2}-\d{2}$/.test(c))return c},R=null;if(this.startKey){let{field:c}=f(this.startKey+" (in\xEDcio)");R=c.createEl("input",{type:"date"}),R.value=g(o[this.startKey])}let M=null;if(this.endKey){let{field:c}=f(this.endKey+" (fim)");M=c.createEl("input",{type:"date"}),M.value=g(o[this.endKey])}let y=null;if(this.durationKey){let{field:c}=f(this.durationKey+" (minutos)");y=c.createEl("input",{type:"number"});let P=o[this.durationKey];y.value=P!=null?String(P):"",y.min="0",y.step="5"}let _=null;if(this.dueKey){let{field:c}=f(this.dueKey+" (due)");_=c.createEl("input",{type:"date"}),_.value=g(o[this.dueKey])}let E=t.createDiv({cls:"gantt-edit-buttons"}),H=E.createEl("button",{text:"Salvar",cls:"mod-cta"});E.createEl("button",{text:"Cancelar"}).addEventListener("click",c=>{c.preventDefault(),this.close()}),H.addEventListener("click",async c=>{if(c.preventDefault(),this.startKey&&R){let x=T(R.value);x?o[this.startKey]=x:delete o[this.startKey]}if(this.endKey&&M){let x=T(M.value);x?o[this.endKey]=x:delete o[this.endKey]}if(this.durationKey&&y){let x=y.value.trim();if(x==="")delete o[this.durationKey];else{let F=Number(x);Number.isNaN(F)||(o[this.durationKey]=F)}}if(this.dueKey&&_){let x=T(_.value);x?o[this.dueKey]=x:delete o[this.dueKey]}let w=`---
${(0,Et.stringifyYaml)(o).trim()}
---
`+i;if(await this.app.vault.modify(n,w),this.reindexFile)try{await this.reindexFile(this.notePath)}catch(x){}if(this.refresh)try{this.refresh()}catch(x){}new Et.Notice("Task atualizada"),this.close()})}onClose(){this.contentEl.empty()}};function se(s,e,t,n){var Se,xe,ve,we,Ae,De,Ee,Te;let r=(Se=e.options)!=null?Se:{},o=r.background,i=(xe=r.drilldown)!=null?xe:!0,p=!0,a=d=>{if(d==null)return"";let I=String(d).trim();if(!I)return"";let W=I.match(/^\[\[(.+?)\]\]$/);W&&(I=W[1]);let J=I.lastIndexOf("/");return J>=0&&J<I.length-1&&(I=I.slice(J+1)),I};if(Array.from(s.querySelectorAll(".gantt-zoom-controls, .gantt-label-floating-btn, .chart-notes-scroll, .chart-notes-details, .chart-notes-tooltip, .prop-charts-empty")).forEach(d=>d.remove()),t.rows.length===0){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let l=t.rows.filter(d=>d.start&&d.end);if(l.length===0){s.createDiv({cls:"prop-charts-empty",text:"Gantt: faltam campos de data."});return}let S=e.encoding,A=S.group,m=S.duration,f=(d,I)=>{if(!d||!I)return;let W=d[I];return Array.isArray(W)?W[0]:W},g="__chartnotes_no_group__",R=l.map(d=>{var ht,xt;let I=d.start,W=d.end,J=d.props,It=typeof d.x=="string"?d.x:d.x instanceof Date?Mt(I):String(d.x),Tt=a(It),At=A!=null&&A!==""?f(J,A):void 0,Ct=At!=null&&String(At).trim().length>0?String(At):g,ft=(ht=d.notes)==null?void 0:ht[0],kt=ft?(xt=ft.replace(/\.md$/i,"").split("/").pop())!=null?xt:ft:Tt,Bt=d.due,Lt,St=f(J,m);if(St!=null){let Nt=Number(St);Number.isNaN(Nt)||(Lt=Nt)}return{row:d,start:I,end:W,props:J,fullName:Tt,groupKey:Ct,notePath:ft,noteTitle:kt,due:Bt,estMinutes:Lt}}).filter(d=>d.start instanceof Date&&!isNaN(d.start.getTime())&&d.end instanceof Date&&!isNaN(d.end.getTime()));if(R.length===0){s.createDiv({cls:"prop-charts-empty",text:"Gantt: datas inv\xE1lidas."});return}R.sort((d,I)=>{if(d.groupKey<I.groupKey)return-1;if(d.groupKey>I.groupKey)return 1;let W=d.start.getTime(),J=I.start.getTime();return W!==J?W-J:d.fullName.localeCompare(I.fullName)});let M=26,y=0,_=null;for(let d of R)d.groupKey!==_&&(_=d.groupKey,d.groupKey!==g&&(y+=1)),y+=1;let E=Math.min(...R.map(d=>d.start.getTime())),H=Math.max(...R.map(d=>d.end.getTime()));if(!isFinite(E)||!isFinite(H)){s.createDiv({cls:"prop-charts-empty",text:"Gantt: intervalo de datas inv\xE1lido."});return}let G=24*60*60*1e3,v=d=>{let I=new Date(d);return I.setHours(0,0,0,0),I.getTime()},C=v(E),c=v(H),P=s.querySelector(".prop-charts-title-row");P||(P=s.createDiv({cls:"prop-charts-title-row"}));let w=s.dataset.ganttZoomMode||String((ve=r.zoomMode)!=null?ve:"100");s.dataset.ganttZoomMode=w;let x=s.dataset.ganttLabelMode||String((we=r.labelMode)!=null?we:"compact");s.dataset.ganttLabelMode=x;let F=P.createDiv({cls:"gantt-zoom-controls"});[{id:"fit",label:"Fit"},{id:"100",label:"100%"},{id:"150",label:"150%"},{id:"200",label:"200%"}].forEach(d=>{let I=F.createEl("button",{cls:"gantt-zoom-btn",text:d.label});d.id===w&&I.addClass("is-active"),I.addEventListener("click",W=>{W.preventDefault(),s.dataset.ganttZoomMode=d.id,se(s,e,t,n)})}),F.createEl("button",{cls:"gantt-zoom-btn gantt-fullscreen-btn",text:"\u2922"}).addEventListener("click",d=>{d.preventDefault();let I=s.querySelector(".chart-notes-zoom-button");I&&I.click()});let B=Number(r.labelWidth),V=!Number.isNaN(B)&&B>120?B:260,L=x==="wide"?V+160:V,$=s.getBoundingClientRect().width||600,h=Math.max($,820),b;if(w==="fit")b=$;else{let d=Number(w)/100||1;b=h*d}let{inner:k,svg:u,tooltip:D,details:N}=wt(s,o);k.style.width=b+"px";let K=(d,I,W,J,It,Tt,At,Qt,Ct)=>{if(!d)return;let ft=Math.max(40,J-8),Bt=Math.max(8,Math.floor(ft/6)),Lt=d.split(/\s+/),St=[],ht="";for(let Rt of Lt){if(!ht){ht=Rt;continue}(ht+" "+Rt).length<=Bt?ht+=" "+Rt:(St.push(ht),ht=Rt)}ht&&St.push(ht);let xt=It+2,Nt=St.length*xt,Ut=W-Nt/2+It;St.forEach((Rt,zt)=>{let ct=document.createElementNS(u.namespaceURI,"text");ct.setAttribute("x",String(I)),ct.setAttribute("y",String(Ut+zt*xt)),ct.setAttribute("text-anchor","start"),ct.setAttribute("font-size",String(It)),ct.setAttribute("fill","#111111"),Tt&&ct.setAttribute("font-weight",Tt),ct.textContent=Rt,At&&ct.addEventListener("mouseenter",at=>At(at)),Qt&&ct.addEventListener("mouseleave",()=>Qt()),Ct&&(ct.style.cursor="pointer",ct.addEventListener("click",at=>Ct(at))),u.appendChild(ct)})},st=28,z=28,O=10,nt=Math.max(300,st+z+y*M+24);u.setAttribute("height",String(nt));let q=b-L-O,rt=st+6;u.style.color="#111111";let dt=c+G-C||1,ot=C-dt*.02,lt=c+G+dt*.08,U=d=>L+(d-ot)/(lt-ot)*q,Q=(lt-ot)/G,Z=Math.max(4,Math.min(12,Math.floor(q/90)||4)),X=Q/Z,pt=[1,2,3,5,7,10,14,21,30,60,90,180,365],Kt=pt[pt.length-1];for(let d of pt)if(d>=X){Kt=d;break}let ye=[],Ke=v(ot);for(let d=Ke;d<=lt+.5*G;d+=Kt*G)ye.push(d);let $t=document.createElementNS(u.namespaceURI,"line");$t.setAttribute("x1",String(L)),$t.setAttribute("y1",String(rt)),$t.setAttribute("x2",String(b-O)),$t.setAttribute("y2",String(rt)),$t.setAttribute("stroke","#111111"),u.appendChild($t);for(let d of ye){let I=U(d),W=document.createElementNS(u.namespaceURI,"line");W.setAttribute("x1",String(I)),W.setAttribute("y1",String(rt)),W.setAttribute("x2",String(I)),W.setAttribute("y2",String(nt-z)),W.setAttribute("stroke","#111111"),W.setAttribute("stroke-opacity","0.20"),W.setAttribute("stroke-dasharray","2,4"),u.appendChild(W);let J=document.createElementNS(u.namespaceURI,"text");J.setAttribute("x",String(I)),J.setAttribute("y",String(rt-4)),J.setAttribute("text-anchor","middle"),J.setAttribute("font-size","10"),J.setAttribute("fill","#111111"),J.textContent=Mt(new Date(d)),u.appendChild(J)}let be=new Date;be.setHours(0,0,0,0);let le=be.getTime();if(le>=ot&&le<=lt){let d=U(le),I=document.createElementNS(u.namespaceURI,"line");I.setAttribute("x1",String(d)),I.setAttribute("y1",String(rt)),I.setAttribute("x2",String(d)),I.setAttribute("y2",String(nt-z)),I.setAttribute("stroke","#4caf50"),I.setAttribute("stroke-width","2"),I.setAttribute("stroke-dasharray","4,2"),u.appendChild(I);let W=document.createElementNS(u.namespaceURI,"text");W.setAttribute("x",String(d+4)),W.setAttribute("y",String(rt+12)),W.setAttribute("font-size","10"),W.setAttribute("fill","#4caf50"),W.textContent="hoje",u.appendChild(W)}let Yt=k.createEl("button",{cls:"gantt-label-floating-btn",text:"\u2194"});Yt.setAttr("title",x==="wide"?"Compactar nomes":"Expandir nomes"),Yt.style.left=`${L}px`,Yt.style.top="4px",Yt.addEventListener("click",d=>{d.preventDefault();let W=(s.dataset.ganttLabelMode||"compact")==="wide"?"compact":"wide";s.dataset.ganttLabelMode=W,se(s,e,t,n)});let Qe=["status","priority"],ce=Array.isArray(r.tooltipFields)?r.tooltipFields.map(d=>String(d)):null,Ue=ce&&ce.length?ce:Qe,Ht=0,Xt=null;for(let d of R){let I=d.start,W=d.end,J=(W.getTime()-I.getTime())/6e4,It=d.props,Tt=d.notePath,At=d.noteTitle,Qt=(De=(Ae=d.row.notes)==null?void 0:Ae.length)!=null?De:0,Ct=d.due,ft=d.estMinutes,kt=[];kt.push(`${Mt(I)} \u2192 ${Mt(W)}`),typeof ft=="number"&&!Number.isNaN(ft)?kt.push(`est: ${Math.round(ft)} min`):J>0&&kt.push(`dura\xE7\xE3o: ${Math.round(J)} min`),Ct instanceof Date&&kt.push(`due: ${Mt(Ct)}`);for(let it of Ue){let j=f(It,it);j!=null&&String(j).trim()!==""&&kt.push(`${it}: ${String(j)}`)}let Bt=kt.join("<br>"),Lt=it=>{var j;it.preventDefault(),p&&Tt?new me(Tt,e,n==null?void 0:n.refresh,n==null?void 0:n.reindexFile).open():bt(s,N,At,ft!=null?ft:J,(j=d.row.notes)!=null?j:[],i)},St=it=>{At&&Bt&&gt(s,D,At,Bt,Qt,it)},ht=()=>yt(D);if(d.groupKey!==Xt&&(Xt=d.groupKey,Xt!==g)){let it=rt+8+Ht*M+M/2,j=a(Xt);K(j,4,it,L-12,11,"600"),Ht+=1}let xt=rt+8+Ht*M,Nt=M-10,Ut=U(I.getTime()),Rt=U(W.getTime()),zt=Math.max(4,Rt-Ut),ct=d.fullName,at=document.createElementNS(u.namespaceURI,"rect");at.setAttribute("x",String(Ut)),at.setAttribute("y",String(xt)),at.setAttribute("width",String(zt)),at.setAttribute("height",String(Nt)),at.setAttribute("rx","3"),at.setAttribute("ry","3"),at.setAttribute("fill",ut((Ee=d.row.series)!=null?Ee:ct,Ht)),at.setAttribute("stroke","rgba(0,0,0,0.25)"),at.setAttribute("stroke-width","0.5"),at.style.cursor=p&&Tt?"pointer":"default",at.addEventListener("mouseenter",St),at.addEventListener("mouseleave",ht),at.addEventListener("click",Lt),u.appendChild(at);let Ce=xt+Nt/2;if(zt>=6){let it=ut((Te=d.row.series)!=null?Te:ct,Ht),j=document.createElementNS(u.namespaceURI,"circle");j.setAttribute("cx",String(Ut)),j.setAttribute("cy",String(Ce)),j.setAttribute("r","3.5"),j.setAttribute("fill","#ffffff"),j.setAttribute("stroke",it),j.setAttribute("stroke-width","1.5"),u.appendChild(j);let _t=document.createElementNS(u.namespaceURI,"circle");_t.setAttribute("cx",String(Rt)),_t.setAttribute("cy",String(Ce)),_t.setAttribute("r","3.5"),_t.setAttribute("fill","#ffffff"),_t.setAttribute("stroke",it),_t.setAttribute("stroke-width","1.5"),u.appendChild(_t)}let ke=xt+Nt/2+2,qt=4;if(x==="wide")K(ct,qt,ke,L-qt-4,11,null,St,ht,Lt);else{let it=ct,j=Math.max(40,L-qt-8),Ne=Math.max(8,Math.floor(j/6));it.length>Ne&&(it=it.slice(0,Ne-1)+"\u2026");let vt=document.createElementNS(u.namespaceURI,"text");vt.setAttribute("x",String(qt)),vt.setAttribute("y",String(ke)),vt.setAttribute("text-anchor","start"),vt.setAttribute("font-size","11"),vt.setAttribute("fill","#111111"),vt.textContent=it,vt.style.cursor="pointer",vt.addEventListener("mouseenter",St),vt.addEventListener("mouseleave",ht),vt.addEventListener("click",Lt),u.appendChild(vt)}if(Ct instanceof Date){let it=U(Ct.getTime()),j=document.createElementNS(u.namespaceURI,"line");j.setAttribute("x1",String(it)),j.setAttribute("y1",String(xt)),j.setAttribute("x2",String(it)),j.setAttribute("y2",String(xt+Nt)),j.setAttribute("stroke","#ff6b6b"),j.setAttribute("stroke-width","2"),j.setAttribute("stroke-dasharray","4,2"),u.appendChild(j)}Ht+=1}if(p){let d=s.createDiv({cls:"prop-charts-empty"});d.textContent="Clique em uma barra ou no nome para ajustar datas e estimate da tarefa."}}function fe(s,e,t){var V,L,$,h;let n=(V=e.options)!=null?V:{},r=n.background,o=(L=n.drilldown)!=null?L:!0,i=($=t.rows)!=null?$:[];if(!i.length){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let{inner:p,svg:a,tooltip:l,details:S}=wt(s,r),A=s.getBoundingClientRect().width||600,m=Math.max(A,480);p.style.width=m+"px";let f=40,g=16,T=18,R=28,M=300;a.setAttribute("height",String(M));let y=m-f-g,_=M-T-R,E=new Map;for(let b of i){let k=String(b.x),u=(h=E.get(k))!=null?h:{label:b.x,rows:[]};u.rows.push(b),E.set(k,u)}let G=Array.from(E.keys()).sort((b,k)=>b<k?-1:b>k?1:0).map(b=>E.get(b)),v=G.length,C=new Set;i.forEach(b=>{b.series!=null&&C.add(String(b.series))});let c=Array.from(C),P=c.length>1,w=P?"grouped":"single",x=0;i.forEach(b=>{b.y>x&&(x=b.y)}),(!isFinite(x)||x<=0)&&(x=1);let F=b=>T+_-b/(x||1)*_,Y=F(0),tt=4;for(let b=0;b<=tt;b++){let k=x*b/tt,u=F(k),D=document.createElementNS(a.namespaceURI,"line");D.setAttribute("x1",String(f)),D.setAttribute("y1",String(u)),D.setAttribute("x2",String(m-g)),D.setAttribute("y2",String(u)),D.setAttribute("stroke","#cccccc"),D.setAttribute("stroke-opacity","0.25"),a.appendChild(D);let N=document.createElementNS(a.namespaceURI,"text");N.setAttribute("x",String(f-4)),N.setAttribute("y",String(u+3)),N.setAttribute("text-anchor","end"),N.setAttribute("font-size","10"),N.setAttribute("fill","#111111"),N.textContent=String(Math.round(k)),a.appendChild(N)}let B=v>0?y/v:y;if(G.forEach((b,k)=>{let u=f+B*(k+.5),D=String(b.label),N=document.createElementNS(a.namespaceURI,"text");N.setAttribute("x",String(u)),N.setAttribute("y",String(M-R+12)),N.setAttribute("text-anchor","middle"),N.setAttribute("font-size","10"),N.setAttribute("fill","#111111"),N.textContent=D,a.appendChild(N)}),P){let b=s.createDiv({cls:"chart-notes-legend"});c.forEach((k,u)=>{let D=b.createDiv({cls:"chart-notes-legend-item"}),N=D.createDiv();N.style.width="10px",N.style.height="10px",N.style.borderRadius="999px",N.style.backgroundColor=ut(k,u),D.createSpan({text:k})})}G.forEach((b,k)=>{let u=f+B*(k+.5),D=b.rows;if(w==="single"){let O=D[0],nt=O.y,q=B*.6,rt=u-q/2,dt=F(nt),ot=Math.max(2,Y-dt),lt=ut("bar",k),U=document.createElementNS(a.namespaceURI,"rect");U.setAttribute("x",String(rt)),U.setAttribute("y",String(dt)),U.setAttribute("width",String(q)),U.setAttribute("height",String(ot)),U.setAttribute("fill",lt),U.setAttribute("stroke","rgba(0,0,0,0.25)"),U.setAttribute("stroke-width","0.5"),U.style.cursor="pointer";let Q=String(b.label),et=`valor: ${Math.round(nt*100)/100}`;U.addEventListener("mouseenter",Z=>{var X,pt;return gt(s,l,Q,et,(pt=(X=O.notes)==null?void 0:X.length)!=null?pt:0,Z)}),U.addEventListener("mouseleave",()=>yt(l)),U.addEventListener("click",Z=>{var X;Z.preventDefault(),bt(s,S,Q,nt,(X=O.notes)!=null?X:[],o)}),a.appendChild(U);return}let N=c.length,K=B/Math.max(N+1,2),st=N*K,z=u-st/2;c.forEach((O,nt)=>{let q=D.find(X=>(X.series!=null?String(X.series):"")===O);if(!q)return;let rt=q.y,dt=z+nt*K,ot=F(rt),lt=Math.max(2,Y-ot),U=ut(O,nt),Q=document.createElementNS(a.namespaceURI,"rect");Q.setAttribute("x",String(dt)),Q.setAttribute("y",String(ot)),Q.setAttribute("width",String(K)),Q.setAttribute("height",String(lt)),Q.setAttribute("fill",U),Q.setAttribute("stroke","rgba(0,0,0,0.25)"),Q.setAttribute("stroke-width","0.5"),Q.style.cursor="pointer";let et=`${O} @ ${String(b.label)}`,Z=`valor: ${Math.round(rt*100)/100}`;Q.addEventListener("mouseenter",X=>{var pt,Kt;return gt(s,l,et,Z,(Kt=(pt=q.notes)==null?void 0:pt.length)!=null?Kt:0,X)}),Q.addEventListener("mouseleave",()=>yt(l)),Q.addEventListener("click",X=>{var pt;X.preventDefault(),bt(s,S,et,rt,(pt=q.notes)!=null?pt:[],o)}),a.appendChild(Q)})})}function Be(s,e,t){var B,V,L,$;let n=(B=e.options)!=null?B:{},r=n.background,o=(V=n.drilldown)!=null?V:!0,i=(L=t.rows)!=null?L:[];if(!i.length){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let{inner:p,svg:a,tooltip:l,details:S}=wt(s,r),A=s.getBoundingClientRect().width||600,m=Math.max(A,480);p.style.width=m+"px";let f=40,g=16,T=18,R=28,M=300;a.setAttribute("height",String(M));let y=m-f-g,_=M-T-R,E=new Map;for(let h of i){let b=String(h.x),k=($=E.get(b))!=null?$:{label:h.x,rows:[]};k.rows.push(h),E.set(b,k)}let G=Array.from(E.keys()).sort((h,b)=>h<b?-1:h>b?1:0).map(h=>E.get(h)),v=G.length,C=new Set;i.forEach(h=>{h.series!=null&&C.add(String(h.series))});let c=Array.from(C);if(!c.length){fe(s,e,t);return}let P=0;G.forEach(h=>{let b=h.rows.reduce((k,u)=>k+u.y,0);b>P&&(P=b)}),(!isFinite(P)||P<=0)&&(P=1);let w=h=>T+_-h/(P||1)*_,x=w(0),F=4;for(let h=0;h<=F;h++){let b=P*h/F,k=w(b),u=document.createElementNS(a.namespaceURI,"line");u.setAttribute("x1",String(f)),u.setAttribute("y1",String(k)),u.setAttribute("x2",String(m-g)),u.setAttribute("y2",String(k)),u.setAttribute("stroke","#cccccc"),u.setAttribute("stroke-opacity","0.25"),a.appendChild(u);let D=document.createElementNS(a.namespaceURI,"text");D.setAttribute("x",String(f-4)),D.setAttribute("y",String(k+3)),D.setAttribute("text-anchor","end"),D.setAttribute("font-size","10"),D.setAttribute("fill","#111111"),D.textContent=String(Math.round(b)),a.appendChild(D)}let Y=v>0?y/v:y;G.forEach((h,b)=>{let k=f+Y*(b+.5),u=String(h.label),D=document.createElementNS(a.namespaceURI,"text");D.setAttribute("x",String(k)),D.setAttribute("y",String(M-R+12)),D.setAttribute("text-anchor","middle"),D.setAttribute("font-size","10"),D.setAttribute("fill","#111111"),D.textContent=u,a.appendChild(D)});let tt=s.createDiv({cls:"chart-notes-legend"});c.forEach((h,b)=>{let k=tt.createDiv({cls:"chart-notes-legend-item"}),u=k.createDiv();u.style.width="10px",u.style.height="10px",u.style.borderRadius="999px",u.style.backgroundColor=ut(h,b),k.createSpan({text:h})}),G.forEach((h,b)=>{let k=f+Y*(b+.5),u=Y*.6,D=k-u/2,N=0;c.forEach((K,st)=>{let z=h.rows.find(Z=>(Z.series!=null?String(Z.series):"")===K);if(!z)return;let O=z.y,nt=N,q=N+O;N=q;let rt=w(nt),dt=w(q),ot=Math.max(2,rt-dt),lt=ut(K,st),U=document.createElementNS(a.namespaceURI,"rect");U.setAttribute("x",String(D)),U.setAttribute("y",String(dt)),U.setAttribute("width",String(u)),U.setAttribute("height",String(ot)),U.setAttribute("fill",lt),U.setAttribute("stroke","rgba(0,0,0,0.25)"),U.setAttribute("stroke-width","0.5"),U.style.cursor="pointer";let Q=`${K} @ ${String(h.label)}`,et=`valor: ${Math.round(O*100)/100}`;U.addEventListener("mouseenter",Z=>{var X,pt;return gt(s,l,Q,et,(pt=(X=z.notes)==null?void 0:X.length)!=null?pt:0,Z)}),U.addEventListener("mouseleave",()=>yt(l)),U.addEventListener("click",Z=>{var X;Z.preventDefault(),bt(s,S,Q,O,(X=z.notes)!=null?X:[],o)}),a.appendChild(U)})})}function Wt(s){if(!s)return null;if(s instanceof Date){let e=s.getTime();return Number.isNaN(e)?null:s}if(typeof s=="string"){let e=s.trim();if(!e||/^\d+$/.test(e))return null;let t=new Date(e);if(!Number.isNaN(t.getTime()))return t}return null}function ge(s,e,t,n){var B,V,L,$;let r=(B=e.options)!=null?B:{},o=r.background,i=(V=r.drilldown)!=null?V:!0,p=(L=t.rows)!=null?L:[];if(!p.length){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let{inner:a,svg:l,tooltip:S,details:A}=wt(s,o),m=s.getBoundingClientRect().width||600,f=Math.max(m,480);a.style.width=f+"px";let g=40,T=16,R=18,M=28,y=300;l.setAttribute("height",String(y));let _=f-g-T,E=y-R-M,H=p.map(h=>Wt(h.x)).filter(h=>!!h),G=H.length>=2&&H.length>=p.length*.6,v=new Map;for(let h of p){let b=h.series!=null&&h.series!==""?String(h.series):"__default__",k=($=v.get(b))!=null?$:[];k.push(h),v.set(b,k)}let C=Array.from(v.keys()),c,P;if(G){let b=H.map(Q=>Q.getTime()).sort((Q,et)=>Q-et),k=b[0],u=b[b.length-1];k===u&&(k-=864e5,u+=864e5);let D=u-k||864e5,N=k-D*.02,K=u+D*.02;c=Q=>{let et=Wt(Q);if(!et)return g;let Z=et.getTime();return g+(Z-N)/(K-N||1)*_},P=Q=>{let et=Wt(Q);return et?Mt(et):String(Q)};let st=R+E,z=document.createElementNS(l.namespaceURI,"line");z.setAttribute("x1",String(g)),z.setAttribute("y1",String(st)),z.setAttribute("x2",String(f-T)),z.setAttribute("y2",String(st)),z.setAttribute("stroke","#111111"),z.setAttribute("stroke-width","1"),l.appendChild(z);let O=(K-N)/864e5,q=Math.max(3,Math.min(10,Math.floor(_/90)||3)),rt=O/q,dt=[1,2,3,5,7,10,14,21,30,60,90,180,365],ot=dt[dt.length-1];for(let Q of dt)if(Q>=rt){ot=Q;break}let U=(Q=>{let et=new Date(Q);return et.setHours(0,0,0,0),et.getTime()})(N);for(let Q=U;Q<=K+.5*864e5;Q+=ot*864e5){let et=g+(Q-N)/(K-N)*_,Z=document.createElementNS(l.namespaceURI,"line");Z.setAttribute("x1",String(et)),Z.setAttribute("y1",String(R)),Z.setAttribute("x2",String(et)),Z.setAttribute("y2",String(st)),Z.setAttribute("stroke","#111111"),Z.setAttribute("stroke-opacity","0.18"),Z.setAttribute("stroke-dasharray","2,4"),l.appendChild(Z);let X=document.createElementNS(l.namespaceURI,"text");X.setAttribute("x",String(et)),X.setAttribute("y",String(st+12)),X.setAttribute("text-anchor","middle"),X.setAttribute("font-size","10"),X.setAttribute("fill","#111111"),X.textContent=Mt(new Date(Q)),l.appendChild(X)}}else{let h=[],b=new Set;for(let u of p){let D=String(u.x);b.has(D)||(b.add(D),h.push(u.x))}let k=h.length||1;c=u=>{let D=String(u),N=h.findIndex(K=>String(K)===D);return N<0?g:k===1?g+_/2:g+N/(k-1)*_},P=u=>String(u)}let w=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY;for(let h of p)h.y<w&&(w=h.y),h.y>x&&(x=h.y);(!isFinite(w)||!isFinite(x))&&(w=0,x=1),w===x&&(w===0?x=1:w=0);let F=h=>R+E-(h-w)/(x-w||1)*E,Y=4;for(let h=0;h<=Y;h++){let b=w+(x-w)*h/Y,k=F(b),u=document.createElementNS(l.namespaceURI,"line");u.setAttribute("x1",String(g)),u.setAttribute("y1",String(k)),u.setAttribute("x2",String(f-T)),u.setAttribute("y2",String(k)),u.setAttribute("stroke","#cccccc"),u.setAttribute("stroke-opacity","0.25"),l.appendChild(u);let D=document.createElementNS(l.namespaceURI,"text");D.setAttribute("x",String(g-4)),D.setAttribute("y",String(k+3)),D.setAttribute("text-anchor","end"),D.setAttribute("font-size","10"),D.setAttribute("fill","#111111"),D.textContent=Math.abs(b)>=100?String(Math.round(b)):String(Math.round(b*10)/10),l.appendChild(D)}let tt=C.filter(h=>h!=="__default__");if(tt.length>1){let h=s.createDiv({cls:"chart-notes-legend"});tt.forEach((b,k)=>{let u=b,D=h.createDiv({cls:"chart-notes-legend-item"}),N=D.createDiv();N.style.width="10px",N.style.height="10px",N.style.borderRadius="999px",N.style.backgroundColor=ut(u,k),D.createSpan({text:u})})}C.forEach((h,b)=>{let k=v.get(h);if(!(k!=null&&k.length))return;let u=h==="__default__"?ut("line",b):ut(h,b),D=[...k];G&&D.sort((K,st)=>{let z=Wt(K.x),O=Wt(st.x),nt=z?z.getTime():0,q=O?O.getTime():0;return nt-q});let N="";if(D.forEach((K,st)=>{let z=c(K.x),O=F(K.y);N+=(st===0?"M ":" L ")+z+" "+O}),n){let K=D[0],st=D[D.length-1],z=c(K.x),O=c(st.x),nt=F(w);N+=` L ${O} ${nt} L ${z} ${nt} Z`;let q=document.createElementNS(l.namespaceURI,"path");q.setAttribute("d",N),q.setAttribute("fill",u),q.setAttribute("fill-opacity","0.18"),q.setAttribute("stroke",u),q.setAttribute("stroke-width","1.5"),l.appendChild(q)}else{let K=document.createElementNS(l.namespaceURI,"path");K.setAttribute("d",N),K.setAttribute("fill","none"),K.setAttribute("stroke",u),K.setAttribute("stroke-width","2"),l.appendChild(K)}D.forEach(K=>{let st=c(K.x),z=F(K.y),O=document.createElementNS(l.namespaceURI,"circle");O.setAttribute("cx",String(st)),O.setAttribute("cy",String(z)),O.setAttribute("r","3"),O.setAttribute("fill","#ffffff"),O.setAttribute("stroke",u),O.setAttribute("stroke-width","1.5"),O.style.cursor="pointer";let nt=P(K.x),q=h==="__default__"?"":String(K.series),rt=q?`${q} @ ${nt}`:nt,dt=`valor: ${Math.round(K.y*100)/100}`;O.addEventListener("mouseenter",ot=>{var lt,U;return gt(s,S,rt,dt,(U=(lt=K.notes)==null?void 0:lt.length)!=null?U:0,ot)}),O.addEventListener("mouseleave",()=>yt(S)),O.addEventListener("click",ot=>{var lt;ot.preventDefault(),bt(s,A,rt,K.y,(lt=K.notes)!=null?lt:[],i)}),l.appendChild(O)})})}function Ge(s,e,t){var _;let{background:n,drilldown:r=!0}=(_=e.options)!=null?_:{};if(t.rows.length===0){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let o=He(n)?"#000000":void 0,i=s.getBoundingClientRect().width||600,{inner:p,svg:a,tooltip:l,details:S}=wt(s,n),A=Math.max(i,420);p.style.width=A+"px",o&&(a.style.color=o);let m=300,f=A/2,g=(m-28+28)/2,T=Math.min(A/2-20,m/2-20),M=t.rows.map(E=>Math.max(0,E.y)).reduce((E,H)=>E+H,0)||1,y=-Math.PI/2;t.rows.forEach((E,H)=>{var B;let G=E.x instanceof Date?E.x.toISOString().slice(0,10):String(E.x),v=E.y,C=v/M*Math.PI*2,c=f+T*Math.cos(y),P=g+T*Math.sin(y),w=f+T*Math.cos(y+C),x=g+T*Math.sin(y+C),F=C>Math.PI?1:0,Y=document.createElementNS(a.namespaceURI,"path"),tt=[`M ${f} ${g}`,`L ${c} ${P}`,`A ${T} ${T} 0 ${F} 1 ${w} ${x}`,"Z"].join(" ");Y.setAttribute("d",tt),Y.setAttribute("fill",ut((B=E.series)!=null?B:G,H)),Y.style.cursor="pointer",Y.addEventListener("mouseenter",V=>{var L,$;return gt(s,l,G,v,($=(L=E.notes)==null?void 0:L.length)!=null?$:0,V)}),Y.addEventListener("mouseleave",()=>yt(l)),Y.addEventListener("click",()=>{var V;return bt(s,S,G,v,(V=E.notes)!=null?V:[],r)}),a.appendChild(Y),y+=C})}function Ve(s,e,t){var P;let{background:n,drilldown:r=!0}=(P=e.options)!=null?P:{};if(t.rows.length===0){s.createDiv({cls:"prop-charts-empty",text:"Sem dados."});return}let o=n?"#111111":void 0,i=s.getBoundingClientRect().width||600,{inner:p,svg:a,tooltip:l,details:S}=wt(s,n),A=Math.max(i,700);p.style.width=A+"px",o&&(a.style.color=o);let m=300,f=A-48-10,g=m-28-28,T=t.rows.map(w=>{let x=w.x;if(x instanceof Date)return x.getTime();if(typeof x=="string"){if(/^\d{4}-\d{2}-\d{2}/.test(x)){let Y=new Date(x);if(!isNaN(Y.getTime()))return Y.getTime()}let F=Number(x);return isNaN(F)?null:F}return typeof x=="number"?x:null}),R=t.rows.map(w=>w.y),M=T.filter(w=>w!==null);if(M.length===0){s.createDiv({cls:"prop-charts-empty",text:"Sem dados (X n\xE3o \xE9 num\xE9rico/data)."});return}let y=Math.min(...M),_=Math.max(...M),E=Math.min(...R),H=Math.max(...R),G=w=>48+(w-y)/(_-y||1)*f,v=w=>m-28-(w-E)/(H-E||1)*g,C=document.createElementNS(a.namespaceURI,"line");C.setAttribute("x1",String(48)),C.setAttribute("y1",String(28)),C.setAttribute("x2",String(48)),C.setAttribute("y2",String(m-28)),C.setAttribute("stroke","currentColor"),a.appendChild(C);let c=document.createElementNS(a.namespaceURI,"line");c.setAttribute("x1",String(48)),c.setAttribute("y1",String(m-28)),c.setAttribute("x2",String(A-10)),c.setAttribute("y2",String(m-28)),c.setAttribute("stroke","currentColor"),a.appendChild(c),t.rows.forEach((w,x)=>{let F=T[x];if(F==null)return;let Y=G(F),tt=v(R[x]),B=document.createElementNS(a.namespaceURI,"circle");B.setAttribute("cx",String(Y)),B.setAttribute("cy",String(tt)),B.setAttribute("r","4"),B.setAttribute("fill",ut(w.series,x)),B.style.cursor="pointer";let V=w.x instanceof Date?w.x.toISOString().slice(0,10):typeof w.x=="string"?w.x:String(w.x);B.addEventListener("mouseenter",L=>{var $,h;return gt(s,l,V,w.y,(h=($=w.notes)==null?void 0:$.length)!=null?h:0,L)}),B.addEventListener("mouseleave",()=>yt(l)),B.addEventListener("click",L=>{var $;L.preventDefault(),bt(s,S,V,w.y,($=w.notes)!=null?$:[],r)}),a.appendChild(B)})}var ie=class{render(e,t,n,r){var a;let{title:o}=(a=t.options)!=null?a:{};e.empty(),e.addClass("prop-charts-container");let p=e.createDiv({cls:"prop-charts-title-row"}).createDiv({cls:"prop-charts-title"});switch(o&&(p.textContent=o),t.type){case"bar":fe(e,t,n);break;case"stacked-bar":Be(e,t,n);break;case"line":ge(e,t,n,!1);break;case"area":ge(e,t,n,!0);break;case"pie":Ge(e,t,n);break;case"scatter":Ve(e,t,n);break;case"gantt":se(e,t,n,r);break;default:e.createDiv({text:"Chart Notes: tipo n\xE3o suportado: "+t.type})}}};function mn(){return[{type:"dropdown",key:"chartType",displayName:"Chart type",description:"Type of chart to render",default:"bar",options:{bar:"Bar","stacked-bar":"Stacked bar",line:"Line",area:"Area",pie:"Pie",scatter:"Scatter",gantt:"Gantt"}},{type:"property",key:"xProperty",displayName:"X axis / category (bars & slices)",description:"Property used for the X axis or categories (for pie, this is the slice)."},{type:"property",key:"ganttLabelProperty",displayName:"Task label (Gantt)",description:"Label for each task bar. If empty, uses the X / category.",shouldHide:e=>{var t;return String((t=e.get("chartType"))!=null?t:"bar")!=="gantt"}},{type:"property",key:"yProperty",displayName:"Y value (empty = count)",description:"Numeric property summed on the Y axis. Leave empty to just count notes.",shouldHide:e=>{var n;let t=String((n=e.get("chartType"))!=null?n:"bar");return t==="pie"||t==="gantt"}},{type:"property",key:"seriesProperty",displayName:"Series / color (optional)",description:"Property that defines series / color for bars, lines and area.",shouldHide:e=>{var t;return String((t=e.get("chartType"))!=null?t:"bar")==="pie"}},{type:"dropdown",key:"xBucket",displayName:"X bucket (dates)",description:"How to bucket dates on the X axis for line / area charts (day, week, month...).",default:"auto",options:{auto:"Auto",none:"None",day:"Day",week:"Week",month:"Month",quarter:"Quarter",year:"Year"},shouldHide:e=>{var n;let t=String((n=e.get("chartType"))!=null?n:"bar");return!(t==="line"||t==="area")}},{type:"dropdown",key:"aggregateMode",displayName:"Value aggregation (Y)",description:"How to aggregate Y values with the same X / series.",default:"sum",options:{sum:"Sum",count:"Count (ignore Y)","cumulative-sum":"Cumulative sum (line/area only)"},shouldHide:e=>{var n;let t=String((n=e.get("chartType"))!=null?n:"bar");return t==="pie"||t==="scatter"||t==="gantt"}},{type:"property",key:"startProperty",displayName:"Start (Gantt)",description:"Start date/datetime for the task.",shouldHide:e=>{var t;return String((t=e.get("chartType"))!=null?t:"bar")!=="gantt"}},{type:"property",key:"endProperty",displayName:"End (Gantt)",description:"End date/datetime for the task.",shouldHide:e=>{var t;return String((t=e.get("chartType"))!=null?t:"bar")!=="gantt"}},{type:"property",key:"dueProperty",displayName:"Due (deadline, optional)",description:"Due date / deadline for the task.",shouldHide:e=>{var t;return String((t=e.get("chartType"))!=null?t:"bar")!=="gantt"}},{type:"property",key:"scheduledProperty",displayName:"Scheduled (optional)",description:"Scheduled date used for fallback when computing bars.",shouldHide:e=>{var t;return String((t=e.get("chartType"))!=null?t:"bar")!=="gantt"}},{type:"property",key:"durationProperty",displayName:"Duration in minutes (optional)",description:"Duration of the task in minutes. Used together with start/scheduled/due.",shouldHide:e=>{var t;return String((t=e.get("chartType"))!=null?t:"bar")!=="gantt"}},{type:"toggle",key:"drilldown",displayName:"Drilldown (click opens notes)",default:!0},{type:"text",key:"title",displayName:"Title (optional)",description:"Custom chart title. Falls back to the view name."},{type:"text",key:"labelWidth",displayName:"Gantt label column width",description:"Optional width for the left label column in the Gantt chart.",shouldHide:e=>{var t;return String((t=e.get("chartType"))!=null?t:"bar")!=="gantt"}}]}var ae=class extends Vt.Plugin{constructor(t,n){super(t,n)}async onload(){console.log("Chart Notes: loading plugin (Bases-only)"),this.indexer=new te(this.app),await this.indexer.buildIndex(),this.query=new re(()=>this.indexer.getAll(),[]),this.renderer=new ie,this.registerEvent(this.app.vault.on("modify",async t=>{t instanceof Vt.TFile&&await this.indexer.updateFile(t)})),this.registerEvent(this.app.vault.on("create",async t=>{t instanceof Vt.TFile&&await this.indexer.updateFile(t)})),this.registerEvent(this.app.vault.on("delete",async t=>{t instanceof Vt.TFile&&this.indexer.removeFile(t)})),this.registerBasesView(de,{name:"Chart Notes",icon:"lucide-chart-area",factory:(t,n)=>new Zt(t,n,this.renderer),options:mn})}onunload(){console.log("Chart Notes: unloading plugin")}};
